$(document).ready(function(){function t(t){var e=JSON.parse(localStorage.getItem("Settings"))||{mapColor:"rgba(255, 204, 128, 1)",mapStrokeColor:"rgba(0, 0, 0, 1)",mapPointsColor:"rgba(0, 0, 255, 1)",mapPointsBorderColor:"rgba(0, 0, 0, 1)",mapRouteColor:"rgba(0, 0, 0, 1)",bodyBackgroundColor:"rgba(243, 229, 245, 1)",routeBorderWidth:"4",pointsRadius:"8",pointsBorderWidth:"1",contentWidth:"50",contentAlign:"flex-start",checkboxState:"false",defaultOption:"false",UserOption:"false",StartIcon:"",RouteStartIconColor:"rgba(0, 0, 0, 1)",RouteStartIconSize:"8"};if(e[t])return e[t]}function e(t,e){return t.id-e.id}function a(t,e){return t.pointId-e.pointId}JSON.parse(localStorage.getItem("Settings"));$(".modal").modal(),$("ul.tabs").tabs("select_tab","tab_2"),$("#menu").on("click",function(){$(this).hasClass(".active")?($(this).removeClass("active"),$(".tap-target").tapTarget("close")):($(this).addClass("active"),$(".tap-target").tapTarget("open"))}),$(".button-collapse").sideNav({menuWidth:323,edge:"left",closeOnClick:!1,draggable:!0,onOpen:function(){},onClose:function(){$("#slide-out").css("transform","translateX(-100%)"),$("div").remove("#sidenav-overlay"),$(".button-collapse").sideNav("hide"),$("#slide-out").css("transform","translateX(-100%)")}}),$(".collapsible").collapsible(),$(".side-nav").resizable({handles:"e",maxWidth:1200,minWidth:300});var o=document.getElementById("map"),n=JSON.parse(localStorage.getItem("map"));$("#map").attr("data",n),o.addEventListener("load",function(){var n=o.contentDocument,r=n.documentElement,l=r.getElementById("mapPaths"),s=l.getElementsByTagName("path"),i=document.createElementNS("http://www.w3.org/2000/svg","g");$(i).attr("id","wholeSvgGroup"),$("input[name=light-trigger]").attr("data-light","lightOff"),$("input[name=light-trigger]").prop("checked",!1);for(var c=0;c<s.length;c++)s[c].style.fill=t("mapColor"),s[c].style.stroke=t("mapStrokeColor");var d=JSON.parse(localStorage.getItem("path"));if(d){var g=document.createElementNS("http://www.w3.org/2000/svg","path");$(g).attr("d",d),$(g).attr("fill","transparent"),$(g).attr("stroke",t("mapRouteColor")),$(g).attr("stroke-width",t("routeBorderWidth")),$(g).attr("stroke-linecap","round")}Snap.plugin(function(t,e,a,o){a.prototype.circlePath=function(t,e,a){var o="M"+t+","+e;return o+="m"+-a+",0",o+="a"+a+","+a+" 0 1,0 "+2*a+",0",o+="a"+a+","+a+" 0 1,0 "+-2*a+",0",this.path(o,t,e)}});var p=document.createElementNS("http://www.w3.org/2000/svg","g");p.id="pathGroup",p.append(g),i.append(p),i.append(l),r.append(i);var m=Snap(p),h=JSON.parse(localStorage.getItem("circlesCoords")),u=g.getTotalLength(),f=(JSON.parse(localStorage.getItem("StartRouteIcon")),JSON.parse(localStorage.getItem("StartRouteIcon"))),v=(new DOMParser).parseFromString(f,"text/xml").documentElement,S=$(v).attr("data-offset-x"),b=$(v).attr("data-offset-y"),I=$(v).attr("data-scale"),y=document.createElementNS("http://www.w3.org/2000/svg","g");"true"==t("UserOption")&&f&&($(v).attr({fill:t("RouteStartIconColor"),transform:I}),$(y).attr("transform","translate("+(g.getPointAtLength(1).x-t("RouteStartIconSize")/S)+" "+(g.getPointAtLength(1).y-t("RouteStartIconSize")/b)+") scale("+t("RouteStartIconSize")/100+")"),y.append(v),p.append(y),i.append(p));for(var N=[],w=(JSON.parse(localStorage.getItem("PointsContent")),0);w<h.length;w++)N[w]=h[w];var k=1;for(c=0;c<u;c++)for(var C=(V=g.getPointAtLength(c)).x,O=V.y,P=0;P<N.length;P++)if(Math.abs(Math.round(C-N[P].cx))<=8&&Math.abs(Math.round(O-N[P].cy))<=8){for(var x=0;x<h.length;x++)Math.abs(Math.round(h[x].cx-N[P].cx))<=4&&Math.abs(Math.round(h[x].cy-N[P].cy))<=4&&(h[x].id=k++);N.splice(P,1)}h.sort(e),console.log(g);var E=g.getPointAtLength(g.getTotalLength()),B=(new Date).getTime();if(console.log(h),h[h.length-1].cx==E.x&&h[h.length-1].cy==E.y)console.log(h[h.length-1]);else{var J={cx:E.x,cy:E.y,id:h.length,r:t("pointsRadius"),time:B};console.log(J),h.push(J)}localStorage.setItem("circlesCoords",JSON.stringify(h));h=JSON.parse(localStorage.getItem("circlesCoords"));var _=[];$.each(h,function(e,a){var o={cx:0,cy:0,r:1},n=m.circlePath(this.cx,this.cy,this.r).attr({fill:t("mapPointsColor"),stroke:t("mapPointsBorderColor"),"stroke-width":t("pointsBorderWidth"),id:a.id,"data-time":a.time}),r=Snap.path.intersection(n,$(g).attr("d"));0==r.length?(alert("Please, return to the previous step and draw points right on the route line"),document.location.replace("http://127.0.0.1:8080/")):(o.cx=r[0].x,o.cy=r[0].y),_.push(o),r.forEach(function(t){m.circle(t.x,t.y,1)}),localStorage.setItem("points",JSON.stringify(_))});var L=n.getElementsByTagName("circle");for(c=0;c<L.length;c++)L[c].style.fill="transparent";if("true"==t("checkboxState")&&"true"==t("defaultOption")){var M=document.createElementNS("http://www.w3.org/2000/svg","circle");$(M).attr({cx:g.getPointAtLength(1).x,cy:g.getPointAtLength(1).y,r:t("pointsRadius"),stroke:t("mapPointsBorderColor"),fill:t("mapPointsColor"),"stroke-width":t("pointsBorderWidth")}),r.append(M)}if(null!=localStorage.getItem("PointsContent"))var z=JSON.parse(localStorage.getItem("PointsContent"));else z=[];for(c=0;c<h.length;c++){var R=n.getElementById(h[c].id),T=document.createElementNS("http://www.w3.org/2000/svg","g"),A=document.createElementNS("http://www.w3.org/2000/svg","text");$(A).attr({x:h[c].cx,y:h[c].cy+20,"font-size":12,"font-style":"italic",fill:"#ccccccc",class:"cityName"}),T.append(R),T.append(A),p.append(T),i.append(p),r.append(i);var W=h[c].time;for(P=0;P<z.length;P++){var j=z[P].data;if(z[P].pointId==W){z[P].pointId;if(0!=j.length){var D=n.getElementById(h[c].id),F=$(D).parent().find("text");z[P].cityName&&$(F).text(z[P].cityName),$(D).css("fill","#990033")}}}$(R).addClass("button-collapse"),$(R).attr("data-activates","slide-out"),$(R).attr("href","#"),R.style.cursor="pointer",$(R).mouseenter(function(){$(this).css("transition","0.5s"),$(this).css("stroke-width","6px"),$(this).css("stroke",t("mapPointsBorderColor"))}).mouseout(function(){$(this).css("transition","0.5s"),$(this).css("stroke-width","3px"),$(this).css("stroke",t("mapPointsBorderColor"))});var X,G,Q={zoom:100,top:0,bottom:0,left:0,right:0},U=Snap(i),q=(Snap(p),JSON.parse(localStorage.getItem("mapStyleProperties"))||{transform:""});if(q.transform){var H=q.transform,Y=H.match(/[+-]?\d+(\.\d+)?/g).map(function(t){return parseFloat(t)});scaleImg=Y[0],X=Y[1],G=Y[2],U.attr("transform","scale("+scaleImg+") translate("+X+" "+G+")")}q.top=parseInt(q.top),q.left=parseInt(q.left),R.addEventListener("click",function(){function e(t,e){t.addEventListener("load",function(){for(var a=t.contentDocument.documentElement.querySelector("#transport"),o=new XMLSerializer,n=a.getElementsByTagName("path"),r=0;r<n.length;r++)n[r].style.fill=e;document.getElementById("subPathIconObj");var l=o.serializeToString(a);b.icon=l,console.log(S),$("input[name=color]").change(function(t){$("option:selected",this);var e=this.value,a=this.name;b[a]=e,console.log(b[a]);for(var o=0;o<n.length;o++)n[o].style.fill=b.color})})}$(".button-collapse").sideNav("show"),$(".button-collapse").off("click").sideNav();var o=parseInt(this.id),n=$(this).attr("data-time");document.getElementById("pointIndex").innerHTML=o;var r=this,l=$(this).attr("data-time"),s=JSON.parse(localStorage.getItem("PointsContent"))||[],i=JSON.parse(localStorage.getItem("mapStyleProperties"))||{transform:""};if(i.transform.length>0){var c=(H=i.transform).match(/[+-]?\d+(\.\d+)?/g).map(function(t){return parseFloat(t)});d=c[0],p=c[1],g=c[2]}if(s[o-1])d=s[o-1].zoom,g=s[o-1].top,p=s[o-1].left;else{var d=1,g=0,p=0;$("#pointName").html(""),$("#point_name_label").removeClass(),U.animate({transform:"scale("+d+") translate("+g+" "+p+")"},200)}if($("#plus").bind("click",function(){d+=.1,Q.zoom=d,U.animate({transform:"scale("+d+") translate("+p+" "+g+")"},300)}),$("#minus").bind("click",function(){(d-=.1)<=1&&(d=1),Q.zoom=d,U.animate({transform:"scale("+d+") translate("+p+" "+g+")"},300)}),$("#moveLeft").bind("click",function(){p+=20,Q.left=p,U.animate({transform:"scale("+d+") translate("+p+" "+g+")"},300)}),$("#moveRight").bind("click",function(){p-=20,Q.left=p,U.animate({transform:"scale("+d+") translate("+p+" "+g+")"},300)}),$("#moveTop").bind("click",function(){g+=20,Q.top=g,U.animate({transform:"scale("+d+") translate("+p+" "+g+")"},300)}),$("#moveBottom").bind("click",function(){g-=20,Q.top=g,U.animate({transform:"scale("+d+") translate("+p+" "+g+")"},300)}),null!=localStorage.getItem("PointsContent")){console.log("kek");for(var m,u=0;u<s.length;u++){var f=s[u].pointId==n;if(s[u].pointId==n){U.animate({transform:"scale("+parseFloat(s[u].zoom)+") translate("+s[u].left+" "+s[u].top+")"},300),console.log(s[u].cityName);var v=s[u].cityName;console.log(v)}f&&(m=s[u].data)}console.log(v),v?($("#pointName").val(v),console.log($("#pointName").closest("label")),$("#point_name_label").addClass("active")):($("#pointName").val(""),$("#point_name_label").removeClass("active")),editor.setData(m)}var S=JSON.parse(localStorage.getItem("subpathIcons"))||[],b={pointId:"",icon:"",color:"",size:5,icon_src:""};$("input[name=showIcon]").prop("checked",!1),$("#settings_btn").attr("disabled","disabled");for(var I=0;I<S.length;I++)if(parseInt(S[I].pointId)==o){$("input[name=showIcon]").prop("checked","checked"),$("#settings_btn").removeAttr("disabled"),console.log($("input[name=showIcon]").attr("checked"));break}$("#icon_switch").on("click",function(){if($("input[name=showIcon]").is(":checked"))$("input[name=showIcon]").attr("checked",!0),$("#settings_btn").removeAttr("disabled");else{$("input[name=showIcon]").attr("checked",!1),$("#settings_btn").attr("disabled","disabled");for(var t=0;t<S.length;t++)parseInt(S[t].pointId)==o&&S.splice(t,1);S.sort(a),localStorage.setItem("subpathIcons",JSON.stringify(S))}}),$("#settings_btn").on("click",function(){$("#modal2").modal("open")}),$(".modal2").modal({ready:function(){$("input[name=light-trigger]").attr("data-light",!1)}}),$(".modal2").modal({ready:function(){var t=JSON.parse(localStorage.getItem("subpathIcons"))||[];if(0!=t.length)for(var a=0;a<t.length;a++){if(parseInt(t[a].pointId)===o){console.log("EQuaLS!"),$("input[name=color]").val(t[a].color);var n=document.getElementById("subPathIconObj");$("#subPathIconObj").attr("data",t[a].icon_src),e(n,t[a].color);break}console.log(" NOT EQuaLS!"),$("input[name=color]").val("rgba(255, 255, 255, 1)"),$("#subPathIconObj").attr("data","")}},complete:function(){if(S.length>0)for(var t=0;t<S.length;t++)S[t].pointId==o&&S.splice(t,1);console.log(o);var e=$("#subPathIconObj").attr("data");e.length>0?(b.icon_src=e,b.color=$("input[name=color]").val(),b.pointId=o,S.push(b),S.sort(a),localStorage.setItem("subpathIcons",JSON.stringify(S)),console.log(S)):Materialize.toast("No icon to this point!",2e3)}}),$("input[name = color]").minicolors({opacity:!0,format:"rgb",rgbaString:!1,change:function(t,e){var a="rgba("+e.r+", "+e.g+", "+e.b+", "+e.a+")";console.log(a)},swatches:["rgba(154, 9, 173, 1)","rgba(240, 17, 17, 1)","rgba(0, 255, 21, 1)","rgba(15, 43, 255, 1)","rgba(255, 239, 13, 1)"],showSpeed:100}),$(".icon_gallery__item").on("click",function(){var t=$(this).attr("src");console.log(t);var a=document.getElementById("subPathIconObj");$("#subPathIconObj").attr("data",t),b.pointId=o,b.icon_src=t,e(a)}),document.getElementById("SavePointContent").onclick=function(){var e={pointId:0,cityName:"",zoom:d,left:p,top:g,slider:"false",data:""},o=$("#pointName").val();e.pointId=l,e.cityName=o,e.data=editor.getData();for(var n=0;n<z.length;n++)z[n].pointId==l&&z.splice(n,1);if(0==e.data.length)Materialize.toast("No data in point!",2e3);else{z.push(e);var s=$(r).parent().find("text");$(s).text(o),Materialize.toast("Your data is saved!",2e3)}z.sort(a);var i=$("#sidenav-overlay");$(i).css("background-color","none"),$(i).remove(),console.log(z,h);for(var c=[],m=0;m<h.length;m++)for(n=0;n<z.length;n++)h[m].time==z[n].pointId&&c.push(z[n]);console.log(c),localStorage.setItem("PointsContent",JSON.stringify(c)),e.data.length>0?$(r).css("fill","#990033"):0==e.data.length&&$(r).css("fill",t("mapPointsColor")),$(".button-collapse").sideNav("hide")}})}u=g.getTotalLength();var K=[];for(c=0;c<u;c++){var V;for(C=(V=g.getPointAtLength(c)).x,O=V.y,P=0;P<_.length;P++)Math.abs(Math.round(C-_[P].cx))<=0&&Math.abs(Math.round(O-_[P].cy))<=0&&K.push(c)}if(K.length!=_.length)for(c=0;c<K.length;c++)K[c+1]-K[c]==1&&K.splice(c,1);localStorage.setItem("stopsAtLength",JSON.stringify(K))},!1);JSON.parse(localStorage.getItem("mapStyleProperties"));$("body").css("background-color",t("bodyBackgroundColor"))});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImRyYXdNYXAuanMiXSwibmFtZXMiOlsiJCIsImRvY3VtZW50IiwicmVhZHkiLCJnZXRTZXR0aW5nRnJvbVN0b3JhZ2UiLCJzZXR0aW5nIiwiU2V0dGluZ3NPYmplY3QiLCJKU09OIiwicGFyc2UiLCJsb2NhbFN0b3JhZ2UiLCJnZXRJdGVtIiwibWFwQ29sb3IiLCJtYXBTdHJva2VDb2xvciIsIm1hcFBvaW50c0NvbG9yIiwibWFwUG9pbnRzQm9yZGVyQ29sb3IiLCJtYXBSb3V0ZUNvbG9yIiwiYm9keUJhY2tncm91bmRDb2xvciIsInJvdXRlQm9yZGVyV2lkdGgiLCJwb2ludHNSYWRpdXMiLCJwb2ludHNCb3JkZXJXaWR0aCIsImNvbnRlbnRXaWR0aCIsImNvbnRlbnRBbGlnbiIsImNoZWNrYm94U3RhdGUiLCJkZWZhdWx0T3B0aW9uIiwiVXNlck9wdGlvbiIsIlN0YXJ0SWNvbiIsIlJvdXRlU3RhcnRJY29uQ29sb3IiLCJSb3V0ZVN0YXJ0SWNvblNpemUiLCJjb21wYXJlSWQiLCJvYmpBIiwib2JqQiIsImlkIiwiY29tcGFyZVRpbWUiLCJwb2ludElkIiwibW9kYWwiLCJ0YWJzIiwib24iLCJ0aGlzIiwiaGFzQ2xhc3MiLCJyZW1vdmVDbGFzcyIsInRhcFRhcmdldCIsImFkZENsYXNzIiwic2lkZU5hdiIsIm1lbnVXaWR0aCIsImVkZ2UiLCJjbG9zZU9uQ2xpY2siLCJkcmFnZ2FibGUiLCJvbk9wZW4iLCJvbkNsb3NlIiwiY3NzIiwicmVtb3ZlIiwiY29sbGFwc2libGUiLCJyZXNpemFibGUiLCJoYW5kbGVzIiwibWF4V2lkdGgiLCJtaW5XaWR0aCIsImEiLCJnZXRFbGVtZW50QnlJZCIsIm1hcF91cmwiLCJhdHRyIiwiYWRkRXZlbnRMaXN0ZW5lciIsInN2Z0RvYyIsImNvbnRlbnREb2N1bWVudCIsInN2Z1Jvb3QiLCJkb2N1bWVudEVsZW1lbnQiLCJNYXBQYXRoc0dyb3VwIiwiUGF0aHNBcnJheSIsImdldEVsZW1lbnRzQnlUYWdOYW1lIiwid2hvbGVTdmdHcm91cCIsImNyZWF0ZUVsZW1lbnROUyIsInByb3AiLCJpIiwibGVuZ3RoIiwic3R5bGUiLCJmaWxsIiwic3Ryb2tlIiwiUGF0aERpcmVjdGlvbiIsInBhdGgiLCJTbmFwIiwicGx1Z2luIiwiRWxlbWVudCIsIlBhcGVyIiwiZ2xvYmFsIiwicHJvdG90eXBlIiwiY2lyY2xlUGF0aCIsImN4IiwiY3kiLCJyIiwicCIsInBhdGhHcm91cCIsImFwcGVuZCIsInMiLCJjaXJjbGVzQXJyYXkiLCJwYXRoTGVuZ3RoIiwiZ2V0VG90YWxMZW5ndGgiLCJwYXRoU3RhcnRJY29uIiwicGFyc2VkUGF0aFN0YXJ0SWNvbiIsIkRPTVBhcnNlciIsInBhcnNlRnJvbVN0cmluZyIsImljb25PZmZzZXRYIiwiaWNvbk9mZnNldFkiLCJpY29uU2NhbGUiLCJncm91cCIsInRyYW5zZm9ybSIsImdldFBvaW50QXRMZW5ndGgiLCJ4IiwieSIsIkNpcmNsZXNBcnJheUNsb25lIiwiayIsImNpcmNsZXNDb3VudGVyIiwicG9pbnRYIiwicGF0aExlbmd0aEF0UG9pbnQiLCJwb2ludFkiLCJqIiwiTWF0aCIsImFicyIsInJvdW5kIiwibCIsInNwbGljZSIsInNvcnQiLCJjb25zb2xlIiwibG9nIiwicGF0aF9lbmRfcG9pbnQiLCJjdXJyZW50VGltZSIsIkRhdGUiLCJnZXRUaW1lIiwibGFzdF9wYXRoX3BvaW50IiwidGltZSIsInB1c2giLCJzZXRJdGVtIiwic3RyaW5naWZ5IiwicG9pbnRzQXJyYXkiLCJlYWNoIiwiaW5kZXgiLCJlbCIsInBvaW50c09iaiIsImNpcmNsZSIsInN0cm9rZS13aWR0aCIsImRhdGEtdGltZSIsImludGVyc2VjdHMiLCJpbnRlcnNlY3Rpb24iLCJhbGVydCIsImxvY2F0aW9uIiwicmVwbGFjZSIsImZvckVhY2giLCJpbnRlcnNlY3Rpb25DaXJjbGVzIiwic3RhcnRDaXJjbGUiLCJwb2ludHNEYXRhQ29udGVudEFycmF5IiwicGF0aHMiLCJjaXJjbGVHcm91cCIsInRleHQiLCJmb250LXNpemUiLCJmb250LXN0eWxlIiwiY2xhc3MiLCJlcXVhbFRpbWVBdHRyIiwicG9pbnRUZXh0IiwiZGF0YSIsIkZpbGxlZENvbnRlbnRQYXRocyIsIkNsb3Nlc3RUZXh0RmllbGQiLCJwYXJlbnQiLCJmaW5kIiwiY2l0eU5hbWUiLCJjdXJzb3IiLCJtb3VzZWVudGVyIiwibW91c2VvdXQiLCJtb3ZlTGVmdCIsIm1vdmVUb3AiLCJEaXNwbGFjZW1lbnRPYmoiLCJ6b29tIiwidG9wIiwiYm90dG9tIiwibGVmdCIsInJpZ2h0IiwiRnVsbE1hcEdyb3VwIiwic2F2ZWREaXNwbGFjZW1lbnQiLCJ0cmFuc2Zvcm1TdHJpbmciLCJTdHJpbmdWYWx1ZXMiLCJtYXRjaCIsIm1hcCIsInYiLCJwYXJzZUZsb2F0Iiwic2NhbGVJbWciLCJwYXJzZUludCIsImxvYWRJY29uIiwiaWNvbl9jb250YWluZXIiLCJpY29uX2NvbG9yIiwicGF0aHNfZ3JvdXAiLCJxdWVyeVNlbGVjdG9yIiwiWE1MU2VyaWFsaXplciIsInBhdGhEaXIiLCJzZXJpYWxpemVUb1N0cmluZyIsInN1YnBhdGhTZXR0aW5nIiwiaWNvbiIsInN1YnBhdGhJY29ucyIsImNoYW5nZSIsInZhbHVlU2VsZWN0ZWQiLCJ2YWx1ZSIsIm5hbWUiLCJjb2xvciIsIm9mZiIsIk5wb2ludCIsImRhdGFUaW1lIiwiaW5uZXJIVE1MIiwiY3VycmVudFBhdGgiLCJwb2ludERhdGFUaW1lIiwiZ2V0UG9pbnREYXRhIiwicG9pbnRzRGVmYXVsdERpc3BsYWNlbWVudCIsImh0bWwiLCJhbmltYXRlIiwiYmluZCIsIlBvaW50TGFzdERhdGEiLCJjb3VudCIsIlBvaW50Q2l0eU5hbWUiLCJ2YWwiLCJjbG9zZXN0IiwiZWRpdG9yIiwic2V0RGF0YSIsInNpemUiLCJpY29uX3NyYyIsInJlbW92ZUF0dHIiLCJpcyIsImljb25fc2V0dGluZ3MiLCJjb21wbGV0ZSIsInNvdXJjZSIsIk1hdGVyaWFsaXplIiwidG9hc3QiLCJtaW5pY29sb3JzIiwib3BhY2l0eSIsImZvcm1hdCIsInJnYmFTdHJpbmciLCJoc2wiLCJyZ2IiLCJnIiwiYiIsInN3YXRjaGVzIiwic2hvd1NwZWVkIiwiaWNvblNSQyIsIm9uY2xpY2siLCJwb2ludHNEYXRhQ29udGVudCIsInNsaWRlciIsIlBvaW50TmFtZSIsImdldERhdGEiLCJ0ZXh0RmllbGQiLCJvdmVybGF5IiwiU29ydGVkRGF0YUFycmF5Iiwic3RvcHNBdExlbmd0aCJdLCJtYXBwaW5ncyI6IkFBQUFBLEVBQUVDLFVBQVVDLE1BQU0sV0FFZCxTQUFTQyxFQUFzQkMsR0FDM0IsSUFBSUMsRUFBaUJDLEtBQUtDLE1BQU1DLGFBQWFDLFFBQVEsZUFDakRDLFNBQVUseUJBQ1ZDLGVBQWdCLG1CQUNoQkMsZUFBZ0IscUJBQ2hCQyxxQkFBc0IsbUJBQ3RCQyxjQUFlLG1CQUNmQyxvQkFBcUIseUJBQ3JCQyxpQkFBa0IsSUFDbEJDLGFBQWMsSUFDZEMsa0JBQW1CLElBQ25CQyxhQUFjLEtBQ2RDLGFBQWMsYUFDZEMsY0FBZSxRQUNmQyxjQUFlLFFBQ2ZDLFdBQVksUUFDWkMsVUFBVyxHQUNYQyxvQkFBcUIsbUJBQ3JCQyxtQkFBb0IsS0FFeEIsR0FBSXJCLEVBQWVELEdBQ2YsT0FBT0MsRUFBZUQsR0FvRDlCLFNBQVN1QixFQUFVQyxFQUFNQyxHQUNyQixPQUFPRCxFQUFLRSxHQUFLRCxFQUFLQyxHQUcxQixTQUFTQyxFQUFZSCxFQUFNQyxHQUN2QixPQUFPRCxFQUFLSSxRQUFVSCxFQUFLRyxRQXREckIxQixLQUFLQyxNQUFNQyxhQUFhQyxRQUFRLGFBVzFDVCxFQUFFLFVBQVVpQyxRQUlaakMsRUFBRSxXQUFXa0MsS0FBSyxhQUFjLFNBQ2hDbEMsRUFBRSxTQUFTbUMsR0FBRyxRQUFTLFdBQ2RuQyxFQUFFb0MsTUFBTUMsU0FBUyxZQUlsQnJDLEVBQUVvQyxNQUFNRSxZQUFZLFVBQ3BCdEMsRUFBRSxlQUFldUMsVUFBVSxXQUozQnZDLEVBQUVvQyxNQUFNSSxTQUFTLFVBQ2pCeEMsRUFBRSxlQUFldUMsVUFBVSxXQU9uQ3ZDLEVBQUUsb0JBQW9CeUMsU0FDbEJDLFVB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KSB7XHJcblxyXG4gICAgZnVuY3Rpb24gZ2V0U2V0dGluZ0Zyb21TdG9yYWdlKHNldHRpbmcpIHtcclxuICAgICAgICB2YXIgU2V0dGluZ3NPYmplY3QgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKFwiU2V0dGluZ3NcIikpIHx8IHtcclxuICAgICAgICAgICAgbWFwQ29sb3I6IFwicmdiYSgyNTUsIDIwNCwgMTI4LCAxKVwiLFxyXG4gICAgICAgICAgICBtYXBTdHJva2VDb2xvcjogXCJyZ2JhKDAsIDAsIDAsIDEpXCIsXHJcbiAgICAgICAgICAgIG1hcFBvaW50c0NvbG9yOiBcInJnYmEoMCwgMCwgMjU1LCAxKVwiLFxyXG4gICAgICAgICAgICBtYXBQb2ludHNCb3JkZXJDb2xvcjogXCJyZ2JhKDAsIDAsIDAsIDEpXCIsXHJcbiAgICAgICAgICAgIG1hcFJvdXRlQ29sb3I6IFwicmdiYSgwLCAwLCAwLCAxKVwiLFxyXG4gICAgICAgICAgICBib2R5QmFja2dyb3VuZENvbG9yOiBcInJnYmEoMjQzLCAyMjksIDI0NSwgMSlcIixcclxuICAgICAgICAgICAgcm91dGVCb3JkZXJXaWR0aDogXCI0XCIsXHJcbiAgICAgICAgICAgIHBvaW50c1JhZGl1czogXCI4XCIsXHJcbiAgICAgICAgICAgIHBvaW50c0JvcmRlcldpZHRoOiBcIjFcIixcclxuICAgICAgICAgICAgY29udGVudFdpZHRoOiBcIjUwXCIsXHJcbiAgICAgICAgICAgIGNvbnRlbnRBbGlnbjogXCJmbGV4LXN0YXJ0XCIsXHJcbiAgICAgICAgICAgIGNoZWNrYm94U3RhdGU6IFwiZmFsc2VcIixcclxuICAgICAgICAgICAgZGVmYXVsdE9wdGlvbjogXCJmYWxzZVwiLFxyXG4gICAgICAgICAgICBVc2VyT3B0aW9uOiBcImZhbHNlXCIsXHJcbiAgICAgICAgICAgIFN0YXJ0SWNvbjogXCJcIixcclxuICAgICAgICAgICAgUm91dGVTdGFydEljb25Db2xvcjogXCJyZ2JhKDAsIDAsIDAsIDEpXCIsXHJcbiAgICAgICAgICAgIFJvdXRlU3RhcnRJY29uU2l6ZTogXCI4XCJcclxuICAgICAgICB9O1xyXG4gICAgICAgIGlmIChTZXR0aW5nc09iamVjdFtzZXR0aW5nXSkge1xyXG4gICAgICAgICAgICByZXR1cm4gU2V0dGluZ3NPYmplY3Rbc2V0dGluZ107XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgdmFyIGtlayA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oXCJTZXR0aW5nc1wiKSlcclxuICAgIC8vIGNvbnNvbGUubG9nKGtlayk7XHJcbiAgICBmdW5jdGlvbiBnZXRTdmdQb2ludFBvc2l0aW9uKHN0cmluZykge1xyXG4gICAgICAgIHN0cmluZyA9IHN0cmluZy5zbGljZSgxKTtcclxuICAgICAgICBzdHJpbmcgPSBzdHJpbmcuc3BsaXQoXCJjXCIpO1xyXG4gICAgICAgIHZhciBzdWJzdHJpbmcgPSBzdHJpbmcuc3BsaWNlKDEpO1xyXG4gICAgICAgIHN1YnN0cmluZyA9IHN1YnN0cmluZy5qb2luKFwiY1wiKTtcclxuICAgICAgICByZXR1cm4gc3Vic3RyaW5nO1xyXG4gICAgfVxyXG5cclxuXHJcbiAgICAkKCcubW9kYWwnKS5tb2RhbCgpO1xyXG5cclxuXHJcblxyXG4gICAgJCgndWwudGFicycpLnRhYnMoJ3NlbGVjdF90YWInLCAndGFiXzInKTtcclxuICAgICQoXCIjbWVudVwiKS5vbihcImNsaWNrXCIsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGlmICghJCh0aGlzKS5oYXNDbGFzcygnLmFjdGl2ZScpKSB7XHJcbiAgICAgICAgICAgICQodGhpcykuYWRkQ2xhc3MoXCJhY3RpdmVcIik7XHJcbiAgICAgICAgICAgICQoJy50YXAtdGFyZ2V0JykudGFwVGFyZ2V0KCdvcGVuJyk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgJCh0aGlzKS5yZW1vdmVDbGFzcyhcImFjdGl2ZVwiKTtcclxuICAgICAgICAgICAgJCgnLnRhcC10YXJnZXQnKS50YXBUYXJnZXQoJ2Nsb3NlJyk7XHJcbiAgICAgICAgfVxyXG4gICAgfSlcclxuXHJcbiAgICAkKCcuYnV0dG9uLWNvbGxhcHNlJykuc2lkZU5hdih7XHJcbiAgICAgICAgbWVudVdpZHRoOiAzMjMsXHJcbiAgICAgICAgZWRnZTogJ2xlZnQnLFxyXG4gICAgICAgIGNsb3NlT25DbGljazogZmFsc2UsXHJcbiAgICAgICAgZHJhZ2dhYmxlOiB0cnVlLFxyXG4gICAgICAgIG9uT3BlbjogZnVuY3Rpb24oKSB7fSxcclxuICAgICAgICBvbkNsb3NlOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgJChcIiNzbGlkZS1vdXRcIikuY3NzKFwidHJhbnNmb3JtXCIsIFwidHJhbnNsYXRlWCgtMTAwJSlcIik7XHJcbiAgICAgICAgICAgICQoXCJkaXZcIikucmVtb3ZlKFwiI3NpZGVuYXYtb3ZlcmxheVwiKTtcclxuICAgICAgICAgICAgJCgnLmJ1dHRvbi1jb2xsYXBzZScpLnNpZGVOYXYoJ2hpZGUnKTtcclxuICAgICAgICAgICAgJChcIiNzbGlkZS1vdXRcIikuY3NzKFwidHJhbnNmb3JtXCIsIFwidHJhbnNsYXRlWCgtMTAwJSlcIik7XHJcbiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKFwia2VrXCIpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICB9KTtcclxuICAgICQoJy5jb2xsYXBzaWJsZScpLmNvbGxhcHNpYmxlKCk7XHJcblxyXG4gICAgJChcIi5zaWRlLW5hdlwiKS5yZXNpemFibGUoe1xyXG4gICAgICAgIGhhbmRsZXM6ICdlJyxcclxuICAgICAgICBtYXhXaWR0aDogMTIwMCxcclxuICAgICAgICBtaW5XaWR0aDogMzAwXHJcbiAgICB9KTtcclxuXHJcbiAgICBmdW5jdGlvbiBjb21wYXJlSWQob2JqQSwgb2JqQikge1xyXG4gICAgICAgIHJldHVybiBvYmpBLmlkIC0gb2JqQi5pZDtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBjb21wYXJlVGltZShvYmpBLCBvYmpCKSB7XHJcbiAgICAgICAgcmV0dXJuIG9iakEucG9pbnRJZCAtIG9iakIucG9pbnRJZDtcclxuICAgIH1cclxuXHJcblxyXG5cclxuICAgIHZhciBhID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21hcCcpO1xyXG4gICAgdmFyIG1hcF91cmwgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdtYXAnKSk7XHJcbiAgICAkKCcjbWFwJykuYXR0cignZGF0YScsIG1hcF91cmwpO1xyXG4gICAgYS5hZGRFdmVudExpc3RlbmVyKFwibG9hZFwiLCBmdW5jdGlvbigpIHtcclxuICAgICAgICB2YXIgc3ZnRG9jID0gYS5jb250ZW50RG9jdW1lbnQ7XHJcbiAgICAgICAgdmFyIHN2Z1Jvb3QgPSBzdmdEb2MuZG9jdW1lbnRFbGVtZW50O1xyXG4gICAgICAgIHZhciBNYXBQYXRoc0dyb3VwID0gc3ZnUm9vdC5nZXRFbGVtZW50QnlJZChcIm1hcFBhdGhzXCIpO1xyXG4gICAgICAgIHZhciBQYXRoc0FycmF5ID0gTWFwUGF0aHNHcm91cC5nZXRFbGVtZW50c0J5VGFnTmFtZSgncGF0aCcpO1xyXG4gICAgICAgIHZhciB3aG9sZVN2Z0dyb3VwID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycsICdnJyk7XHJcbiAgICAgICAgJCh3aG9sZVN2Z0dyb3VwKS5hdHRyKFwiaWRcIiwgXCJ3aG9sZVN2Z0dyb3VwXCIpO1xyXG5cclxuICAgICAgICAkKFwiaW5wdXRbbmFtZT1saWdodC10cmlnZ2VyXVwiKS5hdHRyKFwiZGF0YS1saWdodFwiLCBcImxpZ2h0T2ZmXCIpO1xyXG4gICAgICAgICQoXCJpbnB1dFtuYW1lPWxpZ2h0LXRyaWdnZXJdXCIpLnByb3AoXCJjaGVja2VkXCIsIGZhbHNlKTtcclxuXHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBQYXRoc0FycmF5Lmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIFBhdGhzQXJyYXlbaV0uc3R5bGUuZmlsbCA9IGdldFNldHRpbmdGcm9tU3RvcmFnZShcIm1hcENvbG9yXCIpO1xyXG4gICAgICAgICAgICBQYXRoc0FycmF5W2ldLnN0eWxlLnN0cm9rZSA9IGdldFNldHRpbmdGcm9tU3RvcmFnZShcIm1hcFN0cm9rZUNvbG9yXCIpO1xyXG4gICAgICAgIH1cclxuXHJcblxyXG4gICAgICAgIHZhciBQYXRoRGlyZWN0aW9uID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgncGF0aCcpKTtcclxuXHJcbiAgICAgICAgaWYgKFBhdGhEaXJlY3Rpb24pIHtcclxuICAgICAgICAgICAgdmFyIHBhdGggPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoJ2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJywgJ3BhdGgnKTtcclxuXHJcbiAgICAgICAgICAgICQocGF0aCkuYXR0cignZCcsIFBhdGhEaXJlY3Rpb24pO1xyXG4gICAgICAgICAgICAkKHBhdGgpLmF0dHIoJ2ZpbGwnLCAndHJhbnNwYXJlbnQnKTtcclxuICAgICAgICAgICAgJChwYXRoKS5hdHRyKCdzdHJva2UnLCBnZXRTZXR0aW5nRnJvbVN0b3JhZ2UoXCJtYXBSb3V0ZUNvbG9yXCIpKTtcclxuICAgICAgICAgICAgJChwYXRoKS5hdHRyKCdzdHJva2Utd2lkdGgnLCBnZXRTZXR0aW5nRnJvbVN0b3JhZ2UoXCJyb3V0ZUJvcmRlcldpZHRoXCIpKTtcclxuICAgICAgICAgICAgJChwYXRoKS5hdHRyKFwic3Ryb2tlLWxpbmVjYXBcIiwgXCJyb3VuZFwiKVxyXG4gICAgICAgIH1cclxuXHJcblxyXG4gICAgICAgIFNuYXAucGx1Z2luKGZ1bmN0aW9uKFNuYXAsIEVsZW1lbnQsIFBhcGVyLCBnbG9iYWwpIHtcclxuICAgICAgICAgICAgUGFwZXIucHJvdG90eXBlLmNpcmNsZVBhdGggPSBmdW5jdGlvbihjeCwgY3ksIHIpIHtcclxuICAgICAgICAgICAgICAgIHZhciBwID0gXCJNXCIgKyBjeCArIFwiLFwiICsgY3k7XHJcbiAgICAgICAgICAgICAgICBwICs9IFwibVwiICsgLXIgKyBcIiwwXCI7XHJcbiAgICAgICAgICAgICAgICBwICs9IFwiYVwiICsgciArIFwiLFwiICsgciArIFwiIDAgMSwwIFwiICsgKHIgKiAyKSArIFwiLDBcIjtcclxuICAgICAgICAgICAgICAgIHAgKz0gXCJhXCIgKyByICsgXCIsXCIgKyByICsgXCIgMCAxLDAgXCIgKyAtKHIgKiAyKSArIFwiLDBcIjtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnBhdGgocCwgY3gsIGN5KTtcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgdmFyIHBhdGhHcm91cCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnLCAnZycpO1xyXG4gICAgICAgIHBhdGhHcm91cC5pZCA9IFwicGF0aEdyb3VwXCI7XHJcbiAgICAgICAgcGF0aEdyb3VwLmFwcGVuZChwYXRoKTtcclxuICAgICAgICB3aG9sZVN2Z0dyb3VwLmFwcGVuZChwYXRoR3JvdXApO1xyXG4gICAgICAgIHdob2xlU3ZnR3JvdXAuYXBwZW5kKE1hcFBhdGhzR3JvdXApO1xyXG4gICAgICAgIHN2Z1Jvb3QuYXBwZW5kKHdob2xlU3ZnR3JvdXApO1xyXG4gICAgICAgIHZhciBzID0gU25hcChwYXRoR3JvdXApO1xyXG5cclxuICAgICAgICB2YXIgY2lyY2xlc0FycmF5ID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnY2lyY2xlc0Nvb3JkcycpKTtcclxuICAgICAgICB2YXIgcGF0aExlbmd0aCA9IHBhdGguZ2V0VG90YWxMZW5ndGgoKTtcclxuXHJcblxyXG4gICAgICAgIHZhciBzdGFydFJvdXRlRmxhZyA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oXCJTdGFydFJvdXRlSWNvblwiKSk7XHJcblxyXG5cclxuXHJcbiAgICAgICAgdmFyIHBhdGhTdGFydEljb24gPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKFwiU3RhcnRSb3V0ZUljb25cIikpO1xyXG4gICAgICAgIHZhciBvUGFyc2VyID0gbmV3IERPTVBhcnNlcigpO1xyXG4gICAgICAgIHZhciBvRE9NID0gb1BhcnNlci5wYXJzZUZyb21TdHJpbmcocGF0aFN0YXJ0SWNvbiwgXCJ0ZXh0L3htbFwiKTtcclxuXHJcbiAgICAgICAgdmFyIHBhcnNlZFBhdGhTdGFydEljb24gPSBvRE9NLmRvY3VtZW50RWxlbWVudDtcclxuICAgICAgICB2YXIgaWNvbk9mZnNldFggPSAkKHBhcnNlZFBhdGhTdGFydEljb24pLmF0dHIoXCJkYXRhLW9mZnNldC14XCIpO1xyXG4gICAgICAgIHZhciBpY29uT2Zmc2V0WSA9ICQocGFyc2VkUGF0aFN0YXJ0SWNvbikuYXR0cihcImRhdGEtb2Zmc2V0LXlcIik7XHJcbiAgICAgICAgdmFyIGljb25TY2FsZSA9ICQocGFyc2VkUGF0aFN0YXJ0SWNvbikuYXR0cihcImRhdGEtc2NhbGVcIik7XHJcblxyXG4gICAgICAgIHZhciBncm91cCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnLCAnZycpO1xyXG5cclxuICAgICAgICBpZiAoZ2V0U2V0dGluZ0Zyb21TdG9yYWdlKFwiVXNlck9wdGlvblwiKSA9PSBcInRydWVcIiAmJiBwYXRoU3RhcnRJY29uKSB7XHJcblxyXG4gICAgICAgICAgICAkKHBhcnNlZFBhdGhTdGFydEljb24pLmF0dHIoe1xyXG4gICAgICAgICAgICAgICAgZmlsbDogZ2V0U2V0dGluZ0Zyb21TdG9yYWdlKFwiUm91dGVTdGFydEljb25Db2xvclwiKSxcclxuICAgICAgICAgICAgICAgIHRyYW5zZm9ybTogaWNvblNjYWxlXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhwYXJzZWRQYXRoU3RhcnRJY29uKTtcclxuXHJcblxyXG5cclxuICAgICAgICAgICAgJChncm91cCkuYXR0cihcInRyYW5zZm9ybVwiLCBcInRyYW5zbGF0ZShcIiArIChwYXRoLmdldFBvaW50QXRMZW5ndGgoMSkueCAtIChnZXRTZXR0aW5nRnJvbVN0b3JhZ2UoXCJSb3V0ZVN0YXJ0SWNvblNpemVcIikgLyBpY29uT2Zmc2V0WCkpICsgXCIgXCIgKyAocGF0aC5nZXRQb2ludEF0TGVuZ3RoKDEpLnkgLSAoZ2V0U2V0dGluZ0Zyb21TdG9yYWdlKFwiUm91dGVTdGFydEljb25TaXplXCIpIC8gaWNvbk9mZnNldFkpKSArIFwiKSBcIiArIFwic2NhbGUoXCIgKyBnZXRTZXR0aW5nRnJvbVN0b3JhZ2UoXCJSb3V0ZVN0YXJ0SWNvblNpemVcIikgLyAxMDAgKyBcIilcIik7XHJcbiAgICAgICAgICAgIGdyb3VwLmFwcGVuZChwYXJzZWRQYXRoU3RhcnRJY29uKTtcclxuXHJcbiAgICAgICAgICAgIHBhdGhHcm91cC5hcHBlbmQoZ3JvdXApO1xyXG4gICAgICAgICAgICB3aG9sZVN2Z0dyb3VwLmFwcGVuZChwYXRoR3JvdXApO1xyXG4gICAgICAgIH1cclxuXHJcblxyXG5cclxuXHJcbiAgICAgICAgdmFyIENpcmNsZXNBcnJheUNsb25lID0gW107XHJcbiAgICAgICAgdmFyIGNvbnRlbnRPZlBvaW50cyA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oJ1BvaW50c0NvbnRlbnQnKSkgfHwgW107XHJcblxyXG5cclxuICAgICAgICBmb3IgKHZhciBrID0gMDsgayA8IGNpcmNsZXNBcnJheS5sZW5ndGg7IGsrKykge1xyXG4gICAgICAgICAgICBDaXJjbGVzQXJyYXlDbG9uZVtrXSA9IGNpcmNsZXNBcnJheVtrXTtcclxuICAgICAgICB9XHJcblxyXG5cclxuICAgICAgICB2YXIgY2lyY2xlc0NvdW50ZXIgPSAxO1xyXG5cclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHBhdGhMZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICB2YXIgcGF0aExlbmd0aEF0UG9pbnQgPSBwYXRoLmdldFBvaW50QXRMZW5ndGgoaSk7XHJcbiAgICAgICAgICAgIHZhciBwb2ludFggPSBwYXRoTGVuZ3RoQXRQb2ludC54O1xyXG4gICAgICAgICAgICB2YXIgcG9pbnRZID0gcGF0aExlbmd0aEF0UG9pbnQueTtcclxuXHJcblxyXG4gICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IENpcmNsZXNBcnJheUNsb25lLmxlbmd0aDsgaisrKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKE1hdGguYWJzKE1hdGgucm91bmQocG9pbnRYIC0gQ2lyY2xlc0FycmF5Q2xvbmVbal0uY3gpKSA8PSA4ICYmIE1hdGguYWJzKE1hdGgucm91bmQocG9pbnRZIC0gQ2lyY2xlc0FycmF5Q2xvbmVbal0uY3kpKSA8PSA4KSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGwgPSAwOyBsIDwgY2lyY2xlc0FycmF5Lmxlbmd0aDsgbCsrKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoTWF0aC5hYnMoTWF0aC5yb3VuZChjaXJjbGVzQXJyYXlbbF0uY3ggLSBDaXJjbGVzQXJyYXlDbG9uZVtqXS5jeCkpIDw9IDQgJiYgTWF0aC5hYnMoTWF0aC5yb3VuZChjaXJjbGVzQXJyYXlbbF0uY3kgLSBDaXJjbGVzQXJyYXlDbG9uZVtqXS5jeSkpIDw9IDQpIHtcclxuXHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2lyY2xlc0FycmF5W2xdLmlkID0gY2lyY2xlc0NvdW50ZXIrKztcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcblxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBDaXJjbGVzQXJyYXlDbG9uZS5zcGxpY2UoaiwgMSk7XHJcblxyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBjb25zb2xlLmxvZyhjaXJjbGVzQXJyYXkpO1xyXG4gICAgICAgIGNpcmNsZXNBcnJheS5zb3J0KGNvbXBhcmVJZCk7XHJcbiAgICAgICAgLy8gY29uc29sZS5sb2coY2lyY2xlc0FycmF5KTtcclxuXHJcbiAgICAgICAgLy8gY29uc29sZS5sb2coY29udGVudE9mUG9pbnRzKTtcclxuXHJcblxyXG5cclxuXHJcbiAgICAgICAgY29uc29sZS5sb2cocGF0aCk7XHJcblxyXG4gICAgICAgIHZhciBwYXRoX2VuZF9wb2ludCA9IHBhdGguZ2V0UG9pbnRBdExlbmd0aChwYXRoLmdldFRvdGFsTGVuZ3RoKCkpO1xyXG4gICAgICAgIC8vIGNvbnNvbGUubG9nKGxhc3RfcGF0aF9wb2ludCk7XHJcbiAgICAgICAgdmFyIExhc3RQb2ludERhdGUgPSBuZXcgRGF0ZSgpO1xyXG4gICAgICAgIHZhciBjdXJyZW50VGltZSA9IExhc3RQb2ludERhdGUuZ2V0VGltZSgpO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGNpcmNsZXNBcnJheSk7XHJcblxyXG4gICAgICAgIGlmIChjaXJjbGVzQXJyYXlbY2lyY2xlc0FycmF5Lmxlbmd0aCAtIDFdLmN4ID09IHBhdGhfZW5kX3BvaW50LnggJiYgY2lyY2xlc0FycmF5W2NpcmNsZXNBcnJheS5sZW5ndGggLSAxXS5jeSA9PSBwYXRoX2VuZF9wb2ludC55KSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGNpcmNsZXNBcnJheVtjaXJjbGVzQXJyYXkubGVuZ3RoIC0gMV0pO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHZhciBsYXN0X3BhdGhfcG9pbnQgPSB7IGN4OiBwYXRoX2VuZF9wb2ludC54LCBjeTogcGF0aF9lbmRfcG9pbnQueSwgaWQ6IGNpcmNsZXNBcnJheS5sZW5ndGgsIHI6IGdldFNldHRpbmdGcm9tU3RvcmFnZShcInBvaW50c1JhZGl1c1wiKSwgdGltZTogY3VycmVudFRpbWUgfTtcclxuICAgICAgICAgICAgY29uc29sZS5sb2cobGFzdF9wYXRoX3BvaW50KTtcclxuICAgICAgICAgICAgY2lyY2xlc0FycmF5LnB1c2gobGFzdF9wYXRoX3BvaW50KTtcclxuICAgICAgICB9XHJcblxyXG5cclxuICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnY2lyY2xlc0Nvb3JkcycsIEpTT04uc3RyaW5naWZ5KGNpcmNsZXNBcnJheSkpO1xyXG5cclxuXHJcblxyXG4gICAgICAgIHZhciBjaXJjbGVzQXJyYXkgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdjaXJjbGVzQ29vcmRzJykpO1xyXG4gICAgICAgIHZhciBwb2ludHNBcnJheSA9IFtdO1xyXG4gICAgICAgIHZhciBzdHJpbmdBcnIgPSAnJztcclxuXHJcblxyXG5cclxuICAgICAgICAkLmVhY2goY2lyY2xlc0FycmF5LCBmdW5jdGlvbihpbmRleCwgZWwpIHtcclxuICAgICAgICAgICAgdmFyIHBvaW50c09iaiA9IHtcclxuICAgICAgICAgICAgICAgIGN4OiAwLFxyXG4gICAgICAgICAgICAgICAgY3k6IDAsXHJcbiAgICAgICAgICAgICAgICByOiAxXHJcbiAgICAgICAgICAgIH07XHJcblxyXG5cclxuICAgICAgICAgICAgdmFyIGNpcmNsZSA9IHMuY2lyY2xlUGF0aCh0aGlzLmN4LCB0aGlzLmN5LCB0aGlzLnIpLmF0dHIoe1xyXG4gICAgICAgICAgICAgICAgZmlsbDogZ2V0U2V0dGluZ0Zyb21TdG9yYWdlKFwibWFwUG9pbnRzQ29sb3JcIiksXHJcbiAgICAgICAgICAgICAgICBzdHJva2U6IGdldFNldHRpbmdGcm9tU3RvcmFnZShcIm1hcFBvaW50c0JvcmRlckNvbG9yXCIpLFxyXG4gICAgICAgICAgICAgICAgXCJzdHJva2Utd2lkdGhcIjogZ2V0U2V0dGluZ0Zyb21TdG9yYWdlKFwicG9pbnRzQm9yZGVyV2lkdGhcIiksXHJcbiAgICAgICAgICAgICAgICBpZDogZWwuaWQsXHJcbiAgICAgICAgICAgICAgICBcImRhdGEtdGltZVwiOiBlbC50aW1lXHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuXHJcblxyXG5cclxuICAgICAgICAgICAgdmFyIGludGVyc2VjdHMgPSBTbmFwLnBhdGguaW50ZXJzZWN0aW9uKGNpcmNsZSwgJChwYXRoKS5hdHRyKCdkJykpO1xyXG5cclxuICAgICAgICAgICAgaWYgKGludGVyc2VjdHMubGVuZ3RoID09IDApIHtcclxuICAgICAgICAgICAgICAgIGFsZXJ0KFwiUGxlYXNlLCByZXR1cm4gdG8gdGhlIHByZXZpb3VzIHN0ZXAgYW5kIGRyYXcgcG9pbnRzIHJpZ2h0IG9uIHRoZSByb3V0ZSBsaW5lXCIpO1xyXG4gICAgICAgICAgICAgICAgZG9jdW1lbnQubG9jYXRpb24ucmVwbGFjZShcImh0dHA6Ly8xMjcuMC4wLjE6ODA4MC9cIik7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBwb2ludHNPYmouY3ggPSBpbnRlcnNlY3RzWzBdLng7XHJcbiAgICAgICAgICAgICAgICBwb2ludHNPYmouY3kgPSBpbnRlcnNlY3RzWzBdLnk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcblxyXG4gICAgICAgICAgICBwb2ludHNBcnJheS5wdXNoKHBvaW50c09iaik7XHJcblxyXG4gICAgICAgICAgICBpbnRlcnNlY3RzLmZvckVhY2goZnVuY3Rpb24oZWwpIHtcclxuXHJcbiAgICAgICAgICAgICAgICBzLmNpcmNsZShlbC54LCBlbC55LCAxKTtcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgncG9pbnRzJywgSlNPTi5zdHJpbmdpZnkocG9pbnRzQXJyYXkpKTtcclxuICAgICAgICB9KTtcclxuXHJcblxyXG5cclxuICAgICAgICB2YXIgaW50ZXJzZWN0aW9uQ2lyY2xlcyA9IHN2Z0RvYy5nZXRFbGVtZW50c0J5VGFnTmFtZShcImNpcmNsZVwiKTtcclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGludGVyc2VjdGlvbkNpcmNsZXMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgaW50ZXJzZWN0aW9uQ2lyY2xlc1tpXS5zdHlsZS5maWxsID0gXCJ0cmFuc3BhcmVudFwiO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKGdldFNldHRpbmdGcm9tU3RvcmFnZShcImNoZWNrYm94U3RhdGVcIikgPT0gXCJ0cnVlXCIgJiYgZ2V0U2V0dGluZ0Zyb21TdG9yYWdlKFwiZGVmYXVsdE9wdGlvblwiKSA9PSBcInRydWVcIikge1xyXG4gICAgICAgICAgICB2YXIgc3RhcnRDaXJjbGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoJ2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJywgJ2NpcmNsZScpO1xyXG4gICAgICAgICAgICAkKHN0YXJ0Q2lyY2xlKS5hdHRyKHtcclxuICAgICAgICAgICAgICAgIGN4OiBwYXRoLmdldFBvaW50QXRMZW5ndGgoMSkueCxcclxuICAgICAgICAgICAgICAgIGN5OiBwYXRoLmdldFBvaW50QXRMZW5ndGgoMSkueSxcclxuICAgICAgICAgICAgICAgIHI6IGdldFNldHRpbmdGcm9tU3RvcmFnZShcInBvaW50c1JhZGl1c1wiKSxcclxuICAgICAgICAgICAgICAgIHN0cm9rZTogZ2V0U2V0dGluZ0Zyb21TdG9yYWdlKFwibWFwUG9pbnRzQm9yZGVyQ29sb3JcIiksXHJcbiAgICAgICAgICAgICAgICBmaWxsOiBnZXRTZXR0aW5nRnJvbVN0b3JhZ2UoXCJtYXBQb2ludHNDb2xvclwiKSxcclxuICAgICAgICAgICAgICAgIFwic3Ryb2tlLXdpZHRoXCI6IGdldFNldHRpbmdGcm9tU3RvcmFnZShcInBvaW50c0JvcmRlcldpZHRoXCIpXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAvLyBjb25zb2xlLmxvZygkKHN0YXJ0Q2lyY2xlKSk7XHJcbiAgICAgICAgICAgIHN2Z1Jvb3QuYXBwZW5kKHN0YXJ0Q2lyY2xlKTtcclxuICAgICAgICB9XHJcblxyXG5cclxuXHJcbiAgICAgICAgaWYgKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdQb2ludHNDb250ZW50JykgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICB2YXIgcG9pbnRzRGF0YUNvbnRlbnRBcnJheSA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oJ1BvaW50c0NvbnRlbnQnKSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdmFyIHBvaW50c0RhdGFDb250ZW50QXJyYXkgPSBbXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjaXJjbGVzQXJyYXkubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgdmFyIHBhdGhzID0gc3ZnRG9jLmdldEVsZW1lbnRCeUlkKGNpcmNsZXNBcnJheVtpXS5pZCk7XHJcbiAgICAgICAgICAgIHZhciBjaXJjbGVHcm91cCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnLCAnZycpO1xyXG5cclxuXHJcbiAgICAgICAgICAgIHZhciB0ZXh0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycsICd0ZXh0Jyk7XHJcbiAgICAgICAgICAgICQodGV4dCkuYXR0cih7XHJcbiAgICAgICAgICAgICAgICB4OiBjaXJjbGVzQXJyYXlbaV0uY3gsXHJcbiAgICAgICAgICAgICAgICB5OiBjaXJjbGVzQXJyYXlbaV0uY3kgKyAyMCxcclxuICAgICAgICAgICAgICAgIFwiZm9udC1zaXplXCI6IDEyLFxyXG4gICAgICAgICAgICAgICAgXCJmb250LXN0eWxlXCI6IFwiaXRhbGljXCIsXHJcbiAgICAgICAgICAgICAgICBmaWxsOiBcIiNjY2NjY2NjXCIsXHJcbiAgICAgICAgICAgICAgICBjbGFzczogXCJjaXR5TmFtZVwiXHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgY2lyY2xlR3JvdXAuYXBwZW5kKHBhdGhzKTtcclxuICAgICAgICAgICAgY2lyY2xlR3JvdXAuYXBwZW5kKHRleHQpO1xyXG4gICAgICAgICAgICBwYXRoR3JvdXAuYXBwZW5kKGNpcmNsZUdyb3VwKTtcclxuICAgICAgICAgICAgd2hvbGVTdmdHcm91cC5hcHBlbmQocGF0aEdyb3VwKTtcclxuICAgICAgICAgICAgc3ZnUm9vdC5hcHBlbmQod2hvbGVTdmdHcm91cCk7XHJcblxyXG5cclxuICAgICAgICAgICAgdmFyIGVxdWFsVGltZUF0dHIgPSBjaXJjbGVzQXJyYXlbaV0udGltZTtcclxuXHJcbiAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgcG9pbnRzRGF0YUNvbnRlbnRBcnJheS5sZW5ndGg7IGorKykge1xyXG4gICAgICAgICAgICAgICAgdmFyIHBvaW50VGV4dCA9IHBvaW50c0RhdGFDb250ZW50QXJyYXlbal0uZGF0YTtcclxuICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCk7XHJcblxyXG5cclxuICAgICAgICAgICAgICAgIGlmIChwb2ludHNEYXRhQ29udGVudEFycmF5W2pdLnBvaW50SWQgPT0gZXF1YWxUaW1lQXR0cikge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB2YXIgY2hlY2tlZCA9IHBvaW50c0RhdGFDb250ZW50QXJyYXlbal0ucG9pbnRJZDtcclxuXHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChwb2ludFRleHQubGVuZ3RoICE9IDApIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBGaWxsZWRDb250ZW50UGF0aHMgPSBzdmdEb2MuZ2V0RWxlbWVudEJ5SWQoY2lyY2xlc0FycmF5W2ldLmlkKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIENsb3Nlc3RUZXh0RmllbGQgPSAkKEZpbGxlZENvbnRlbnRQYXRocykucGFyZW50KCkuZmluZChcInRleHRcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKENsb3Nlc3RUZXh0RmllbGQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocG9pbnRzRGF0YUNvbnRlbnRBcnJheVtqXS5jaXR5TmFtZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2cocG9pbnRzRGF0YUNvbnRlbnRBcnJheVtqXS5jaXR5TmFtZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKENsb3Nlc3RUZXh0RmllbGQpLnRleHQocG9pbnRzRGF0YUNvbnRlbnRBcnJheVtqXS5jaXR5TmFtZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKGNpcmNsZXNBcnJheVtpXS5pZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICQoRmlsbGVkQ29udGVudFBhdGhzKS5jc3MoXCJmaWxsXCIsIFwiIzk5MDAzM1wiKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG5cclxuICAgICAgICAgICAgICAgIH1cclxuXHJcblxyXG4gICAgICAgICAgICB9XHJcblxyXG5cclxuXHJcbiAgICAgICAgICAgICQocGF0aHMpLmFkZENsYXNzKCdidXR0b24tY29sbGFwc2UnKTtcclxuICAgICAgICAgICAgJChwYXRocykuYXR0cignZGF0YS1hY3RpdmF0ZXMnLCBcInNsaWRlLW91dFwiKTtcclxuICAgICAgICAgICAgJChwYXRocykuYXR0cignaHJlZicsIFwiI1wiKTtcclxuICAgICAgICAgICAgcGF0aHMuc3R5bGUuY3Vyc29yID0gXCJwb2ludGVyXCI7XHJcbiAgICAgICAgICAgICQocGF0aHMpLm1vdXNlZW50ZXIoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAkKHRoaXMpLmNzcyhcInRyYW5zaXRpb25cIiwgXCIwLjVzXCIpO1xyXG4gICAgICAgICAgICAgICAgJCh0aGlzKS5jc3MoXCJzdHJva2Utd2lkdGhcIiwgXCI2cHhcIik7XHJcbiAgICAgICAgICAgICAgICAkKHRoaXMpLmNzcyhcInN0cm9rZVwiLCBnZXRTZXR0aW5nRnJvbVN0b3JhZ2UoXCJtYXBQb2ludHNCb3JkZXJDb2xvclwiKSk7XHJcblxyXG5cclxuICAgICAgICAgICAgfSkubW91c2VvdXQoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAkKHRoaXMpLmNzcyhcInRyYW5zaXRpb25cIiwgXCIwLjVzXCIpO1xyXG4gICAgICAgICAgICAgICAgJCh0aGlzKS5jc3MoXCJzdHJva2Utd2lkdGhcIiwgXCIzcHhcIik7XHJcbiAgICAgICAgICAgICAgICAkKHRoaXMpLmNzcyhcInN0cm9rZVwiLCBnZXRTZXR0aW5nRnJvbVN0b3JhZ2UoXCJtYXBQb2ludHNCb3JkZXJDb2xvclwiKSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgdmFyIERpc3BsYWNlbWVudE9iaiA9IHtcclxuICAgICAgICAgICAgICAgIHpvb206IDEwMCxcclxuICAgICAgICAgICAgICAgIHRvcDogMCxcclxuICAgICAgICAgICAgICAgIGJvdHRvbTogMCxcclxuICAgICAgICAgICAgICAgIGxlZnQ6IDAsXHJcbiAgICAgICAgICAgICAgICByaWdodDogMFxyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgdmFyIEZ1bGxNYXBHcm91cCA9IFNuYXAod2hvbGVTdmdHcm91cCk7XHJcbiAgICAgICAgICAgIHZhciBwYXRoRGlzcGxhY2VtZW50ID0gU25hcChwYXRoR3JvdXApO1xyXG5cclxuICAgICAgICAgICAgLy8gY29uc29sZS5sb2cocG9pbnRzRGF0YUNvbnRlbnRBcnJheSk7XHJcbiAgICAgICAgICAgIHZhciBzYXZlZERpc3BsYWNlbWVudCA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oXCJtYXBTdHlsZVByb3BlcnRpZXNcIikpIHx8IHsgdHJhbnNmb3JtOiBcIlwiIH07XHJcblxyXG4gICAgICAgICAgICB2YXIgem9vbSwgbW92ZUxlZnQsIG1vdmVUb3A7XHJcbiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKHNhdmVkRGlzcGxhY2VtZW50LnRyYW5zZm9ybS5sZW5ndGgpO1xyXG4gICAgICAgICAgICBpZiAoKHNhdmVkRGlzcGxhY2VtZW50LnRyYW5zZm9ybSkpIHtcclxuICAgICAgICAgICAgICAgIC8vIHNjYWxlSW1nID0gc3R5bGVQcm9wcy50cmFuc2Zvcm07XHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIHRyYW5zZm9ybVN0cmluZyA9IChzYXZlZERpc3BsYWNlbWVudC50cmFuc2Zvcm0pO1xyXG4gICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coc2NhbGVJbWcpO1xyXG4gICAgICAgICAgICAgICAgdmFyIHJlZ2V4ID0gL1srLV0/XFxkKyhcXC5cXGQrKT8vZztcclxuICAgICAgICAgICAgICAgIHZhciBTdHJpbmdWYWx1ZXMgPSB0cmFuc2Zvcm1TdHJpbmcubWF0Y2gocmVnZXgpLm1hcChmdW5jdGlvbih2KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBhcnNlRmxvYXQodik7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKFN0cmluZ1ZhbHVlcyk7XHJcblxyXG4gICAgICAgICAgICAgICAgc2NhbGVJbWcgPSBTdHJpbmdWYWx1ZXNbMF07XHJcbiAgICAgICAgICAgICAgICBtb3ZlTGVmdCA9IFN0cmluZ1ZhbHVlc1sxXSxcclxuICAgICAgICAgICAgICAgICAgICBtb3ZlVG9wID0gU3RyaW5nVmFsdWVzWzJdO1xyXG4gICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coIHNjYWxlSW1nLCBtb3ZlTGVmdCwgbW92ZVRvcCk7XHJcblxyXG4gICAgICAgICAgICAgICAgRnVsbE1hcEdyb3VwLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgXCJzY2FsZShcIiArIHNjYWxlSW1nICsgXCIpIHRyYW5zbGF0ZShcIiArIChtb3ZlTGVmdCkgKyBcIiBcIiArIChtb3ZlVG9wKSArIFwiKVwiKTtcclxuICAgICAgICAgICAgICAgIC8vIHBhdGhEaXNwbGFjZW1lbnQuYXR0cihcInRyYW5zZm9ybVwiLCBcInNjYWxlKFwiICsgc2NhbGVJbWcgKyBcIikgdHJhbnNsYXRlKFwiKyAoLW1vdmVMZWZ0KSArXCIgXCIgKyAoLW1vdmVUb3ApKyBcIilcIik7XHJcbiAgICAgICAgICAgIH1cclxuXHJcblxyXG5cclxuICAgICAgICAgICAgc2F2ZWREaXNwbGFjZW1lbnQudG9wID0gcGFyc2VJbnQoc2F2ZWREaXNwbGFjZW1lbnQudG9wKTtcclxuICAgICAgICAgICAgc2F2ZWREaXNwbGFjZW1lbnQubGVmdCA9IHBhcnNlSW50KHNhdmVkRGlzcGxhY2VtZW50LmxlZnQpO1xyXG4gICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhzYXZlZERpc3BsYWNlbWVudC50b3AsIHNhdmVkRGlzcGxhY2VtZW50LmxlZnQpO1xyXG5cclxuXHJcbiAgICAgICAgICAgIHBhdGhzLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICQoJy5idXR0b24tY29sbGFwc2UnKS5zaWRlTmF2KCdzaG93Jyk7XHJcbiAgICAgICAgICAgICAgICAkKFwiLmJ1dHRvbi1jb2xsYXBzZVwiKS5vZmYoJ2NsaWNrJykuc2lkZU5hdigpO1xyXG5cclxuICAgICAgICAgICAgICAgIHZhciBOcG9pbnQgPSBwYXJzZUludCh0aGlzLmlkKTtcclxuICAgICAgICAgICAgICAgIHZhciBkYXRhVGltZSA9ICQodGhpcykuYXR0cignZGF0YS10aW1lJyk7XHJcbiAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInBvaW50SW5kZXhcIikuaW5uZXJIVE1MID0gTnBvaW50O1xyXG4gICAgICAgICAgICAgICAgdmFyIGN1cnJlbnRQYXRoID0gdGhpcztcclxuICAgICAgICAgICAgICAgIHZhciBwb2ludERhdGFUaW1lID0gJCh0aGlzKS5hdHRyKCdkYXRhLXRpbWUnKTtcclxuXHJcblxyXG5cclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgZ2V0UG9pbnREYXRhID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnUG9pbnRzQ29udGVudCcpKSB8fCBbXTtcclxuICAgICAgICAgICAgICAgIHZhciBwb2ludHNEZWZhdWx0RGlzcGxhY2VtZW50ID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbShcIm1hcFN0eWxlUHJvcGVydGllc1wiKSkgfHwge1xyXG4gICAgICAgICAgICAgICAgICAgIHRyYW5zZm9ybTogXCJcIlxyXG4gICAgICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhGdWxsTWFwR3JvdXApO1xyXG4gICAgICAgICAgICAgICAgaWYgKChwb2ludHNEZWZhdWx0RGlzcGxhY2VtZW50LnRyYW5zZm9ybSkubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIHNjYWxlSW1nID0gc3R5bGVQcm9wcy50cmFuc2Zvcm07XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHRyYW5zZm9ybVN0cmluZyA9IChwb2ludHNEZWZhdWx0RGlzcGxhY2VtZW50LnRyYW5zZm9ybSk7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coc2NhbGVJbWcpO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciByZWdleCA9IC9bKy1dP1xcZCsoXFwuXFxkKyk/L2c7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIFN0cmluZ1ZhbHVlcyA9IHRyYW5zZm9ybVN0cmluZy5tYXRjaChyZWdleCkubWFwKGZ1bmN0aW9uKHYpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBhcnNlRmxvYXQodik7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coU3RyaW5nVmFsdWVzKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgem9vbSA9IFN0cmluZ1ZhbHVlc1swXTtcclxuICAgICAgICAgICAgICAgICAgICBtb3ZlTGVmdCA9IFN0cmluZ1ZhbHVlc1sxXSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgbW92ZVRvcCA9IFN0cmluZ1ZhbHVlc1syXTtcclxuXHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG5cclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoIWdldFBvaW50RGF0YVtOcG9pbnQgLSAxXSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciB6b29tID0gMTtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgbW92ZVRvcCA9IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIG1vdmVMZWZ0ID0gMDtcclxuICAgICAgICAgICAgICAgICAgICAvLyB2YXIgc2F2ZWRab29tID0gem9vbTtcclxuICAgICAgICAgICAgICAgICAgICAvLyBzYXZlZERpc3BsYWNlbWVudC50b3AgPSBtb3ZlVG9wO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIHNhdmVkRGlzcGxhY2VtZW50LmxlZnQgPSBtb3ZlTGVmdDtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coc2F2ZWREaXNwbGFjZW1lbnQudG9wICsgXCIlXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICQoXCIjcG9pbnROYW1lXCIpLmh0bWwoXCJcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgJChcIiNwb2ludF9uYW1lX2xhYmVsXCIpLnJlbW92ZUNsYXNzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gJCgnLm1hcGJnJykuYW5pbWF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgIHpvb206IHNhdmVkWm9vbSArIFwiJVwiLFxyXG4gICAgICAgICAgICAgICAgICAgIC8vICAgICB0b3A6IHNhdmVkRGlzcGxhY2VtZW50LnRvcCArIFwiJVwiLFxyXG4gICAgICAgICAgICAgICAgICAgIC8vICAgICBsZWZ0OiBzYXZlZERpc3BsYWNlbWVudC5sZWZ0ICsgXCIlXCJcclxuICAgICAgICAgICAgICAgICAgICAvLyB9KTtcclxuICAgICAgICAgICAgICAgICAgICBGdWxsTWFwR3JvdXAuYW5pbWF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zZm9ybTogXCJzY2FsZShcIiArIHpvb20gKyBcIikgdHJhbnNsYXRlKFwiICsgKG1vdmVUb3ApICsgXCIgXCIgKyAobW92ZUxlZnQpICsgXCIpXCJcclxuICAgICAgICAgICAgICAgICAgICB9LCAyMDApO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgem9vbSA9IGdldFBvaW50RGF0YVtOcG9pbnQgLSAxXS56b29tO1xyXG4gICAgICAgICAgICAgICAgICAgIG1vdmVUb3AgPSBnZXRQb2ludERhdGFbTnBvaW50IC0gMV0udG9wO1xyXG4gICAgICAgICAgICAgICAgICAgIG1vdmVMZWZ0ID0gZ2V0UG9pbnREYXRhW05wb2ludCAtIDFdLmxlZnQ7XHJcblxyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIC8vIERpc3BsYWNlbWVudE9iai56b29tID0gc2F2ZWRab29tO1xyXG4gICAgICAgICAgICAgICAgLy8gRGlzcGxhY2VtZW50T2JqLnRvcCA9IHNhdmVkRGlzcGxhY2VtZW50LnRvcDtcclxuICAgICAgICAgICAgICAgIC8vIERpc3BsYWNlbWVudE9iai5sZWZ0ID0gc2F2ZWREaXNwbGFjZW1lbnQubGVmdDtcclxuXHJcblxyXG4gICAgICAgICAgICAgICAgJChcIiNwbHVzXCIpLmJpbmQoJ2NsaWNrJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgem9vbSArPSAwLjE7XHJcbiAgICAgICAgICAgICAgICAgICAgRGlzcGxhY2VtZW50T2JqLnpvb20gPSB6b29tO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKE1hcFBhdGhzR3JvdXApO1xyXG4gICAgICAgICAgICAgICAgICAgIEZ1bGxNYXBHcm91cC5hbmltYXRlKHsgXCJ0cmFuc2Zvcm1cIjogXCJzY2FsZShcIiArIHpvb20gKyBcIikgdHJhbnNsYXRlKFwiICsgKG1vdmVMZWZ0KSArIFwiIFwiICsgbW92ZVRvcCArIFwiKVwiIH0sIDMwMCk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICAkKFwiI21pbnVzXCIpLmJpbmQoJ2NsaWNrJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgem9vbSAtPSAwLjE7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGlmICh6b29tIDw9IDEuMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB6b29tID0gMS4wO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBEaXNwbGFjZW1lbnRPYmouem9vbSA9IHpvb207XHJcbiAgICAgICAgICAgICAgICAgICAgRnVsbE1hcEdyb3VwLmFuaW1hdGUoeyB0cmFuc2Zvcm06IFwic2NhbGUoXCIgKyB6b29tICsgXCIpIHRyYW5zbGF0ZShcIiArIChtb3ZlTGVmdCkgKyBcIiBcIiArIG1vdmVUb3AgKyBcIilcIiB9LCAzMDApO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcblxyXG5cclxuICAgICAgICAgICAgICAgICQoXCIjbW92ZUxlZnRcIikuYmluZChcImNsaWNrXCIsIGZ1bmN0aW9uKCkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBtb3ZlTGVmdCArPSAyMDtcclxuICAgICAgICAgICAgICAgICAgICBEaXNwbGFjZW1lbnRPYmoubGVmdCA9IG1vdmVMZWZ0O1xyXG4gICAgICAgICAgICAgICAgICAgIEZ1bGxNYXBHcm91cC5hbmltYXRlKHsgdHJhbnNmb3JtOiBcInNjYWxlKFwiICsgem9vbSArIFwiKSB0cmFuc2xhdGUoXCIgKyAobW92ZUxlZnQpICsgXCIgXCIgKyBtb3ZlVG9wICsgXCIpXCIgfSwgMzAwKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgJChcIiNtb3ZlUmlnaHRcIikuYmluZChcImNsaWNrXCIsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIG1vdmVMZWZ0IC09IDIwO1xyXG4gICAgICAgICAgICAgICAgICAgIERpc3BsYWNlbWVudE9iai5sZWZ0ID0gbW92ZUxlZnQ7XHJcbiAgICAgICAgICAgICAgICAgICAgRnVsbE1hcEdyb3VwLmFuaW1hdGUoeyB0cmFuc2Zvcm06IFwic2NhbGUoXCIgKyB6b29tICsgXCIpIHRyYW5zbGF0ZShcIiArIChtb3ZlTGVmdCkgKyBcIiBcIiArIG1vdmVUb3AgKyBcIilcIiB9LCAzMDApO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAkKFwiI21vdmVUb3BcIikuYmluZChcImNsaWNrXCIsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIG1vdmVUb3AgKz0gMjA7XHJcbiAgICAgICAgICAgICAgICAgICAgRGlzcGxhY2VtZW50T2JqLnRvcCA9IG1vdmVUb3A7XHJcbiAgICAgICAgICAgICAgICAgICAgRnVsbE1hcEdyb3VwLmFuaW1hdGUoeyB0cmFuc2Zvcm06IFwic2NhbGUoXCIgKyB6b29tICsgXCIpIHRyYW5zbGF0ZShcIiArIChtb3ZlTGVmdCkgKyBcIiBcIiArIG1vdmVUb3AgKyBcIilcIiB9LCAzMDApO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAkKFwiI21vdmVCb3R0b21cIikuYmluZChcImNsaWNrXCIsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIG1vdmVUb3AgLT0gMjA7XHJcbiAgICAgICAgICAgICAgICAgICAgRGlzcGxhY2VtZW50T2JqLnRvcCA9IG1vdmVUb3A7XHJcbiAgICAgICAgICAgICAgICAgICAgRnVsbE1hcEdyb3VwLmFuaW1hdGUoeyB0cmFuc2Zvcm06IFwic2NhbGUoXCIgKyB6b29tICsgXCIpIHRyYW5zbGF0ZShcIiArIChtb3ZlTGVmdCkgKyBcIiBcIiArIG1vdmVUb3AgKyBcIilcIiB9LCAzMDApO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcblxyXG5cclxuXHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdQb2ludHNDb250ZW50JykgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwia2VrXCIpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB2YXIgUG9pbnRMYXN0RGF0YTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBnZXRQb2ludERhdGEubGVuZ3RoOyBqKyspIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjb3VudCA9IGdldFBvaW50RGF0YVtqXS5wb2ludElkID09IGRhdGFUaW1lO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZ2V0UG9pbnREYXRhW2pdLnBvaW50SWQgPT0gZGF0YVRpbWUpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBGdWxsTWFwR3JvdXAuYW5pbWF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNmb3JtOiBcInNjYWxlKFwiICsgcGFyc2VGbG9hdChnZXRQb2ludERhdGFbal0uem9vbSkgKyBcIikgdHJhbnNsYXRlKFwiICsgKGdldFBvaW50RGF0YVtqXS5sZWZ0KSArIFwiIFwiICsgZ2V0UG9pbnREYXRhW2pdLnRvcCArIFwiKVwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCAzMDApO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vICQoJy5tYXBiZycpLmFuaW1hdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gICAgIHpvb206IGdldFBvaW50RGF0YVtqXS50cmFuc2Zvcm0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGdldFBvaW50RGF0YVtqXS5jaXR5TmFtZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgUG9pbnRDaXR5TmFtZSA9IGdldFBvaW50RGF0YVtqXS5jaXR5TmFtZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFBvaW50Q2l0eU5hbWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoY291bnQpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBQb2ludExhc3REYXRhID0gZ2V0UG9pbnREYXRhW2pdLmRhdGE7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFBvaW50Q2l0eU5hbWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChQb2ludENpdHlOYW1lKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICQoXCIjcG9pbnROYW1lXCIpLnZhbChQb2ludENpdHlOYW1lKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJChcIiNwb2ludE5hbWVcIikuY2xvc2VzdChcImxhYmVsXCIpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJChcIiNwb2ludF9uYW1lX2xhYmVsXCIpLmFkZENsYXNzKFwiYWN0aXZlXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICQoXCIjcG9pbnROYW1lXCIpLnZhbChcIlwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJChcIiNwb2ludF9uYW1lX2xhYmVsXCIpLnJlbW92ZUNsYXNzKFwiYWN0aXZlXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgZWRpdG9yLnNldERhdGEoUG9pbnRMYXN0RGF0YSk7XHJcblxyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIHZhciBzdWJwYXRoSWNvbnMgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdzdWJwYXRoSWNvbnMnKSkgfHwgW107XHJcblxyXG5cclxuICAgICAgICAgICAgICAgIHZhciBzdWJwYXRoU2V0dGluZyA9IHtcclxuICAgICAgICAgICAgICAgICAgICBwb2ludElkOiBcIlwiLFxyXG4gICAgICAgICAgICAgICAgICAgIGljb246IFwiXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgY29sb3I6IFwiXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgc2l6ZTogNSxcclxuICAgICAgICAgICAgICAgICAgICBpY29uX3NyYzogXCJcIlxyXG4gICAgICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgICAgICAkKCdpbnB1dFtuYW1lPXNob3dJY29uXScpLnByb3AoXCJjaGVja2VkXCIsIGZhbHNlKTtcclxuICAgICAgICAgICAgICAgICQoXCIjc2V0dGluZ3NfYnRuXCIpLmF0dHIoXCJkaXNhYmxlZFwiLCBcImRpc2FibGVkXCIpO1xyXG5cclxuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc3VicGF0aEljb25zLmxlbmd0aDsgaSsrKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChwYXJzZUludChzdWJwYXRoSWNvbnNbaV0ucG9pbnRJZCkgPT0gTnBvaW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICQoJ2lucHV0W25hbWU9c2hvd0ljb25dJykucHJvcChcImNoZWNrZWRcIiwgXCJjaGVja2VkXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkKFwiI3NldHRpbmdzX2J0blwiKS5yZW1vdmVBdHRyKCdkaXNhYmxlZCcpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCQoJ2lucHV0W25hbWU9c2hvd0ljb25dJykuYXR0cihcImNoZWNrZWRcIikpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICQoJyNpY29uX3N3aXRjaCcpLm9uKFwiY2xpY2tcIiwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCQoJ2lucHV0W25hbWU9c2hvd0ljb25dJykuaXMoXCI6Y2hlY2tlZFwiKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkKFwiaW5wdXRbbmFtZT1zaG93SWNvbl1cIikuYXR0cihcImNoZWNrZWRcIiwgdHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICQoXCIjc2V0dGluZ3NfYnRuXCIpLnJlbW92ZUF0dHIoJ2Rpc2FibGVkJyk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7JChcImlucHV0W25hbWU9c2hvd0ljb25dXCIpLmF0dHIoXCJjaGVja2VkXCIsIGZhbHNlKTt9LCAzMDApO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICQoXCJpbnB1dFtuYW1lPXNob3dJY29uXVwiKS5hdHRyKFwiY2hlY2tlZFwiLCBmYWxzZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICQoXCIjc2V0dGluZ3NfYnRuXCIpLmF0dHIoXCJkaXNhYmxlZFwiLCBcImRpc2FibGVkXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHN1YnBhdGhJY29ucy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBhcnNlSW50KHN1YnBhdGhJY29uc1tpXS5wb2ludElkKSA9PSBOcG9pbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWJwYXRoSWNvbnMuc3BsaWNlKGksIDEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHN1YnBhdGhJY29ucy5zb3J0KGNvbXBhcmVUaW1lKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oXCJzdWJwYXRoSWNvbnNcIiwgSlNPTi5zdHJpbmdpZnkoc3VicGF0aEljb25zKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgJChcIiNzZXR0aW5nc19idG5cIikub24oXCJjbGlja1wiLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAkKFwiI21vZGFsMlwiKS5tb2RhbChcIm9wZW5cIik7XHJcblxyXG4gICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICQoXCIubW9kYWwyXCIpLm1vZGFsKHtcclxuICAgICAgICAgICAgICAgICAgICByZWFkeTogZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJChcImlucHV0W25hbWU9bGlnaHQtdHJpZ2dlcl1cIikuYXR0cihcImRhdGEtbGlnaHRcIiwgZmFsc2UpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICAkKFwiLm1vZGFsMlwiKS5tb2RhbCh7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVhZHk6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdHJ1ZUVsZW1lbnQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpY29uX3NldHRpbmdzID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnc3VicGF0aEljb25zJykpIHx8IFtdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaWNvbl9zZXR0aW5ncy5sZW5ndGggIT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBpY29uX3NldHRpbmdzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ1ZUVsZW1lbnQgPSBwYXJzZUludChpY29uX3NldHRpbmdzW2ldLnBvaW50SWQpID09PSBOcG9pbnQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRydWVFbGVtZW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiRVF1YUxTIVwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJChcImlucHV0W25hbWU9Y29sb3JdXCIpLnZhbChpY29uX3NldHRpbmdzW2ldLmNvbG9yKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGljb25fY29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJzdWJQYXRoSWNvbk9ialwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJChcIiNzdWJQYXRoSWNvbk9ialwiKS5hdHRyKFwiZGF0YVwiLCBpY29uX3NldHRpbmdzW2ldLmljb25fc3JjKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9hZEljb24oaWNvbl9jb250YWluZXIsIGljb25fc2V0dGluZ3NbaV0uY29sb3IpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCIgTk9UIEVRdWFMUyFcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICQoXCJpbnB1dFtuYW1lPWNvbG9yXVwiKS52YWwoXCJyZ2JhKDI1NSwgMjU1LCAyNTUsIDEpXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKFwiI3N1YlBhdGhJY29uT2JqXCIpLmF0dHIoXCJkYXRhXCIsIFwiXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG5cclxuICAgICAgICAgICAgICAgICAgICBjb21wbGV0ZTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdWJwYXRoSWNvbnMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzdWJwYXRoSWNvbnMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc3VicGF0aEljb25zW2ldLnBvaW50SWQgPT0gTnBvaW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1YnBhdGhJY29ucy5zcGxpY2UoaSwgMSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKE5wb2ludCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzb3VyY2UgPSAkKFwiI3N1YlBhdGhJY29uT2JqXCIpLmF0dHIoXCJkYXRhXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoc291cmNlLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1YnBhdGhTZXR0aW5nLmljb25fc3JjID0gc291cmNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3VicGF0aFNldHRpbmcuY29sb3IgPSAkKFwiaW5wdXRbbmFtZT1jb2xvcl1cIikudmFsKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWJwYXRoU2V0dGluZy5wb2ludElkID0gTnBvaW50O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3VicGF0aEljb25zLnB1c2goc3VicGF0aFNldHRpbmcpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3VicGF0aEljb25zLnNvcnQoY29tcGFyZVRpbWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oXCJzdWJwYXRoSWNvbnNcIiwgSlNPTi5zdHJpbmdpZnkoc3VicGF0aEljb25zKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhzdWJwYXRoSWNvbnMpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgTWF0ZXJpYWxpemUudG9hc3QoJ05vIGljb24gdG8gdGhpcyBwb2ludCEnLCAyMDAwKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcblxyXG5cclxuICAgICAgICAgICAgICAgICQoXCJpbnB1dFtuYW1lID0gY29sb3JdXCIpLm1pbmljb2xvcnMoeyAvL2pxdWVyeS1taW5pY29sb3JzIHBsdWdpbiBzZXR0aW5nc1xyXG4gICAgICAgICAgICAgICAgICAgIG9wYWNpdHk6IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgZm9ybWF0OiBcInJnYlwiLFxyXG4gICAgICAgICAgICAgICAgICAgIHJnYmFTdHJpbmc6IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgICAgIGNoYW5nZTogZnVuY3Rpb24oaHNsLCByZ2IpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJnYmFTdHJpbmcgPSAncmdiYSgnICsgcmdiLnIgKyAnLCAnICsgcmdiLmcgKyAnLCAnICsgcmdiLmIgKyAnLCAnICsgcmdiLmEgKyAnKSc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJnYmFTdHJpbmcpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgc3dhdGNoZXM6IFsncmdiYSgxNTQsIDksIDE3MywgMSknLCAncmdiYSgyNDAsIDE3LCAxNywgMSknLCAncmdiYSgwLCAyNTUsIDIxLCAxKScsICdyZ2JhKDE1LCA0MywgMjU1LCAxKScsICdyZ2JhKDI1NSwgMjM5LCAxMywgMSknXSxcclxuICAgICAgICAgICAgICAgICAgICBzaG93U3BlZWQ6IDEwMFxyXG4gICAgICAgICAgICAgICAgfSk7XHJcblxyXG5cclxuXHJcbiAgICAgICAgICAgICAgICAkKFwiLmljb25fZ2FsbGVyeV9faXRlbVwiKS5vbihcImNsaWNrXCIsIGZ1bmN0aW9uKCkgeyAvL2Nob29zZSBpY29uIG9mIFJvdXRlIFN0YXJ0XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGljb25TUkMgPSAkKHRoaXMpLmF0dHIoXCJzcmNcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coaWNvblNSQyk7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGljb25fY29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJzdWJQYXRoSWNvbk9ialwiKTtcclxuICAgICAgICAgICAgICAgICAgICAkKFwiI3N1YlBhdGhJY29uT2JqXCIpLmF0dHIoXCJkYXRhXCIsIGljb25TUkMpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBzdWJwYXRoU2V0dGluZy5wb2ludElkID0gTnBvaW50O1xyXG4gICAgICAgICAgICAgICAgICAgIHN1YnBhdGhTZXR0aW5nLmljb25fc3JjID0gaWNvblNSQztcclxuICAgICAgICAgICAgICAgICAgICBsb2FkSWNvbihpY29uX2NvbnRhaW5lcik7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIC8vIFNldHRpbmdzT2JqLlN0YXJ0SWNvbiA9IGljb25TUkM7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gbG9jYWxTdG9yYWdlLnNldEl0ZW0oXCJTZXR0aW5nc1wiLCBKU09OLnN0cmluZ2lmeShTZXR0aW5nc09iaikpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcblxyXG5cclxuXHJcblxyXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gbG9hZEljb24oaWNvbl9jb250YWluZXIsIGljb25fY29sb3IpIHsgLy8gbG9hZCBpY29uIHRvIHNob3cgZXhhbXBsZVxyXG4gICAgICAgICAgICAgICAgICAgIGljb25fY29udGFpbmVyLmFkZEV2ZW50TGlzdGVuZXIoXCJsb2FkXCIsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3ZnRG9jID0gaWNvbl9jb250YWluZXIuY29udGVudERvY3VtZW50OyAvL2dldCB0aGUgaW5uZXIgRE9NIG9mIGFscGhhLnN2Z1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3ZnUm9vdCA9IHN2Z0RvYy5kb2N1bWVudEVsZW1lbnQ7XHJcblxyXG5cclxuXHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcGF0aHNfZ3JvdXAgPSBzdmdSb290LnF1ZXJ5U2VsZWN0b3IoXCIjdHJhbnNwb3J0XCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcyA9IG5ldyBYTUxTZXJpYWxpemVyKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwYXRocyA9IHBhdGhzX2dyb3VwLmdldEVsZW1lbnRzQnlUYWdOYW1lKFwicGF0aFwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2cocGF0aHMpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBwYXRocy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGF0aHNbaV0uc3R5bGUuZmlsbCA9IGljb25fY29sb3I7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpY29uT2JqID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJzdWJQYXRoSWNvbk9ialwiKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwYXRoRGlyID0gcy5zZXJpYWxpemVUb1N0cmluZyhwYXRoc19ncm91cCk7IC8vY29udmVydCBodG1sIGVsZW1lbnQgdG8gc3RyaW5nIHdpdGggWE1MU2VyaWFsaXplclxyXG4gICAgICAgICAgICAgICAgICAgICAgICBzdWJwYXRoU2V0dGluZy5pY29uID0gcGF0aERpcjtcclxuXHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhzdWJwYXRoSWNvbnMpO1xyXG5cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHZhciBzdWJwYXRoSWNvbnMgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdzdWJwYXRoSWNvbnMnKSkgfHwgW11cclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coc3VicGF0aEljb25zKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gaWYoc3VicGF0aEljb25zLmxlbmd0aCA+IDApe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyAgICAgZm9yKHZhciBpID0gMDsgaSA8IHN1YnBhdGhJY29ucy5sZW5ndGg7IGkrKylcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gICAgICAgICBpZihzdWJwYXRoU2V0dGluZ1tpXS5wb2ludElkID09IE5wb2ludCl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgIGZvcih2YXIgaiA9IDA7IGogPCBwYXRocy5sZW5ndGg7IGorKyl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgICAgICBwYXRoc1tqXS5zdHlsZS5maWxsID0gc3VicGF0aFNldHRpbmdbaV0uY29sb3I7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIH1cclxuXHJcblxyXG5cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICQoXCJpbnB1dFtuYW1lPWNvbG9yXVwiKS5jaGFuZ2UoZnVuY3Rpb24oZWwpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBvcHRpb25TZWxlY3RlZCA9ICQoXCJvcHRpb246c2VsZWN0ZWRcIiwgdGhpcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdmFsdWVTZWxlY3RlZCA9IHRoaXMudmFsdWU7XHJcblxyXG5cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbmFtZSA9IHRoaXMubmFtZTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWJwYXRoU2V0dGluZ1tuYW1lXSA9IHZhbHVlU2VsZWN0ZWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhzdWJwYXRoU2V0dGluZ1tuYW1lXSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHBhdGhzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGF0aHNbaV0uc3R5bGUuZmlsbCA9IHN1YnBhdGhTZXR0aW5nLmNvbG9yO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShcIlNldHRpbmdzXCIsIEpTT04uc3RyaW5naWZ5KFNldHRpbmdzT2JqKSk7IFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coU2V0dGluZ3NPYmopO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vICQoXCJpbnB1dFtuYW1lID0gc2l6ZV1cIikuY2hhbmdlKGZ1bmN0aW9uKCkgeyAgICAgIC8vIHVzZXIgY2hvaWNlIG9mIHJvdXRlIHN0YXJ0IGljb24gc2l6ZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyAgICAgdmFyIG9wdGlvblNlbGVjdGVkID0gJChcIm9wdGlvbjpzZWxlY3RlZFwiLCB0aGlzKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gICAgIHZhciB2YWx1ZVNlbGVjdGVkID0gdGhpcy52YWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gICAgIHZhciBuYW1lID0gdGhpcy5uYW1lO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyAgICAgc3VicGF0aFNldHRpbmdbbmFtZV0gPSB2YWx1ZVNlbGVjdGVkO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyAgICAgJChcIiNzdWJQYXRoSWNvbk9ialwiKS5hdHRyKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gICAgICAgICB3aWR0aDogc3VicGF0aFNldHRpbmdbbmFtZV0gKiAxMCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gICAgICAgICBoZWlnaHQ6IHN1YnBhdGhTZXR0aW5nW25hbWVdICogMTBcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gICAgIHN2Z1Jvb3Quc2V0QXR0cmlidXRlKFwid2lkdGhcIiwgJChpY29uT2JqKS5hdHRyKFwid2lkdGhcIikpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyAgICAgc3ZnUm9vdC5zZXRBdHRyaWJ1dGUoXCJoZWlnaHRcIiwgJChpY29uT2JqKS5hdHRyKFwiaGVpZ2h0XCIpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gICAgIC8vIGNvbnNvbGUubG9nKHN2Z1Jvb3QpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyAgICAgLy8gY29uc29sZS5sb2coU2V0dGluZ3NPYmopO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG5cclxuXHJcblxyXG5cclxuICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiU2F2ZVBvaW50Q29udGVudFwiKS5vbmNsaWNrID0gZnVuY3Rpb24oKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHZhciBwb2ludHNEYXRhQ29udGVudCA9IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcG9pbnRJZDogMCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2l0eU5hbWU6IFwiXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHpvb206IHpvb20sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxlZnQ6IG1vdmVMZWZ0LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0b3A6IG1vdmVUb3AsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNsaWRlcjogXCJmYWxzZVwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiBcIlwiXHJcbiAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICAgICAvLyB2YXIgSW5wdXRab29tVmFsdWUgPSBwYXJzZUludChkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInBvaW50Wm9vbVwiKS52YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gdmFyIElucHV0VG9wVmFsdWUgPSBwYXJzZUludChkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInBvaW50VG9wXCIpLnZhbHVlKTtcclxuICAgICAgICAgICAgICAgICAgICAvLyB2YXIgSW5wdXRCb3R0b21WYWx1ZSA9IHBhcnNlSW50KGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicG9pbnRCb3R0b21cIikudmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIHZhciBJbnB1dExlZnRWYWx1ZSA9IHBhcnNlSW50KGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicG9pbnRMZWZ0XCIpLnZhbHVlKTtcclxuICAgICAgICAgICAgICAgICAgICAvLyB2YXIgSW5wdXRSaWdodFZhbHVlID0gcGFyc2VJbnQoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3BvaW50UmlnaHQnKS52YWx1ZSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHZhciBQb2ludE5hbWUgPSAkKFwiI3BvaW50TmFtZVwiKS52YWwoKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgcG9pbnRzRGF0YUNvbnRlbnQucG9pbnRJZCA9IHBvaW50RGF0YVRpbWU7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHBvaW50c0RhdGFDb250ZW50LmNpdHlOYW1lID0gUG9pbnROYW1lO1xyXG5cclxuXHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHBvaW50c0RhdGFDb250ZW50LmRhdGEgPSBlZGl0b3IuZ2V0RGF0YSgpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHBvaW50c0RhdGFDb250ZW50QXJyYXkubGVuZ3RoOyBqKyspIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwb2ludHNEYXRhQ29udGVudEFycmF5W2pdLnBvaW50SWQgPT0gcG9pbnREYXRhVGltZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9pbnRzRGF0YUNvbnRlbnRBcnJheS5zcGxpY2UoaiwgMSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChwb2ludHNEYXRhQ29udGVudC5kYXRhLmxlbmd0aCA9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIE1hdGVyaWFsaXplLnRvYXN0KCdObyBkYXRhIGluIHBvaW50IScsIDIwMDApO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKHBvaW50c0RhdGFDb250ZW50KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcG9pbnRzRGF0YUNvbnRlbnRBcnJheS5wdXNoKHBvaW50c0RhdGFDb250ZW50KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRleHRGaWVsZCA9ICQoY3VycmVudFBhdGgpLnBhcmVudCgpLmZpbmQoXCJ0ZXh0XCIpO1xyXG5cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICQodGV4dEZpZWxkKS50ZXh0KFBvaW50TmFtZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vICBjb25zb2xlLmxvZygkKHRleHRGaWVsZCkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBNYXRlcmlhbGl6ZS50b2FzdCgnWW91ciBkYXRhIGlzIHNhdmVkIScsIDIwMDApO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBwb2ludHNEYXRhQ29udGVudEFycmF5LnNvcnQoY29tcGFyZVRpbWUpXHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHZhciBvdmVybGF5ID0gJCgnI3NpZGVuYXYtb3ZlcmxheScpO1xyXG4gICAgICAgICAgICAgICAgICAgICQob3ZlcmxheSkuY3NzKFwiYmFja2dyb3VuZC1jb2xvclwiLCBcIm5vbmVcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgJChvdmVybGF5KS5yZW1vdmUoKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2cocG9pbnRzRGF0YUNvbnRlbnRBcnJheSwgY2lyY2xlc0FycmF5KTtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgU29ydGVkRGF0YUFycmF5ID0gW107XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY2lyY2xlc0FycmF5Lmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgcG9pbnRzRGF0YUNvbnRlbnRBcnJheS5sZW5ndGg7IGorKykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNpcmNsZXNBcnJheVtpXS50aW1lID09IHBvaW50c0RhdGFDb250ZW50QXJyYXlbal0ucG9pbnRJZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNvcnRlZERhdGFBcnJheS5wdXNoKHBvaW50c0RhdGFDb250ZW50QXJyYXlbal0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFNvcnRlZERhdGFBcnJheSk7XHJcblxyXG5cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ1BvaW50c0NvbnRlbnQnLCBKU09OLnN0cmluZ2lmeShTb3J0ZWREYXRhQXJyYXkpKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHBvaW50c0RhdGFDb250ZW50LmRhdGEubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkKGN1cnJlbnRQYXRoKS5jc3MoXCJmaWxsXCIsIFwiIzk5MDAzM1wiKTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHBvaW50c0RhdGFDb250ZW50LmRhdGEubGVuZ3RoID09IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJChjdXJyZW50UGF0aCkuY3NzKFwiZmlsbFwiLCBnZXRTZXR0aW5nRnJvbVN0b3JhZ2UoXCJtYXBQb2ludHNDb2xvclwiKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAkKCcuYnV0dG9uLWNvbGxhcHNlJykuc2lkZU5hdignaGlkZScpO1xyXG5cclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuXHJcblxyXG5cclxuICAgICAgICB2YXIgcGF0aExlbmd0aCA9IHBhdGguZ2V0VG90YWxMZW5ndGgoKTtcclxuXHJcbiAgICAgICAgdmFyIHN0b3BzQXRMZW5ndGggPSBbXTtcclxuXHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBwYXRoTGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgdmFyIHBhdGhMZW5ndGhBdFBvaW50ID0gcGF0aC5nZXRQb2ludEF0TGVuZ3RoKGkpO1xyXG5cclxuICAgICAgICAgICAgdmFyIHBvaW50WCA9IHBhdGhMZW5ndGhBdFBvaW50Lng7XHJcbiAgICAgICAgICAgIHZhciBwb2ludFkgPSBwYXRoTGVuZ3RoQXRQb2ludC55O1xyXG5cclxuXHJcbiAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgcG9pbnRzQXJyYXkubGVuZ3RoOyBqKyspIHtcclxuXHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKE1hdGguYWJzKE1hdGgucm91bmQocG9pbnRYIC0gcG9pbnRzQXJyYXlbal0uY3gpKSA8PSAwICYmIE1hdGguYWJzKE1hdGgucm91bmQocG9pbnRZIC0gcG9pbnRzQXJyYXlbal0uY3kpKSA8PSAwKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHN0b3BzQXRMZW5ndGgucHVzaChpKTtcclxuXHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB9XHJcblxyXG5cclxuXHJcblxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoc3RvcHNBdExlbmd0aC5sZW5ndGggIT0gcG9pbnRzQXJyYXkubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc3RvcHNBdExlbmd0aC5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgaWYgKHN0b3BzQXRMZW5ndGhbaSArIDFdIC0gc3RvcHNBdExlbmd0aFtpXSA9PSAxKSBzdG9wc0F0TGVuZ3RoLnNwbGljZShpLCAxKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oXCJzdG9wc0F0TGVuZ3RoXCIsIEpTT04uc3RyaW5naWZ5KHN0b3BzQXRMZW5ndGgpKTtcclxuXHJcbiAgICAgICAgLy8gaWYgKHBvaW50c0FycmF5Lmxlbmd0aCAhPT0gc3RvcHNBdExlbmd0aC5sZW5ndGgpIHtcclxuICAgICAgICAvLyAgICAgY29uc29sZS5sb2coXCJIRVJFIElTIFRIRSBESUZGRVJFTkNFOiAxc3QgYXJyYXkgbGVuZ3RoID0gXCIgKyBwb2ludHNBcnJheS5sZW5ndGggKyAnLCAybmQgYXJyIGxlbmd0aD0gJyArIHN0b3BzQXRMZW5ndGgubGVuZ3RoICsgXCJcIik7XHJcbiAgICAgICAgLy8gfSBlbHNlIHtcclxuICAgICAgICAvLyAgICAgY29uc29sZS5sb2coJ25vIERJRkZFUkVOQ0UgYmV0d2VlbiBhcnIgbGVuZ3RocycpO1xyXG4gICAgICAgIC8vIH1cclxuXHJcblxyXG5cclxuXHJcbiAgICB9LCBmYWxzZSk7XHJcblxyXG5cclxuICAgIHZhciBXcmFwcGVyUHJvcHMgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdtYXBTdHlsZVByb3BlcnRpZXMnKSk7XHJcblxyXG5cclxuICAgIC8vICQoXCIubWFwYmdcIikuY3NzKFwiYmFja2dyb3VuZC1jb2xvclwiLCBnZXRTZXR0aW5nRnJvbVN0b3JhZ2UoXCJib2R5QmFja2dyb3VuZENvbG9yXCIpKTtcclxuICAgICQoXCJib2R5XCIpLmNzcyhcImJhY2tncm91bmQtY29sb3JcIiwgZ2V0U2V0dGluZ0Zyb21TdG9yYWdlKFwiYm9keUJhY2tncm91bmRDb2xvclwiKSk7XHJcblxyXG5cclxuICAgIC8vICQuZWFjaChXcmFwcGVyUHJvcHMsIGZ1bmN0aW9uKHByb3AsIHZhbHVlKSB7XHJcbiAgICAvLyAgICAgJChcIi5tYXBiZ1wiKS5jc3MocHJvcCwgdmFsdWUpO1xyXG4gICAgLy8gfSk7XHJcblxyXG59KTsiXX0=
