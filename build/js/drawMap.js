$(document).ready(function(){function t(t){var e=JSON.parse(localStorage.getItem("Settings"))||{mapColor:"rgba(255, 204, 128, 1)",mapStrokeColor:"rgba(0, 0, 0, 1)",mapPointsColor:"rgba(0, 0, 255, 1)",mapPointsBorderColor:"rgba(0, 0, 0, 1)",mapRouteColor:"rgba(0, 0, 0, 1)",bodyBackgroundColor:"rgba(243, 229, 245, 1)",routeBorderWidth:"4",pointsRadius:"8",pointsBorderWidth:"1",contentWidth:"50",contentAlign:"flex-start",checkboxState:"false",defaultOption:"false",UserOption:"false",StartIcon:"",RouteStartIconColor:"rgba(0, 0, 0, 1)",RouteStartIconSize:"8"};if(e[t])return e[t]}function e(t,e){return t.id-e.id}function a(t,e){return t.pointId-e.pointId}JSON.parse(localStorage.getItem("Settings"));$(".modal").modal(),$("ul.tabs").tabs("select_tab","tab_2"),$("#menu").on("click",function(){$(this).hasClass(".active")?($(this).removeClass("active"),$(".tap-target").tapTarget("close")):($(this).addClass("active"),$(".tap-target").tapTarget("open"))}),$(".button-collapse").sideNav({menuWidth:300,edge:"left",closeOnClick:!1,draggable:!0,onOpen:function(){},onClose:function(){$("#slide-out").css("transform","translateX(-100%)"),$("div").remove("#sidenav-overlay"),$(".button-collapse").sideNav("hide"),$("#slide-out").css("transform","translateX(-100%)"),console.log("kek")}}),$(".collapsible").collapsible(),$(".side-nav").resizable({handles:"e",maxWidth:1200,minWidth:300});var o=document.getElementById("map"),r=JSON.parse(localStorage.getItem("map"));$("#map").attr("data",r),o.addEventListener("load",function(){var r=o.contentDocument,n=r.documentElement,l=n.getElementById("mapPaths"),s=l.getElementsByTagName("path"),i=document.createElementNS("http://www.w3.org/2000/svg","g");$(i).attr("id","wholeSvgGroup"),$("input[name=light-trigger]").attr("data-light","lightOff"),$("input[name=light-trigger]").prop("checked",!1);for(var c=0;c<s.length;c++)s[c].style.fill=t("mapColor"),s[c].style.stroke=t("mapStrokeColor");var p=JSON.parse(localStorage.getItem("path"));if(p){var d=document.createElementNS("http://www.w3.org/2000/svg","path");$(d).attr("d",p),$(d).attr("fill","transparent"),$(d).attr("stroke",t("mapRouteColor")),$(d).attr("stroke-width",t("routeBorderWidth")),$(d).attr("stroke-linecap","round")}Snap.plugin(function(t,e,a,o){a.prototype.circlePath=function(t,e,a){var o="M"+t+","+e;return o+="m"+-a+",0",o+="a"+a+","+a+" 0 1,0 "+2*a+",0",o+="a"+a+","+a+" 0 1,0 "+-2*a+",0",this.path(o,t,e)}});var g=document.createElementNS("http://www.w3.org/2000/svg","g");g.id="pathGroup",g.append(d),i.append(g),i.append(l),n.append(i);var m=Snap(g),h=JSON.parse(localStorage.getItem("circlesCoords")),f=d.getTotalLength(),u=(JSON.parse(localStorage.getItem("StartRouteIcon")),JSON.parse(localStorage.getItem("StartRouteIcon"))),S=(new DOMParser).parseFromString(u,"text/xml").documentElement,v=$(S).attr("data-offset-x"),I=$(S).attr("data-offset-y"),y=$(S).attr("data-scale"),N=document.createElementNS("http://www.w3.org/2000/svg","g");"true"==t("UserOption")&&u&&($(S).attr({fill:t("RouteStartIconColor"),transform:y}),$(N).attr("transform","translate("+(d.getPointAtLength(1).x-t("RouteStartIconSize")/v)+" "+(d.getPointAtLength(1).y-t("RouteStartIconSize")/I)+") scale("+t("RouteStartIconSize")/100+")"),N.append(S),g.append(N),i.append(g));for(var b=[],w=(JSON.parse(localStorage.getItem("PointsContent")),0);w<h.length;w++)b[w]=h[w];var C=1;for(c=0;c<f;c++)for(var k=(q=d.getPointAtLength(c)).x,x=q.y,P=0;P<b.length;P++)if(Math.abs(Math.round(k-b[P].cx))<=8&&Math.abs(Math.round(x-b[P].cy))<=8){for(var E=0;E<h.length;E++)Math.abs(Math.round(h[E].cx-b[P].cx))<=4&&Math.abs(Math.round(h[E].cy-b[P].cy))<=4&&(h[E].id=C++);b.splice(P,1)}h.sort(e),localStorage.setItem("circlesCoords",JSON.stringify(h));h=JSON.parse(localStorage.getItem("circlesCoords"));var O=[];$.each(h,function(e,a){var o={cx:0,cy:0,r:1},r=m.circlePath(this.cx,this.cy,this.r).attr({fill:t("mapPointsColor"),stroke:t("mapPointsBorderColor"),"stroke-width":t("pointsBorderWidth"),id:a.id,"data-time":a.time}),n=Snap.path.intersection(r,$(d).attr("d"));0==n.length?(alert("Please, return to the previous step and draw points right on the route line"),document.location.replace("http://127.0.0.1:8080/")):(o.cx=n[0].x,o.cy=n[0].y),O.push(o),n.forEach(function(t){m.circle(t.x,t.y,1)}),localStorage.setItem("points",JSON.stringify(O))});var B=r.getElementsByTagName("circle");for(c=0;c<B.length;c++)B[c].style.fill="transparent";if("true"==t("checkboxState")&&"true"==t("defaultOption")){var J=document.createElementNS("http://www.w3.org/2000/svg","circle");$(J).attr({cx:d.getPointAtLength(1).x,cy:d.getPointAtLength(1).y,r:t("pointsRadius"),stroke:t("mapPointsBorderColor"),fill:t("mapPointsColor"),"stroke-width":t("pointsBorderWidth")}),n.append(J)}if(null!=localStorage.getItem("PointsContent"))var M=JSON.parse(localStorage.getItem("PointsContent"));else M=[];for(c=0;c<h.length;c++){var R=r.getElementById(h[c].id),z=document.createElementNS("http://www.w3.org/2000/svg","g"),L=document.createElementNS("http://www.w3.org/2000/svg","text");$(L).attr({x:h[c].cx,y:h[c].cy+20,"font-size":12,"font-style":"italic",fill:"#ccccccc",class:"cityName"}),z.append(R),z.append(L),g.append(z),i.append(g),n.append(i);var T=h[c].time;for(P=0;P<M.length;P++){var W=M[P].data;if(M[P].pointId==T){M[P].pointId;if(0!=W.length){var A=r.getElementById(h[c].id),F=$(A).parent().find("text");M[P].cityName&&$(F).text(M[P].cityName),$(A).css("fill","#990033")}}}$(R).addClass("button-collapse"),$(R).attr("data-activates","slide-out"),$(R).attr("href","#"),R.style.cursor="pointer",$(R).mouseenter(function(){$(this).css("transition","0.5s"),$(this).css("stroke-width","6px"),$(this).css("stroke",t("mapPointsBorderColor"))}).mouseout(function(){$(this).css("transition","0.5s"),$(this).css("stroke-width","3px"),$(this).css("stroke",t("mapPointsBorderColor"))});var D,H,G={zoom:100,top:0,bottom:0,left:0,right:0},U=Snap(i),X=(Snap(g),JSON.parse(localStorage.getItem("mapStyleProperties"))||{transform:""});if(console.log(X.transform.length),X.transform){var _=X.transform,Y=_.match(/[+-]?\d+(\.\d+)?/g).map(function(t){return parseFloat(t)});console.log(Y),scaleImg=Y[0],D=Y[1],H=Y[2],console.log(scaleImg,D,H),U.attr("transform","scale("+scaleImg+") translate("+D+" "+H+")")}X.top=parseInt(X.top),X.left=parseInt(X.left),R.addEventListener("click",function(){$(".button-collapse").sideNav("show"),$(".button-collapse").off("click").sideNav();var e=parseInt(this.id),o=$(this).attr("data-time");document.getElementById("pointIndex").innerHTML=e;var r=this,n=$(this).attr("data-time"),s=JSON.parse(localStorage.getItem("PointsContent"))||[],i=JSON.parse(localStorage.getItem("mapStyleProperties"))||{transform:""};if(console.log(U),i.transform.length>0){var c=(_=i.transform).match(/[+-]?\d+(\.\d+)?/g).map(function(t){return parseFloat(t)});console.log(c),p=c[0],g=c[1],d=c[2]}if(s[e-1])p=s[e-1].zoom,d=s[e-1].top,g=s[e-1].left;else{var p=1,d=0,g=0;$("#pointName").html(""),U.animate({transform:"scale("+p+") translate("+d+" "+g+")"},200)}if($("#plus").bind("click",function(){p+=.1,G.zoom=p,console.log(l),U.animate({transform:"scale("+p+") translate("+g+" "+d+")"},300)}),$("#minus").bind("click",function(){(p-=.1)<=1&&(p=1),G.zoom=p,U.animate({transform:"scale("+p+") translate("+g+" "+d+")"},300)}),$("#moveLeft").bind("click",function(){g+=20,G.left=g,U.animate({transform:"scale("+p+") translate("+g+" "+d+")"},300)}),$("#moveRight").bind("click",function(){g-=20,G.left=g,U.animate({transform:"scale("+p+") translate("+g+" "+d+")"},300)}),$("#moveTop").bind("click",function(){d+=20,G.top=d,U.animate({transform:"scale("+p+") translate("+g+" "+d+")"},300)}),$("#moveBottom").bind("click",function(){d-=20,G.top=d,U.animate({transform:"scale("+p+") translate("+g+" "+d+")"},300)}),null!=localStorage.getItem("PointsContent")){for(var m,h=0;h<s.length;h++){var f=s[h].pointId==o;if(s[h].pointId==o){U.animate({transform:"scale("+parseFloat(s[h].zoom)+") translate("+s[h].left+" "+s[h].top+")"},300);var u=s[h].cityName}f&&(m=s[h].data)}$("#pointName").val(u),editor.setData(m)}document.getElementById("SavePointContent").onclick=function(){var e={pointId:0,cityName:"",zoom:p,left:g,top:d,slider:"false",data:""},o=$("#pointName").val();e.pointId=n,e.cityName=o,e.data=editor.getData();for(var l=0;l<M.length;l++)M[l].pointId==n&&M.splice(l,1);if(0==e.data.length)Materialize.toast("No data in point!",2e3);else{console.log(e),M.push(e);var s=$(r).parent().find("text");$(s).text(o),Materialize.toast("Your data is saved!",2e3)}M.sort(a),localStorage.setItem("PointsContent",JSON.stringify(M));var i=$("#sidenav-overlay");$(i).css("background-color","none"),$(i).remove(),e.data.length>0?$(r).css("fill","#990033"):0==e.data.length&&$(r).css("fill",t("mapPointsColor")),$(".button-collapse").sideNav("hide")}})}f=d.getTotalLength();var j=[];for(c=0;c<f;c++){var q;for(k=(q=d.getPointAtLength(c)).x,x=q.y,P=0;P<O.length;P++)Math.abs(Math.round(k-O[P].cx))<=0&&Math.abs(Math.round(x-O[P].cy))<=0&&j.push(c)}if(j.length!=O.length)for(c=0;c<j.length;c++)j[c+1]-j[c]==1&&j.splice(c,1);localStorage.setItem("stopsAtLength",JSON.stringify(j)),O.length!==j.length?console.log("HERE IS THE DIFFERENCE: 1st array length = "+O.length+", 2nd arr length= "+j.length):console.log("no DIFFERENCE between arr lengths")},!1);JSON.parse(localStorage.getItem("mapStyleProperties"));$("body").css("background-color",t("bodyBackgroundColor"))});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImRyYXdNYXAuanMiXSwibmFtZXMiOlsiJCIsImRvY3VtZW50IiwicmVhZHkiLCJnZXRTZXR0aW5nRnJvbVN0b3JhZ2UiLCJzZXR0aW5nIiwiU2V0dGluZ3NPYmplY3QiLCJKU09OIiwicGFyc2UiLCJsb2NhbFN0b3JhZ2UiLCJnZXRJdGVtIiwibWFwQ29sb3IiLCJtYXBTdHJva2VDb2xvciIsIm1hcFBvaW50c0NvbG9yIiwibWFwUG9pbnRzQm9yZGVyQ29sb3IiLCJtYXBSb3V0ZUNvbG9yIiwiYm9keUJhY2tncm91bmRDb2xvciIsInJvdXRlQm9yZGVyV2lkdGgiLCJwb2ludHNSYWRpdXMiLCJwb2ludHNCb3JkZXJXaWR0aCIsImNvbnRlbnRXaWR0aCIsImNvbnRlbnRBbGlnbiIsImNoZWNrYm94U3RhdGUiLCJkZWZhdWx0T3B0aW9uIiwiVXNlck9wdGlvbiIsIlN0YXJ0SWNvbiIsIlJvdXRlU3RhcnRJY29uQ29sb3IiLCJSb3V0ZVN0YXJ0SWNvblNpemUiLCJjb21wYXJlSWQiLCJvYmpBIiwib2JqQiIsImlkIiwiY29tcGFyZVRpbWUiLCJwb2ludElkIiwibW9kYWwiLCJ0YWJzIiwib24iLCJ0aGlzIiwiaGFzQ2xhc3MiLCJyZW1vdmVDbGFzcyIsInRhcFRhcmdldCIsImFkZENsYXNzIiwic2lkZU5hdiIsIm1lbnVXaWR0aCIsImVkZ2UiLCJjbG9zZU9uQ2xpY2siLCJkcmFnZ2FibGUiLCJvbk9wZW4iLCJvbkNsb3NlIiwiY3NzIiwicmVtb3ZlIiwiY29uc29sZSIsImxvZyIsImNvbGxhcHNpYmxlIiwicmVzaXphYmxlIiwiaGFuZGxlcyIsIm1heFdpZHRoIiwibWluV2lkdGgiLCJhIiwiZ2V0RWxlbWVudEJ5SWQiLCJtYXBfdXJsIiwiYXR0ciIsImFkZEV2ZW50TGlzdGVuZXIiLCJzdmdEb2MiLCJjb250ZW50RG9jdW1lbnQiLCJzdmdSb290IiwiZG9jdW1lbnRFbGVtZW50IiwiTWFwUGF0aHNHcm91cCIsIlBhdGhzQXJyYXkiLCJnZXRFbGVtZW50c0J5VGFnTmFtZSIsIndob2xlU3ZnR3JvdXAiLCJjcmVhdGVFbGVtZW50TlMiLCJwcm9wIiwiaSIsImxlbmd0aCIsInN0eWxlIiwiZmlsbCIsInN0cm9rZSIsIlBhdGhEaXJlY3Rpb24iLCJwYXRoIiwiU25hcCIsInBsdWdpbiIsIkVsZW1lbnQiLCJQYXBlciIsImdsb2JhbCIsInByb3RvdHlwZSIsImNpcmNsZVBhdGgiLCJjeCIsImN5IiwiciIsInAiLCJwYXRoR3JvdXAiLCJhcHBlbmQiLCJzIiwiY2lyY2xlc0FycmF5IiwicGF0aExlbmd0aCIsImdldFRvdGFsTGVuZ3RoIiwicGF0aFN0YXJ0SWNvbiIsInBhcnNlZFBhdGhTdGFydEljb24iLCJET01QYXJzZXIiLCJwYXJzZUZyb21TdHJpbmciLCJpY29uT2Zmc2V0WCIsImljb25PZmZzZXRZIiwiaWNvblNjYWxlIiwiZ3JvdXAiLCJ0cmFuc2Zvcm0iLCJnZXRQb2ludEF0TGVuZ3RoIiwieCIsInkiLCJDaXJjbGVzQXJyYXlDbG9uZSIsImsiLCJjaXJjbGVzQ291bnRlciIsInBvaW50WCIsInBhdGhMZW5ndGhBdFBvaW50IiwicG9pbnRZIiwiaiIsIk1hdGgiLCJhYnMiLCJyb3VuZCIsImwiLCJzcGxpY2UiLCJzb3J0Iiwic2V0SXRlbSIsInN0cmluZ2lmeSIsInBvaW50c0FycmF5IiwiZWFjaCIsImluZGV4IiwiZWwiLCJwb2ludHNPYmoiLCJjaXJjbGUiLCJzdHJva2Utd2lkdGgiLCJkYXRhLXRpbWUiLCJ0aW1lIiwiaW50ZXJzZWN0cyIsImludGVyc2VjdGlvbiIsImFsZXJ0IiwibG9jYXRpb24iLCJyZXBsYWNlIiwicHVzaCIsImZvckVhY2giLCJpbnRlcnNlY3Rpb25DaXJjbGVzIiwic3RhcnRDaXJjbGUiLCJwb2ludHNEYXRhQ29udGVudEFycmF5IiwicGF0aHMiLCJjaXJjbGVHcm91cCIsInRleHQiLCJmb250LXNpemUiLCJmb250LXN0eWxlIiwiY2xhc3MiLCJlcXVhbFRpbWVBdHRyIiwicG9pbnRUZXh0IiwiZGF0YSIsIkZpbGxlZENvbnRlbnRQYXRocyIsIkNsb3Nlc3RUZXh0RmllbGQiLCJwYXJlbnQiLCJmaW5kIiwiY2l0eU5hbWUiLCJjdXJzb3IiLCJtb3VzZWVudGVyIiwibW91c2VvdXQiLCJtb3ZlTGVmdCIsIm1vdmVUb3AiLCJEaXNwbGFjZW1lbnRPYmoiLCJ6b29tIiwidG9wIiwiYm90dG9tIiwibGVmdCIsInJpZ2h0IiwiRnVsbE1hcEdyb3VwIiwic2F2ZWREaXNwbGFjZW1lbnQiLCJ0cmFuc2Zvcm1TdHJpbmciLCJTdHJpbmdWYWx1ZXMiLCJtYXRjaCIsIm1hcCIsInYiLCJwYXJzZUZsb2F0Iiwic2NhbGVJbWciLCJwYXJzZUludCIsIm9mZiIsIk5wb2ludCIsImRhdGFUaW1lIiwiaW5uZXJIVE1MIiwiY3VycmVudFBhdGgiLCJwb2ludERhdGFUaW1lIiwiZ2V0UG9pbnREYXRhIiwicG9pbnRzRGVmYXVsdERpc3BsYWNlbWVudCIsImh0bWwiLCJhbmltYXRlIiwiYmluZCIsIlBvaW50TGFzdERhdGEiLCJjb3VudCIsIlBvaW50Q2l0eU5hbWUiLCJ2YWwiLCJlZGl0b3IiLCJzZXREYXRhIiwib25jbGljayIsInBvaW50c0RhdGFDb250ZW50Iiwic2xpZGVyIiwiUG9pbnROYW1lIiwiZ2V0RGF0YSIsIk1hdGVyaWFsaXplIiwidG9hc3QiLCJ0ZXh0RmllbGQiLCJvdmVybGF5Iiwic3RvcHNBdExlbmd0aCJdLCJtYXBwaW5ncyI6IkFBQUFBLEVBQUVDLFVBQVVDLE1BQU0sV0FFZCxTQUFTQyxFQUFzQkMsR0FDM0IsSUFBSUMsRUFBaUJDLEtBQUtDLE1BQU1DLGFBQWFDLFFBQVEsZUFDakRDLFNBQVUseUJBQ1ZDLGVBQWdCLG1CQUNoQkMsZUFBZ0IscUJBQ2hCQyxxQkFBc0IsbUJBQ3RCQyxjQUFlLG1CQUNmQyxvQkFBcUIseUJBQ3JCQyxpQkFBa0IsSUFDbEJDLGFBQWMsSUFDZEMsa0JBQW1CLElBQ25CQyxhQUFjLEtBQ2RDLGFBQWMsYUFDZEMsY0FBZSxRQUNmQyxjQUFlLFFBQ2ZDLFdBQVksUUFDWkMsVUFBVyxHQUNYQyxvQkFB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SUFPdkIsQ0FBQSxJQU5Ed0MsRUFNSixJQUpJRCxHQUZBQyxFQUFvQmxDLEVBQUsyQixpQkFBaUJqQyxJQUVma0MsRUFDM0JPLEVBQVNELEVBQWtCTCxFQUd0Qk8sRUFBSSxFQUFHQSxFQUFJUyxFQUFZbEQsT0FBUXlDLElBR2hDQyxLQUFLQyxJQUFJRCxLQUFLRSxNQUFNTixFQUFTWSxFQUFZVCxHQUFHNUIsTUFBUSxHQUFLNkIsS0FBS0MsSUFBSUQsS0FBS0UsTUFBTUosRUFBU1UsRUFBWVQsR0FBRzNCLE1BQVEsR0FFN0dvSCxFQUFjbEUsS0FBS2pFLEdBVS9CLEdBQUltSSxFQUFjbEksUUFBVWtELEVBQVlsRCxPQUNwQyxJQUFTRCxFQUFJLEVBQUdBLEVBQUltSSxFQUFjbEksT0FBUUQsSUFDbENtSSxFQUFjbkksRUFBSSxHQUFLbUksRUFBY25JLElBQU0sR0FBR21JLEVBQWNwRixPQUFPL0MsRUFBRyxHQUlsRmhFLGFBQWFpSCxRQUFRLGdCQUFpQm5ILEtBQUtvSCxVQUFVaUYsSUFFakRoRixFQUFZbEQsU0FBV2tJLEVBQWNsSSxPQUNyQ3ZCLFFBQVFDLElBQUksOENBQWdEd0UsRUFBWWxELE9BQVMscUJBQXVCa0ksRUFBY2xJLFFBRXRIdkIsUUFBUUMsSUFBSSx1Q0FNakIsR0FHZ0I3QyxLQUFLQyxNQUFNQyxhQUFhQyxRQUFRLHVCQUluRFQsRUFBRSxRQUFRZ0QsSUFBSSxtQkFBb0I3QyxFQUFzQiIsImZpbGUiOiJkcmF3TWFwLmpzIiwic291cmNlc0NvbnRlbnQiOlsiJChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24oKSB7XHJcblxyXG4gICAgZnVuY3Rpb24gZ2V0U2V0dGluZ0Zyb21TdG9yYWdlKHNldHRpbmcpIHtcclxuICAgICAgICB2YXIgU2V0dGluZ3NPYmplY3QgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKFwiU2V0dGluZ3NcIikpIHx8IHtcclxuICAgICAgICAgICAgbWFwQ29sb3I6IFwicmdiYSgyNTUsIDIwNCwgMTI4LCAxKVwiLFxyXG4gICAgICAgICAgICBtYXBTdHJva2VDb2xvcjogXCJyZ2JhKDAsIDAsIDAsIDEpXCIsXHJcbiAgICAgICAgICAgIG1hcFBvaW50c0NvbG9yOiBcInJnYmEoMCwgMCwgMjU1LCAxKVwiLFxyXG4gICAgICAgICAgICBtYXBQb2ludHNCb3JkZXJDb2xvcjogXCJyZ2JhKDAsIDAsIDAsIDEpXCIsXHJcbiAgICAgICAgICAgIG1hcFJvdXRlQ29sb3I6IFwicmdiYSgwLCAwLCAwLCAxKVwiLFxyXG4gICAgICAgICAgICBib2R5QmFja2dyb3VuZENvbG9yOiBcInJnYmEoMjQzLCAyMjksIDI0NSwgMSlcIixcclxuICAgICAgICAgICAgcm91dGVCb3JkZXJXaWR0aDogXCI0XCIsXHJcbiAgICAgICAgICAgIHBvaW50c1JhZGl1czogXCI4XCIsXHJcbiAgICAgICAgICAgIHBvaW50c0JvcmRlcldpZHRoOiBcIjFcIixcclxuICAgICAgICAgICAgY29udGVudFdpZHRoOiBcIjUwXCIsXHJcbiAgICAgICAgICAgIGNvbnRlbnRBbGlnbjogXCJmbGV4LXN0YXJ0XCIsXHJcbiAgICAgICAgICAgIGNoZWNrYm94U3RhdGU6IFwiZmFsc2VcIixcclxuICAgICAgICAgICAgZGVmYXVsdE9wdGlvbjogXCJmYWxzZVwiLFxyXG4gICAgICAgICAgICBVc2VyT3B0aW9uOiBcImZhbHNlXCIsXHJcbiAgICAgICAgICAgIFN0YXJ0SWNvbjogXCJcIixcclxuICAgICAgICAgICAgUm91dGVTdGFydEljb25Db2xvcjogXCJyZ2JhKDAsIDAsIDAsIDEpXCIsXHJcbiAgICAgICAgICAgIFJvdXRlU3RhcnRJY29uU2l6ZTogXCI4XCJcclxuICAgICAgICB9O1xyXG4gICAgICAgIGlmIChTZXR0aW5nc09iamVjdFtzZXR0aW5nXSkge1xyXG4gICAgICAgICAgICByZXR1cm4gU2V0dGluZ3NPYmplY3Rbc2V0dGluZ107XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgdmFyIGtlayA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oXCJTZXR0aW5nc1wiKSlcclxuICAgIC8vIGNvbnNvbGUubG9nKGtlayk7XHJcbiAgICBmdW5jdGlvbiBnZXRTdmdQb2ludFBvc2l0aW9uKHN0cmluZykge1xyXG4gICAgICAgIHN0cmluZyA9IHN0cmluZy5zbGljZSgxKTtcclxuICAgICAgICBzdHJpbmcgPSBzdHJpbmcuc3BsaXQoXCJjXCIpO1xyXG4gICAgICAgIHZhciBzdWJzdHJpbmcgPSBzdHJpbmcuc3BsaWNlKDEpO1xyXG4gICAgICAgIHN1YnN0cmluZyA9IHN1YnN0cmluZy5qb2luKFwiY1wiKTtcclxuICAgICAgICByZXR1cm4gc3Vic3RyaW5nO1xyXG4gICAgfVxyXG5cclxuXHJcbiAgICAkKCcubW9kYWwnKS5tb2RhbCgpO1xyXG4gICAgJCgndWwudGFicycpLnRhYnMoJ3NlbGVjdF90YWInLCAndGFiXzInKTtcclxuICAgICQoXCIjbWVudVwiKS5vbihcImNsaWNrXCIsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGlmICghJCh0aGlzKS5oYXNDbGFzcygnLmFjdGl2ZScpKSB7XHJcbiAgICAgICAgICAgICQodGhpcykuYWRkQ2xhc3MoXCJhY3RpdmVcIik7XHJcbiAgICAgICAgICAgICQoJy50YXAtdGFyZ2V0JykudGFwVGFyZ2V0KCdvcGVuJyk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgJCh0aGlzKS5yZW1vdmVDbGFzcyhcImFjdGl2ZVwiKTtcclxuICAgICAgICAgICAgJCgnLnRhcC10YXJnZXQnKS50YXBUYXJnZXQoJ2Nsb3NlJyk7XHJcbiAgICAgICAgfVxyXG4gICAgfSlcclxuXHJcbiAgICAkKCcuYnV0dG9uLWNvbGxhcHNlJykuc2lkZU5hdih7XHJcbiAgICAgICAgbWVudVdpZHRoOiAzMDAsXHJcbiAgICAgICAgZWRnZTogJ2xlZnQnLFxyXG4gICAgICAgIGNsb3NlT25DbGljazogZmFsc2UsXHJcbiAgICAgICAgZHJhZ2dhYmxlOiB0cnVlLFxyXG4gICAgICAgIG9uT3BlbjogZnVuY3Rpb24oKSB7fSxcclxuICAgICAgICBvbkNsb3NlOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgJChcIiNzbGlkZS1vdXRcIikuY3NzKFwidHJhbnNmb3JtXCIsIFwidHJhbnNsYXRlWCgtMTAwJSlcIik7XHJcbiAgICAgICAgICAgICQoXCJkaXZcIikucmVtb3ZlKFwiI3NpZGVuYXYtb3ZlcmxheVwiKTtcclxuICAgICAgICAgICAgJCgnLmJ1dHRvbi1jb2xsYXBzZScpLnNpZGVOYXYoJ2hpZGUnKTtcclxuICAgICAgICAgICAgJChcIiNzbGlkZS1vdXRcIikuY3NzKFwidHJhbnNmb3JtXCIsIFwidHJhbnNsYXRlWCgtMTAwJSlcIik7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwia2VrXCIpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICB9KTtcclxuICAgICQoJy5jb2xsYXBzaWJsZScpLmNvbGxhcHNpYmxlKCk7XHJcblxyXG4gICAgJChcIi5zaWRlLW5hdlwiKS5yZXNpemFibGUoe1xyXG4gICAgICAgIGhhbmRsZXM6ICdlJyxcclxuICAgICAgICBtYXhXaWR0aDogMTIwMCxcclxuICAgICAgICBtaW5XaWR0aDogMzAwXHJcbiAgICB9KTtcclxuXHJcbiAgICBmdW5jdGlvbiBjb21wYXJlSWQob2JqQSwgb2JqQikge1xyXG4gICAgICAgIHJldHVybiBvYmpBLmlkIC0gb2JqQi5pZDtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBjb21wYXJlVGltZShvYmpBLCBvYmpCKSB7XHJcbiAgICAgICAgcmV0dXJuIG9iakEucG9pbnRJZCAtIG9iakIucG9pbnRJZDtcclxuICAgIH1cclxuXHJcblxyXG5cclxuICAgIHZhciBhID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21hcCcpO1xyXG4gICAgdmFyIG1hcF91cmwgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdtYXAnKSk7XHJcbiAgICAkKCcjbWFwJykuYXR0cignZGF0YScsIG1hcF91cmwpO1xyXG4gICAgYS5hZGRFdmVudExpc3RlbmVyKFwibG9hZFwiLCBmdW5jdGlvbigpIHtcclxuICAgICAgICB2YXIgc3ZnRG9jID0gYS5jb250ZW50RG9jdW1lbnQ7XHJcbiAgICAgICAgdmFyIHN2Z1Jvb3QgPSBzdmdEb2MuZG9jdW1lbnRFbGVtZW50O1xyXG4gICAgICAgIHZhciBNYXBQYXRoc0dyb3VwID0gc3ZnUm9vdC5nZXRFbGVtZW50QnlJZChcIm1hcFBhdGhzXCIpO1xyXG4gICAgICAgIHZhciBQYXRoc0FycmF5ID0gTWFwUGF0aHNHcm91cC5nZXRFbGVtZW50c0J5VGFnTmFtZSgncGF0aCcpO1xyXG4gICAgICAgIHZhciB3aG9sZVN2Z0dyb3VwID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycsICdnJyk7XHJcbiAgICAgICAgJCh3aG9sZVN2Z0dyb3VwKS5hdHRyKFwiaWRcIiwgXCJ3aG9sZVN2Z0dyb3VwXCIpO1xyXG5cclxuICAgICAgICAkKFwiaW5wdXRbbmFtZT1saWdodC10cmlnZ2VyXVwiKS5hdHRyKFwiZGF0YS1saWdodFwiLCBcImxpZ2h0T2ZmXCIpO1xyXG4gICAgICAgICAkKFwiaW5wdXRbbmFtZT1saWdodC10cmlnZ2VyXVwiKS5wcm9wKFwiY2hlY2tlZFwiLCBmYWxzZSk7XHJcblxyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgUGF0aHNBcnJheS5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICBQYXRoc0FycmF5W2ldLnN0eWxlLmZpbGwgPSBnZXRTZXR0aW5nRnJvbVN0b3JhZ2UoXCJtYXBDb2xvclwiKTtcclxuICAgICAgICAgICAgUGF0aHNBcnJheVtpXS5zdHlsZS5zdHJva2UgPSBnZXRTZXR0aW5nRnJvbVN0b3JhZ2UoXCJtYXBTdHJva2VDb2xvclwiKTtcclxuICAgICAgICB9XHJcblxyXG5cclxuICAgICAgICB2YXIgUGF0aERpcmVjdGlvbiA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3BhdGgnKSk7XHJcblxyXG4gICAgICAgIGlmIChQYXRoRGlyZWN0aW9uKSB7XHJcbiAgICAgICAgICAgIHZhciBwYXRoID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycsICdwYXRoJyk7XHJcblxyXG4gICAgICAgICAgICAkKHBhdGgpLmF0dHIoJ2QnLCBQYXRoRGlyZWN0aW9uKTtcclxuICAgICAgICAgICAgJChwYXRoKS5hdHRyKCdmaWxsJywgJ3RyYW5zcGFyZW50Jyk7XHJcbiAgICAgICAgICAgICQocGF0aCkuYXR0cignc3Ryb2tlJywgZ2V0U2V0dGluZ0Zyb21TdG9yYWdlKFwibWFwUm91dGVDb2xvclwiKSk7XHJcbiAgICAgICAgICAgICQocGF0aCkuYXR0cignc3Ryb2tlLXdpZHRoJywgZ2V0U2V0dGluZ0Zyb21TdG9yYWdlKFwicm91dGVCb3JkZXJXaWR0aFwiKSk7XHJcbiAgICAgICAgICAgICQocGF0aCkuYXR0cihcInN0cm9rZS1saW5lY2FwXCIsIFwicm91bmRcIilcclxuICAgICAgICB9XHJcblxyXG5cclxuICAgICAgICBTbmFwLnBsdWdpbihmdW5jdGlvbihTbmFwLCBFbGVtZW50LCBQYXBlciwgZ2xvYmFsKSB7XHJcbiAgICAgICAgICAgIFBhcGVyLnByb3RvdHlwZS5jaXJjbGVQYXRoID0gZnVuY3Rpb24oY3gsIGN5LCByKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgcCA9IFwiTVwiICsgY3ggKyBcIixcIiArIGN5O1xyXG4gICAgICAgICAgICAgICAgcCArPSBcIm1cIiArIC1yICsgXCIsMFwiO1xyXG4gICAgICAgICAgICAgICAgcCArPSBcImFcIiArIHIgKyBcIixcIiArIHIgKyBcIiAwIDEsMCBcIiArIChyICogMikgKyBcIiwwXCI7XHJcbiAgICAgICAgICAgICAgICBwICs9IFwiYVwiICsgciArIFwiLFwiICsgciArIFwiIDAgMSwwIFwiICsgLShyICogMikgKyBcIiwwXCI7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5wYXRoKHAsIGN4LCBjeSk7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHZhciBwYXRoR3JvdXAgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoJ2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJywgJ2cnKTtcclxuICAgICAgICBwYXRoR3JvdXAuaWQgPSBcInBhdGhHcm91cFwiO1xyXG4gICAgICAgIHBhdGhHcm91cC5hcHBlbmQocGF0aCk7XHJcbiAgICAgICAgd2hvbGVTdmdHcm91cC5hcHBlbmQocGF0aEdyb3VwKTtcclxuICAgICAgICB3aG9sZVN2Z0dyb3VwLmFwcGVuZChNYXBQYXRoc0dyb3VwKTtcclxuICAgICAgICBzdmdSb290LmFwcGVuZCh3aG9sZVN2Z0dyb3VwKTtcclxuICAgICAgICB2YXIgcyA9IFNuYXAocGF0aEdyb3VwKTtcclxuXHJcbiAgICAgICAgdmFyIGNpcmNsZXNBcnJheSA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2NpcmNsZXNDb29yZHMnKSk7XHJcbiAgICAgICAgdmFyIHBhdGhMZW5ndGggPSBwYXRoLmdldFRvdGFsTGVuZ3RoKCk7XHJcblxyXG5cclxuICAgICAgICB2YXIgc3RhcnRSb3V0ZUZsYWcgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKFwiU3RhcnRSb3V0ZUljb25cIikpO1xyXG5cclxuXHJcblxyXG4gICAgICAgIHZhciBwYXRoU3RhcnRJY29uID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbShcIlN0YXJ0Um91dGVJY29uXCIpKTtcclxuICAgICAgICAvLyBjb25zb2xlLmxvZyhwYXRoU3RhcnRJY29uKTtcclxuICAgICAgICB2YXIgb1BhcnNlciA9IG5ldyBET01QYXJzZXIoKTtcclxuICAgICAgICB2YXIgb0RPTSA9IG9QYXJzZXIucGFyc2VGcm9tU3RyaW5nKHBhdGhTdGFydEljb24sIFwidGV4dC94bWxcIik7XHJcbiAgICAgICAgLy8gY29uc29sZS5sb2cob0RPTS5kb2N1bWVudEVsZW1lbnQpO1xyXG5cclxuICAgICAgICB2YXIgcGFyc2VkUGF0aFN0YXJ0SWNvbiA9IG9ET00uZG9jdW1lbnRFbGVtZW50O1xyXG4gICAgICAgIHZhciBpY29uT2Zmc2V0WCA9ICQocGFyc2VkUGF0aFN0YXJ0SWNvbikuYXR0cihcImRhdGEtb2Zmc2V0LXhcIik7XHJcbiAgICAgICAgdmFyIGljb25PZmZzZXRZID0gJChwYXJzZWRQYXRoU3RhcnRJY29uKS5hdHRyKFwiZGF0YS1vZmZzZXQteVwiKTtcclxuICAgICAgICB2YXIgaWNvblNjYWxlID0gJChwYXJzZWRQYXRoU3RhcnRJY29uKS5hdHRyKFwiZGF0YS1zY2FsZVwiKTtcclxuXHJcbiAgICAgICAgdmFyIGdyb3VwID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycsICdnJyk7XHJcblxyXG4gICAgICAgIGlmIChnZXRTZXR0aW5nRnJvbVN0b3JhZ2UoXCJVc2VyT3B0aW9uXCIpID09IFwidHJ1ZVwiICYmIHBhdGhTdGFydEljb24pIHtcclxuXHJcbiAgICAgICAgICAgICQocGFyc2VkUGF0aFN0YXJ0SWNvbikuYXR0cih7XHJcbiAgICAgICAgICAgICAgICBmaWxsOiBnZXRTZXR0aW5nRnJvbVN0b3JhZ2UoXCJSb3V0ZVN0YXJ0SWNvbkNvbG9yXCIpLFxyXG4gICAgICAgICAgICAgICAgdHJhbnNmb3JtOiBpY29uU2NhbGVcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKHBhcnNlZFBhdGhTdGFydEljb24pO1xyXG5cclxuXHJcblxyXG4gICAgICAgICAgICAkKGdyb3VwKS5hdHRyKFwidHJhbnNmb3JtXCIsIFwidHJhbnNsYXRlKFwiICsgKHBhdGguZ2V0UG9pbnRBdExlbmd0aCgxKS54IC0gKGdldFNldHRpbmdGcm9tU3RvcmFnZShcIlJvdXRlU3RhcnRJY29uU2l6ZVwiKSAvIGljb25PZmZzZXRYKSkgKyBcIiBcIiArIChwYXRoLmdldFBvaW50QXRMZW5ndGgoMSkueSAtIChnZXRTZXR0aW5nRnJvbVN0b3JhZ2UoXCJSb3V0ZVN0YXJ0SWNvblNpemVcIikgLyBpY29uT2Zmc2V0WSkpICsgXCIpIFwiICsgXCJzY2FsZShcIiArIGdldFNldHRpbmdGcm9tU3RvcmFnZShcIlJvdXRlU3RhcnRJY29uU2l6ZVwiKSAvIDEwMCArIFwiKVwiKTtcclxuICAgICAgICAgICAgZ3JvdXAuYXBwZW5kKHBhcnNlZFBhdGhTdGFydEljb24pO1xyXG5cclxuICAgICAgICAgICAgcGF0aEdyb3VwLmFwcGVuZChncm91cCk7XHJcbiAgICAgICAgICAgIHdob2xlU3ZnR3JvdXAuYXBwZW5kKHBhdGhHcm91cCk7XHJcbiAgICAgICAgfVxyXG5cclxuXHJcblxyXG5cclxuICAgICAgICB2YXIgQ2lyY2xlc0FycmF5Q2xvbmUgPSBbXTtcclxuICAgICAgICB2YXIgY29udGVudE9mUG9pbnRzID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnUG9pbnRzQ29udGVudCcpKSB8fCBbXTtcclxuXHJcblxyXG4gICAgICAgIGZvciAodmFyIGsgPSAwOyBrIDwgY2lyY2xlc0FycmF5Lmxlbmd0aDsgaysrKSB7XHJcbiAgICAgICAgICAgIENpcmNsZXNBcnJheUNsb25lW2tdID0gY2lyY2xlc0FycmF5W2tdO1xyXG4gICAgICAgIH1cclxuXHJcblxyXG4gICAgICAgIHZhciBjaXJjbGVzQ291bnRlciA9IDE7XHJcblxyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcGF0aExlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIHZhciBwYXRoTGVuZ3RoQXRQb2ludCA9IHBhdGguZ2V0UG9pbnRBdExlbmd0aChpKTtcclxuICAgICAgICAgICAgdmFyIHBvaW50WCA9IHBhdGhMZW5ndGhBdFBvaW50Lng7XHJcbiAgICAgICAgICAgIHZhciBwb2ludFkgPSBwYXRoTGVuZ3RoQXRQb2ludC55O1xyXG5cclxuXHJcbiAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgQ2lyY2xlc0FycmF5Q2xvbmUubGVuZ3RoOyBqKyspIHtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoTWF0aC5hYnMoTWF0aC5yb3VuZChwb2ludFggLSBDaXJjbGVzQXJyYXlDbG9uZVtqXS5jeCkpIDw9IDggJiYgTWF0aC5hYnMoTWF0aC5yb3VuZChwb2ludFkgLSBDaXJjbGVzQXJyYXlDbG9uZVtqXS5jeSkpIDw9IDgpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgbCA9IDA7IGwgPCBjaXJjbGVzQXJyYXkubGVuZ3RoOyBsKyspIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChNYXRoLmFicyhNYXRoLnJvdW5kKGNpcmNsZXNBcnJheVtsXS5jeCAtIENpcmNsZXNBcnJheUNsb25lW2pdLmN4KSkgPD0gNCAmJiBNYXRoLmFicyhNYXRoLnJvdW5kKGNpcmNsZXNBcnJheVtsXS5jeSAtIENpcmNsZXNBcnJheUNsb25lW2pdLmN5KSkgPD0gNCkge1xyXG5cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaXJjbGVzQXJyYXlbbF0uaWQgPSBjaXJjbGVzQ291bnRlcisrO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIENpcmNsZXNBcnJheUNsb25lLnNwbGljZShqLCAxKTtcclxuXHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjaXJjbGVzQXJyYXkuc29ydChjb21wYXJlSWQpO1xyXG5cclxuXHJcblxyXG5cclxuICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnY2lyY2xlc0Nvb3JkcycsIEpTT04uc3RyaW5naWZ5KGNpcmNsZXNBcnJheSkpO1xyXG5cclxuXHJcblxyXG4gICAgICAgIHZhciBjaXJjbGVzQXJyYXkgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdjaXJjbGVzQ29vcmRzJykpO1xyXG4gICAgICAgIHZhciBwb2ludHNBcnJheSA9IFtdO1xyXG4gICAgICAgIHZhciBzdHJpbmdBcnIgPSAnJztcclxuXHJcblxyXG5cclxuXHJcbiAgICAgICAgJC5lYWNoKGNpcmNsZXNBcnJheSwgZnVuY3Rpb24oaW5kZXgsIGVsKSB7XHJcbiAgICAgICAgICAgIHZhciBwb2ludHNPYmogPSB7XHJcbiAgICAgICAgICAgICAgICBjeDogMCxcclxuICAgICAgICAgICAgICAgIGN5OiAwLFxyXG4gICAgICAgICAgICAgICAgcjogMVxyXG4gICAgICAgICAgICB9O1xyXG5cclxuXHJcbiAgICAgICAgICAgIHZhciBjaXJjbGUgPSBzLmNpcmNsZVBhdGgodGhpcy5jeCwgdGhpcy5jeSwgdGhpcy5yKS5hdHRyKHtcclxuICAgICAgICAgICAgICAgIGZpbGw6IGdldFNldHRpbmdGcm9tU3RvcmFnZShcIm1hcFBvaW50c0NvbG9yXCIpLFxyXG4gICAgICAgICAgICAgICAgc3Ryb2tlOiBnZXRTZXR0aW5nRnJvbVN0b3JhZ2UoXCJtYXBQb2ludHNCb3JkZXJDb2xvclwiKSxcclxuICAgICAgICAgICAgICAgIFwic3Ryb2tlLXdpZHRoXCI6IGdldFNldHRpbmdGcm9tU3RvcmFnZShcInBvaW50c0JvcmRlcldpZHRoXCIpLFxyXG4gICAgICAgICAgICAgICAgaWQ6IGVsLmlkLFxyXG4gICAgICAgICAgICAgICAgXCJkYXRhLXRpbWVcIjogZWwudGltZVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcblxyXG5cclxuXHJcbiAgICAgICAgICAgIHZhciBpbnRlcnNlY3RzID0gU25hcC5wYXRoLmludGVyc2VjdGlvbihjaXJjbGUsICQocGF0aCkuYXR0cignZCcpKTtcclxuXHJcbiAgICAgICAgICAgIGlmIChpbnRlcnNlY3RzLmxlbmd0aCA9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICBhbGVydChcIlBsZWFzZSwgcmV0dXJuIHRvIHRoZSBwcmV2aW91cyBzdGVwIGFuZCBkcmF3IHBvaW50cyByaWdodCBvbiB0aGUgcm91dGUgbGluZVwiKTtcclxuICAgICAgICAgICAgICAgIGRvY3VtZW50LmxvY2F0aW9uLnJlcGxhY2UoXCJodHRwOi8vMTI3LjAuMC4xOjgwODAvXCIpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcG9pbnRzT2JqLmN4ID0gaW50ZXJzZWN0c1swXS54O1xyXG4gICAgICAgICAgICAgICAgcG9pbnRzT2JqLmN5ID0gaW50ZXJzZWN0c1swXS55O1xyXG4gICAgICAgICAgICB9XHJcblxyXG5cclxuICAgICAgICAgICAgcG9pbnRzQXJyYXkucHVzaChwb2ludHNPYmopO1xyXG5cclxuICAgICAgICAgICAgaW50ZXJzZWN0cy5mb3JFYWNoKGZ1bmN0aW9uKGVsKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgcy5jaXJjbGUoZWwueCwgZWwueSwgMSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ3BvaW50cycsIEpTT04uc3RyaW5naWZ5KHBvaW50c0FycmF5KSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG5cclxuXHJcbiAgICAgICAgdmFyIGludGVyc2VjdGlvbkNpcmNsZXMgPSBzdmdEb2MuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJjaXJjbGVcIik7XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBpbnRlcnNlY3Rpb25DaXJjbGVzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIGludGVyc2VjdGlvbkNpcmNsZXNbaV0uc3R5bGUuZmlsbCA9IFwidHJhbnNwYXJlbnRcIjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChnZXRTZXR0aW5nRnJvbVN0b3JhZ2UoXCJjaGVja2JveFN0YXRlXCIpID09IFwidHJ1ZVwiICYmIGdldFNldHRpbmdGcm9tU3RvcmFnZShcImRlZmF1bHRPcHRpb25cIikgPT0gXCJ0cnVlXCIpIHtcclxuICAgICAgICAgICAgdmFyIHN0YXJ0Q2lyY2xlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycsICdjaXJjbGUnKTtcclxuICAgICAgICAgICAgJChzdGFydENpcmNsZSkuYXR0cih7XHJcbiAgICAgICAgICAgICAgICBjeDogcGF0aC5nZXRQb2ludEF0TGVuZ3RoKDEpLngsXHJcbiAgICAgICAgICAgICAgICBjeTogcGF0aC5nZXRQb2ludEF0TGVuZ3RoKDEpLnksXHJcbiAgICAgICAgICAgICAgICByOiBnZXRTZXR0aW5nRnJvbVN0b3JhZ2UoXCJwb2ludHNSYWRpdXNcIiksXHJcbiAgICAgICAgICAgICAgICBzdHJva2U6IGdldFNldHRpbmdGcm9tU3RvcmFnZShcIm1hcFBvaW50c0JvcmRlckNvbG9yXCIpLFxyXG4gICAgICAgICAgICAgICAgZmlsbDogZ2V0U2V0dGluZ0Zyb21TdG9yYWdlKFwibWFwUG9pbnRzQ29sb3JcIiksXHJcbiAgICAgICAgICAgICAgICBcInN0cm9rZS13aWR0aFwiOiBnZXRTZXR0aW5nRnJvbVN0b3JhZ2UoXCJwb2ludHNCb3JkZXJXaWR0aFwiKVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgLy8gY29uc29sZS5sb2coJChzdGFydENpcmNsZSkpO1xyXG4gICAgICAgICAgICBzdmdSb290LmFwcGVuZChzdGFydENpcmNsZSk7XHJcbiAgICAgICAgfVxyXG5cclxuXHJcblxyXG4gICAgICAgIGlmIChsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnUG9pbnRzQ29udGVudCcpICE9IG51bGwpIHtcclxuICAgICAgICAgICAgdmFyIHBvaW50c0RhdGFDb250ZW50QXJyYXkgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdQb2ludHNDb250ZW50JykpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHZhciBwb2ludHNEYXRhQ29udGVudEFycmF5ID0gW107XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY2lyY2xlc0FycmF5Lmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIHZhciBwYXRocyA9IHN2Z0RvYy5nZXRFbGVtZW50QnlJZChjaXJjbGVzQXJyYXlbaV0uaWQpO1xyXG4gICAgICAgICAgICB2YXIgY2lyY2xlR3JvdXAgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoJ2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJywgJ2cnKTtcclxuXHJcblxyXG4gICAgICAgICAgICB2YXIgdGV4dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnLCAndGV4dCcpO1xyXG4gICAgICAgICAgICAkKHRleHQpLmF0dHIoe1xyXG4gICAgICAgICAgICAgICAgeDogY2lyY2xlc0FycmF5W2ldLmN4LFxyXG4gICAgICAgICAgICAgICAgeTogY2lyY2xlc0FycmF5W2ldLmN5ICsgMjAsXHJcbiAgICAgICAgICAgICAgICBcImZvbnQtc2l6ZVwiOiAxMixcclxuICAgICAgICAgICAgICAgIFwiZm9udC1zdHlsZVwiOiBcIml0YWxpY1wiLFxyXG4gICAgICAgICAgICAgICAgZmlsbDogXCIjY2NjY2NjY1wiLFxyXG4gICAgICAgICAgICAgICAgY2xhc3M6IFwiY2l0eU5hbWVcIlxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGNpcmNsZUdyb3VwLmFwcGVuZChwYXRocyk7XHJcbiAgICAgICAgICAgIGNpcmNsZUdyb3VwLmFwcGVuZCh0ZXh0KTtcclxuICAgICAgICAgICAgcGF0aEdyb3VwLmFwcGVuZChjaXJjbGVHcm91cCk7XHJcbiAgICAgICAgICAgIHdob2xlU3ZnR3JvdXAuYXBwZW5kKHBhdGhHcm91cCk7XHJcbiAgICAgICAgICAgIHN2Z1Jvb3QuYXBwZW5kKHdob2xlU3ZnR3JvdXApO1xyXG5cclxuXHJcbiAgICAgICAgICAgIHZhciBlcXVhbFRpbWVBdHRyID0gY2lyY2xlc0FycmF5W2ldLnRpbWU7XHJcblxyXG4gICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHBvaW50c0RhdGFDb250ZW50QXJyYXkubGVuZ3RoOyBqKyspIHtcclxuICAgICAgICAgICAgICAgIHZhciBwb2ludFRleHQgPSBwb2ludHNEYXRhQ29udGVudEFycmF5W2pdLmRhdGE7XHJcbiAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZygpO1xyXG5cclxuXHJcbiAgICAgICAgICAgICAgICBpZiAocG9pbnRzRGF0YUNvbnRlbnRBcnJheVtqXS5wb2ludElkID09IGVxdWFsVGltZUF0dHIpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNoZWNrZWQgPSBwb2ludHNEYXRhQ29udGVudEFycmF5W2pdLnBvaW50SWQ7XHJcblxyXG5cclxuICAgICAgICAgICAgICAgICAgICBpZiAocG9pbnRUZXh0Lmxlbmd0aCAhPSAwKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgRmlsbGVkQ29udGVudFBhdGhzID0gc3ZnRG9jLmdldEVsZW1lbnRCeUlkKGNpcmNsZXNBcnJheVtpXS5pZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBDbG9zZXN0VGV4dEZpZWxkID0gJChGaWxsZWRDb250ZW50UGF0aHMpLnBhcmVudCgpLmZpbmQoXCJ0ZXh0XCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhDbG9zZXN0VGV4dEZpZWxkKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBvaW50c0RhdGFDb250ZW50QXJyYXlbal0uY2l0eU5hbWUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKHBvaW50c0RhdGFDb250ZW50QXJyYXlbal0uY2l0eU5hbWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJChDbG9zZXN0VGV4dEZpZWxkKS50ZXh0KHBvaW50c0RhdGFDb250ZW50QXJyYXlbal0uY2l0eU5hbWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhjaXJjbGVzQXJyYXlbaV0uaWQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkKEZpbGxlZENvbnRlbnRQYXRocykuY3NzKFwiZmlsbFwiLCBcIiM5OTAwMzNcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuXHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG5cclxuICAgICAgICAgICAgfVxyXG5cclxuXHJcblxyXG4gICAgICAgICAgICAkKHBhdGhzKS5hZGRDbGFzcygnYnV0dG9uLWNvbGxhcHNlJyk7XHJcbiAgICAgICAgICAgICQocGF0aHMpLmF0dHIoJ2RhdGEtYWN0aXZhdGVzJywgXCJzbGlkZS1vdXRcIik7XHJcbiAgICAgICAgICAgICQocGF0aHMpLmF0dHIoJ2hyZWYnLCBcIiNcIik7XHJcbiAgICAgICAgICAgIHBhdGhzLnN0eWxlLmN1cnNvciA9IFwicG9pbnRlclwiO1xyXG4gICAgICAgICAgICAkKHBhdGhzKS5tb3VzZWVudGVyKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgJCh0aGlzKS5jc3MoXCJ0cmFuc2l0aW9uXCIsIFwiMC41c1wiKTtcclxuICAgICAgICAgICAgICAgICQodGhpcykuY3NzKFwic3Ryb2tlLXdpZHRoXCIsIFwiNnB4XCIpO1xyXG4gICAgICAgICAgICAgICAgJCh0aGlzKS5jc3MoXCJzdHJva2VcIiwgZ2V0U2V0dGluZ0Zyb21TdG9yYWdlKFwibWFwUG9pbnRzQm9yZGVyQ29sb3JcIikpO1xyXG5cclxuXHJcbiAgICAgICAgICAgIH0pLm1vdXNlb3V0KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgJCh0aGlzKS5jc3MoXCJ0cmFuc2l0aW9uXCIsIFwiMC41c1wiKTtcclxuICAgICAgICAgICAgICAgICQodGhpcykuY3NzKFwic3Ryb2tlLXdpZHRoXCIsIFwiM3B4XCIpO1xyXG4gICAgICAgICAgICAgICAgJCh0aGlzKS5jc3MoXCJzdHJva2VcIiwgZ2V0U2V0dGluZ0Zyb21TdG9yYWdlKFwibWFwUG9pbnRzQm9yZGVyQ29sb3JcIikpO1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIHZhciBEaXNwbGFjZW1lbnRPYmogPSB7XHJcbiAgICAgICAgICAgICAgICB6b29tOiAxMDAsXHJcbiAgICAgICAgICAgICAgICB0b3A6IDAsXHJcbiAgICAgICAgICAgICAgICBib3R0b206IDAsXHJcbiAgICAgICAgICAgICAgICBsZWZ0OiAwLFxyXG4gICAgICAgICAgICAgICAgcmlnaHQ6IDBcclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgIHZhciBGdWxsTWFwR3JvdXAgPSBTbmFwKHdob2xlU3ZnR3JvdXApO1xyXG4gICAgICAgICAgICB2YXIgcGF0aERpc3BsYWNlbWVudCA9IFNuYXAocGF0aEdyb3VwKTtcclxuXHJcbiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKHBvaW50c0RhdGFDb250ZW50QXJyYXkpO1xyXG4gICAgICAgICAgICB2YXIgc2F2ZWREaXNwbGFjZW1lbnQgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKFwibWFwU3R5bGVQcm9wZXJ0aWVzXCIpKSB8fCB7IHRyYW5zZm9ybTogXCJcIn07XHJcblxyXG4gICAgICAgICAgICB2YXIgem9vbSwgbW92ZUxlZnQsIG1vdmVUb3A7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKHNhdmVkRGlzcGxhY2VtZW50LnRyYW5zZm9ybS5sZW5ndGgpO1xyXG4gICAgICAgICAgICBpZigoc2F2ZWREaXNwbGFjZW1lbnQudHJhbnNmb3JtKSl7XHJcbiAgICAgICAgICAgICAgICAvLyBzY2FsZUltZyA9IHN0eWxlUHJvcHMudHJhbnNmb3JtO1xyXG5cclxuICAgICAgICAgICAgICAgIHZhciB0cmFuc2Zvcm1TdHJpbmcgPSAoc2F2ZWREaXNwbGFjZW1lbnQudHJhbnNmb3JtKTtcclxuICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKHNjYWxlSW1nKTtcclxuICAgICAgICAgICAgICAgIHZhciByZWdleCA9IC9bKy1dP1xcZCsoXFwuXFxkKyk/L2c7XHJcbiAgICAgICAgICAgICAgICB2YXIgU3RyaW5nVmFsdWVzID0gdHJhbnNmb3JtU3RyaW5nLm1hdGNoKHJlZ2V4KS5tYXAoZnVuY3Rpb24odikge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBwYXJzZUZsb2F0KHYpOyBcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coU3RyaW5nVmFsdWVzKTtcclxuXHJcbiAgICAgICAgICAgICAgICBzY2FsZUltZyA9IFN0cmluZ1ZhbHVlc1swXTtcclxuICAgICAgICAgICAgICAgIG1vdmVMZWZ0ID0gU3RyaW5nVmFsdWVzWzFdLFxyXG4gICAgICAgICAgICAgICAgbW92ZVRvcCA9IFN0cmluZ1ZhbHVlc1syXTtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCBzY2FsZUltZywgbW92ZUxlZnQsIG1vdmVUb3ApO1xyXG5cclxuICAgICAgICAgICAgICAgIEZ1bGxNYXBHcm91cC5hdHRyKFwidHJhbnNmb3JtXCIsIFwic2NhbGUoXCIgKyBzY2FsZUltZyArIFwiKSB0cmFuc2xhdGUoXCIrIChtb3ZlTGVmdCkgK1wiIFwiICsgKG1vdmVUb3ApKyBcIilcIik7XHJcbiAgICAgICAgICAgICAgICAvLyBwYXRoRGlzcGxhY2VtZW50LmF0dHIoXCJ0cmFuc2Zvcm1cIiwgXCJzY2FsZShcIiArIHNjYWxlSW1nICsgXCIpIHRyYW5zbGF0ZShcIisgKC1tb3ZlTGVmdCkgK1wiIFwiICsgKC1tb3ZlVG9wKSsgXCIpXCIpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG5cclxuXHJcbiAgICAgICAgICAgIHNhdmVkRGlzcGxhY2VtZW50LnRvcCA9IHBhcnNlSW50KHNhdmVkRGlzcGxhY2VtZW50LnRvcCk7XHJcbiAgICAgICAgICAgIHNhdmVkRGlzcGxhY2VtZW50LmxlZnQgPSBwYXJzZUludChzYXZlZERpc3BsYWNlbWVudC5sZWZ0KTtcclxuICAgICAgICAgICAgLy8gY29uc29sZS5sb2coc2F2ZWREaXNwbGFjZW1lbnQudG9wLCBzYXZlZERpc3BsYWNlbWVudC5sZWZ0KTtcclxuXHJcblxyXG4gICAgICAgICAgICBwYXRocy5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAkKCcuYnV0dG9uLWNvbGxhcHNlJykuc2lkZU5hdignc2hvdycpO1xyXG4gICAgICAgICAgICAgICAgJChcIi5idXR0b24tY29sbGFwc2VcIikub2ZmKCdjbGljaycpLnNpZGVOYXYoKTtcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgTnBvaW50ID0gcGFyc2VJbnQodGhpcy5pZCk7XHJcbiAgICAgICAgICAgICAgICB2YXIgZGF0YVRpbWUgPSAkKHRoaXMpLmF0dHIoJ2RhdGEtdGltZScpO1xyXG4gICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJwb2ludEluZGV4XCIpLmlubmVySFRNTCA9IE5wb2ludDtcclxuICAgICAgICAgICAgICAgIHZhciBjdXJyZW50UGF0aCA9IHRoaXM7XHJcbiAgICAgICAgICAgICAgICB2YXIgcG9pbnREYXRhVGltZSA9ICQodGhpcykuYXR0cignZGF0YS10aW1lJyk7XHJcblxyXG5cclxuXHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIGdldFBvaW50RGF0YSA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oJ1BvaW50c0NvbnRlbnQnKSkgfHwgW107XHJcbiAgICAgICAgICAgICAgICB2YXIgcG9pbnRzRGVmYXVsdERpc3BsYWNlbWVudCA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oXCJtYXBTdHlsZVByb3BlcnRpZXNcIikpIHx8IHtcclxuICAgICAgICAgICAgICAgICAgICB0cmFuc2Zvcm06IFwiXCJcclxuICAgICAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coRnVsbE1hcEdyb3VwKTtcclxuICAgICAgICAgICAgICAgIGlmICgocG9pbnRzRGVmYXVsdERpc3BsYWNlbWVudC50cmFuc2Zvcm0pLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBzY2FsZUltZyA9IHN0eWxlUHJvcHMudHJhbnNmb3JtO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB0cmFuc2Zvcm1TdHJpbmcgPSAocG9pbnRzRGVmYXVsdERpc3BsYWNlbWVudC50cmFuc2Zvcm0pO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKHNjYWxlSW1nKTtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgcmVnZXggPSAvWystXT9cXGQrKFxcLlxcZCspPy9nO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBTdHJpbmdWYWx1ZXMgPSB0cmFuc2Zvcm1TdHJpbmcubWF0Y2gocmVnZXgpLm1hcChmdW5jdGlvbih2KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBwYXJzZUZsb2F0KHYpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFN0cmluZ1ZhbHVlcyk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHpvb20gPSBTdHJpbmdWYWx1ZXNbMF07XHJcbiAgICAgICAgICAgICAgICAgICAgbW92ZUxlZnQgPSBTdHJpbmdWYWx1ZXNbMV0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1vdmVUb3AgPSBTdHJpbmdWYWx1ZXNbMl07XHJcblxyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuXHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKCFnZXRQb2ludERhdGFbTnBvaW50IC0gMV0pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHpvb20gPSAxO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgbW92ZVRvcCA9IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtb3ZlTGVmdCA9IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gdmFyIHNhdmVkWm9vbSA9IHpvb207XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gc2F2ZWREaXNwbGFjZW1lbnQudG9wID0gbW92ZVRvcDtcclxuICAgICAgICAgICAgICAgICAgICAvLyBzYXZlZERpc3BsYWNlbWVudC5sZWZ0ID0gbW92ZUxlZnQ7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKHNhdmVkRGlzcGxhY2VtZW50LnRvcCArIFwiJVwiKTtcclxuICAgICAgICAgICAgICAgICAgICAkKFwiI3BvaW50TmFtZVwiKS5odG1sKFwiXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vICQoJy5tYXBiZycpLmFuaW1hdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIC8vICAgICB6b29tOiBzYXZlZFpvb20gKyBcIiVcIixcclxuICAgICAgICAgICAgICAgICAgICAvLyAgICAgdG9wOiBzYXZlZERpc3BsYWNlbWVudC50b3AgKyBcIiVcIixcclxuICAgICAgICAgICAgICAgICAgICAvLyAgICAgbGVmdDogc2F2ZWREaXNwbGFjZW1lbnQubGVmdCArIFwiJVwiXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgRnVsbE1hcEdyb3VwLmFuaW1hdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2Zvcm06IFwic2NhbGUoXCIgKyB6b29tICsgXCIpIHRyYW5zbGF0ZShcIiArIChtb3ZlVG9wKSArIFwiIFwiICsgKG1vdmVMZWZ0KSArIFwiKVwiXHJcbiAgICAgICAgICAgICAgICAgICAgfSwgMjAwKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHpvb20gPSBnZXRQb2ludERhdGFbTnBvaW50IC0gMV0uem9vbTtcclxuICAgICAgICAgICAgICAgICAgICBtb3ZlVG9wID0gZ2V0UG9pbnREYXRhW05wb2ludCAtIDFdLnRvcDtcclxuICAgICAgICAgICAgICAgICAgICBtb3ZlTGVmdCA9IGdldFBvaW50RGF0YVtOcG9pbnQgLSAxXS5sZWZ0O1xyXG5cclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAvLyBEaXNwbGFjZW1lbnRPYmouem9vbSA9IHNhdmVkWm9vbTtcclxuICAgICAgICAgICAgICAgIC8vIERpc3BsYWNlbWVudE9iai50b3AgPSBzYXZlZERpc3BsYWNlbWVudC50b3A7XHJcbiAgICAgICAgICAgICAgICAvLyBEaXNwbGFjZW1lbnRPYmoubGVmdCA9IHNhdmVkRGlzcGxhY2VtZW50LmxlZnQ7XHJcblxyXG5cclxuICAgICAgICAgICAgICAgICQoXCIjcGx1c1wiKS5iaW5kKCdjbGljaycsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHpvb20gKz0gMC4xO1xyXG4gICAgICAgICAgICAgICAgICAgIERpc3BsYWNlbWVudE9iai56b29tID0gem9vbTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhNYXBQYXRoc0dyb3VwKTtcclxuICAgICAgICAgICAgICAgICAgICBGdWxsTWFwR3JvdXAuYW5pbWF0ZSh7IFwidHJhbnNmb3JtXCI6IFwic2NhbGUoXCIgKyB6b29tICtcIikgdHJhbnNsYXRlKFwiICsgKG1vdmVMZWZ0KSArIFwiIFwiICsgbW92ZVRvcCArIFwiKVwiIH0sIDMwMCk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICAkKFwiI21pbnVzXCIpLmJpbmQoJ2NsaWNrJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgem9vbSAtPSAwLjE7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGlmICh6b29tIDw9IDEuMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB6b29tID0gMS4wO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBEaXNwbGFjZW1lbnRPYmouem9vbSA9IHpvb207XHJcbiAgICAgICAgICAgICAgICAgICAgRnVsbE1hcEdyb3VwLmFuaW1hdGUoeyB0cmFuc2Zvcm06IFwic2NhbGUoXCIgKyB6b29tICsgXCIpIHRyYW5zbGF0ZShcIiArIChtb3ZlTGVmdCkgKyBcIiBcIiArIG1vdmVUb3AgKyBcIilcIiB9LCAzMDApO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcblxyXG5cclxuICAgICAgICAgICAgICAgICQoXCIjbW92ZUxlZnRcIikuYmluZChcImNsaWNrXCIsIGZ1bmN0aW9uKCkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBtb3ZlTGVmdCArPSAyMDtcclxuICAgICAgICAgICAgICAgICAgICBEaXNwbGFjZW1lbnRPYmoubGVmdCA9IG1vdmVMZWZ0O1xyXG4gICAgICAgICAgICAgICAgICAgIEZ1bGxNYXBHcm91cC5hbmltYXRlKHsgdHJhbnNmb3JtOiBcInNjYWxlKFwiICsgem9vbSArIFwiKSB0cmFuc2xhdGUoXCIgKyAobW92ZUxlZnQpICsgXCIgXCIgKyBtb3ZlVG9wICsgXCIpXCIgfSwgMzAwKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgJChcIiNtb3ZlUmlnaHRcIikuYmluZChcImNsaWNrXCIsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIG1vdmVMZWZ0IC09IDIwO1xyXG4gICAgICAgICAgICAgICAgICAgIERpc3BsYWNlbWVudE9iai5sZWZ0ID0gbW92ZUxlZnQ7XHJcbiAgICAgICAgICAgICAgICAgICAgRnVsbE1hcEdyb3VwLmFuaW1hdGUoeyB0cmFuc2Zvcm06IFwic2NhbGUoXCIgKyB6b29tICsgXCIpIHRyYW5zbGF0ZShcIiArIChtb3ZlTGVmdCkgKyBcIiBcIiArIG1vdmVUb3AgKyBcIilcIiB9LCAzMDApO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAkKFwiI21vdmVUb3BcIikuYmluZChcImNsaWNrXCIsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIG1vdmVUb3AgKz0gMjA7XHJcbiAgICAgICAgICAgICAgICAgICAgRGlzcGxhY2VtZW50T2JqLnRvcCA9IG1vdmVUb3A7XHJcbiAgICAgICAgICAgICAgICAgICAgRnVsbE1hcEdyb3VwLmFuaW1hdGUoeyB0cmFuc2Zvcm06IFwic2NhbGUoXCIgKyB6b29tICsgXCIpIHRyYW5zbGF0ZShcIiArIChtb3ZlTGVmdCkgKyBcIiBcIiArIG1vdmVUb3AgKyBcIilcIiB9LCAzMDApO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAkKFwiI21vdmVCb3R0b21cIikuYmluZChcImNsaWNrXCIsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIG1vdmVUb3AgLT0gMjA7XHJcbiAgICAgICAgICAgICAgICAgICAgRGlzcGxhY2VtZW50T2JqLnRvcCA9IG1vdmVUb3A7XHJcbiAgICAgICAgICAgICAgICAgICAgRnVsbE1hcEdyb3VwLmFuaW1hdGUoeyB0cmFuc2Zvcm06IFwic2NhbGUoXCIgKyB6b29tICsgXCIpIHRyYW5zbGF0ZShcIiArIChtb3ZlTGVmdCkgKyBcIiBcIiArIG1vdmVUb3AgKyBcIilcIiB9LCAzMDApO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcblxyXG5cclxuXHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdQb2ludHNDb250ZW50JykgIT0gbnVsbCkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB2YXIgUG9pbnRMYXN0RGF0YTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBnZXRQb2ludERhdGEubGVuZ3RoOyBqKyspIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjb3VudCA9IGdldFBvaW50RGF0YVtqXS5wb2ludElkID09IGRhdGFUaW1lO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZ2V0UG9pbnREYXRhW2pdLnBvaW50SWQgPT0gZGF0YVRpbWUpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBGdWxsTWFwR3JvdXAuYW5pbWF0ZSh7IFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zZm9ybTogXCJzY2FsZShcIiArIHBhcnNlRmxvYXQoZ2V0UG9pbnREYXRhW2pdLnpvb20pICsgXCIpIHRyYW5zbGF0ZShcIiArIChnZXRQb2ludERhdGFbal0ubGVmdCkgKyBcIiBcIiArIGdldFBvaW50RGF0YVtqXS50b3AgKyBcIilcIiBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIDMwMCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gJCgnLm1hcGJnJykuYW5pbWF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyAgICAgem9vbTogZ2V0UG9pbnREYXRhW2pdLnRyYW5zZm9ybSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBQb2ludENpdHlOYW1lID0gZ2V0UG9pbnREYXRhW2pdLmNpdHlOYW1lO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoY291bnQpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBQb2ludExhc3REYXRhID0gZ2V0UG9pbnREYXRhW2pdLmRhdGE7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICQoXCIjcG9pbnROYW1lXCIpLnZhbChQb2ludENpdHlOYW1lKTtcclxuICAgICAgICAgICAgICAgICAgICBlZGl0b3Iuc2V0RGF0YShQb2ludExhc3REYXRhKTtcclxuXHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG5cclxuXHJcblxyXG4gICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJTYXZlUG9pbnRDb250ZW50XCIpLm9uY2xpY2sgPSBmdW5jdGlvbigpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHBvaW50c0RhdGFDb250ZW50ID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBwb2ludElkOiAwLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjaXR5TmFtZTogXCJcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgem9vbTogem9vbSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGVmdDogbW92ZUxlZnQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvcDogbW92ZVRvcCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2xpZGVyOiBcImZhbHNlXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IFwiXCJcclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIHZhciBJbnB1dFpvb21WYWx1ZSA9IHBhcnNlSW50KGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicG9pbnRab29tXCIpLnZhbHVlKTtcclxuICAgICAgICAgICAgICAgICAgICAvLyB2YXIgSW5wdXRUb3BWYWx1ZSA9IHBhcnNlSW50KGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicG9pbnRUb3BcIikudmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIHZhciBJbnB1dEJvdHRvbVZhbHVlID0gcGFyc2VJbnQoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJwb2ludEJvdHRvbVwiKS52YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gdmFyIElucHV0TGVmdFZhbHVlID0gcGFyc2VJbnQoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJwb2ludExlZnRcIikudmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIHZhciBJbnB1dFJpZ2h0VmFsdWUgPSBwYXJzZUludChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncG9pbnRSaWdodCcpLnZhbHVlKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIFBvaW50TmFtZSA9ICQoXCIjcG9pbnROYW1lXCIpLnZhbCgpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBwb2ludHNEYXRhQ29udGVudC5wb2ludElkID0gcG9pbnREYXRhVGltZTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgcG9pbnRzRGF0YUNvbnRlbnQuY2l0eU5hbWUgPSBQb2ludE5hbWU7XHJcblxyXG5cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgcG9pbnRzRGF0YUNvbnRlbnQuZGF0YSA9IGVkaXRvci5nZXREYXRhKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgcG9pbnRzRGF0YUNvbnRlbnRBcnJheS5sZW5ndGg7IGorKykge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBvaW50c0RhdGFDb250ZW50QXJyYXlbal0ucG9pbnRJZCA9PSBwb2ludERhdGFUaW1lKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb2ludHNEYXRhQ29udGVudEFycmF5LnNwbGljZShqLCAxKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHBvaW50c0RhdGFDb250ZW50LmRhdGEubGVuZ3RoID09IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgTWF0ZXJpYWxpemUudG9hc3QoJ05vIGRhdGEgaW4gcG9pbnQhJywgMjAwMCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2cocG9pbnRzRGF0YUNvbnRlbnQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBwb2ludHNEYXRhQ29udGVudEFycmF5LnB1c2gocG9pbnRzRGF0YUNvbnRlbnQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGV4dEZpZWxkID0gJChjdXJyZW50UGF0aCkucGFyZW50KCkuZmluZChcInRleHRcIik7XHJcblxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgJCh0ZXh0RmllbGQpLnRleHQoUG9pbnROYW1lKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gIGNvbnNvbGUubG9nKCQodGV4dEZpZWxkKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIE1hdGVyaWFsaXplLnRvYXN0KCdZb3VyIGRhdGEgaXMgc2F2ZWQhJywgMjAwMCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHBvaW50c0RhdGFDb250ZW50QXJyYXkuc29ydChjb21wYXJlVGltZSlcclxuICAgICAgICAgICAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnUG9pbnRzQ29udGVudCcsIEpTT04uc3RyaW5naWZ5KHBvaW50c0RhdGFDb250ZW50QXJyYXkpKTtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgb3ZlcmxheSA9ICQoJyNzaWRlbmF2LW92ZXJsYXknKTtcclxuICAgICAgICAgICAgICAgICAgICAkKG92ZXJsYXkpLmNzcyhcImJhY2tncm91bmQtY29sb3JcIiwgXCJub25lXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICQob3ZlcmxheSkucmVtb3ZlKCk7XHJcblxyXG5cclxuXHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChwb2ludHNEYXRhQ29udGVudC5kYXRhLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJChjdXJyZW50UGF0aCkuY3NzKFwiZmlsbFwiLCBcIiM5OTAwMzNcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChwb2ludHNEYXRhQ29udGVudC5kYXRhLmxlbmd0aCA9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICQoY3VycmVudFBhdGgpLmNzcyhcImZpbGxcIiwgZ2V0U2V0dGluZ0Zyb21TdG9yYWdlKFwibWFwUG9pbnRzQ29sb3JcIikpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgJCgnLmJ1dHRvbi1jb2xsYXBzZScpLnNpZGVOYXYoJ2hpZGUnKTtcclxuXHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcblxyXG5cclxuXHJcbiAgICAgICAgdmFyIHBhdGhMZW5ndGggPSBwYXRoLmdldFRvdGFsTGVuZ3RoKCk7XHJcblxyXG4gICAgICAgIHZhciBzdG9wc0F0TGVuZ3RoID0gW107XHJcblxyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcGF0aExlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIHZhciBwYXRoTGVuZ3RoQXRQb2ludCA9IHBhdGguZ2V0UG9pbnRBdExlbmd0aChpKTtcclxuXHJcbiAgICAgICAgICAgIHZhciBwb2ludFggPSBwYXRoTGVuZ3RoQXRQb2ludC54O1xyXG4gICAgICAgICAgICB2YXIgcG9pbnRZID0gcGF0aExlbmd0aEF0UG9pbnQueTtcclxuXHJcblxyXG4gICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHBvaW50c0FycmF5Lmxlbmd0aDsgaisrKSB7XHJcblxyXG5cclxuICAgICAgICAgICAgICAgIGlmIChNYXRoLmFicyhNYXRoLnJvdW5kKHBvaW50WCAtIHBvaW50c0FycmF5W2pdLmN4KSkgPD0gMCAmJiBNYXRoLmFicyhNYXRoLnJvdW5kKHBvaW50WSAtIHBvaW50c0FycmF5W2pdLmN5KSkgPD0gMCkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBzdG9wc0F0TGVuZ3RoLnB1c2goaSk7XHJcblxyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgfVxyXG5cclxuXHJcblxyXG5cclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHN0b3BzQXRMZW5ndGgubGVuZ3RoICE9IHBvaW50c0FycmF5Lmxlbmd0aCkge1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHN0b3BzQXRMZW5ndGgubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIGlmIChzdG9wc0F0TGVuZ3RoW2kgKyAxXSAtIHN0b3BzQXRMZW5ndGhbaV0gPT0gMSkgc3RvcHNBdExlbmd0aC5zcGxpY2UoaSwgMSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKFwic3RvcHNBdExlbmd0aFwiLCBKU09OLnN0cmluZ2lmeShzdG9wc0F0TGVuZ3RoKSk7XHJcblxyXG4gICAgICAgIGlmIChwb2ludHNBcnJheS5sZW5ndGggIT09IHN0b3BzQXRMZW5ndGgubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiSEVSRSBJUyBUSEUgRElGRkVSRU5DRTogMXN0IGFycmF5IGxlbmd0aCA9IFwiICsgcG9pbnRzQXJyYXkubGVuZ3RoICsgJywgMm5kIGFyciBsZW5ndGg9ICcgKyBzdG9wc0F0TGVuZ3RoLmxlbmd0aCArIFwiXCIpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdubyBESUZGRVJFTkNFIGJldHdlZW4gYXJyIGxlbmd0aHMnKTtcclxuICAgICAgICB9XHJcblxyXG5cclxuXHJcblxyXG4gICAgfSwgZmFsc2UpO1xyXG5cclxuXHJcbiAgICB2YXIgV3JhcHBlclByb3BzID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnbWFwU3R5bGVQcm9wZXJ0aWVzJykpO1xyXG5cclxuXHJcbiAgICAvLyAkKFwiLm1hcGJnXCIpLmNzcyhcImJhY2tncm91bmQtY29sb3JcIiwgZ2V0U2V0dGluZ0Zyb21TdG9yYWdlKFwiYm9keUJhY2tncm91bmRDb2xvclwiKSk7XHJcbiAgICAkKFwiYm9keVwiKS5jc3MoXCJiYWNrZ3JvdW5kLWNvbG9yXCIsIGdldFNldHRpbmdGcm9tU3RvcmFnZShcImJvZHlCYWNrZ3JvdW5kQ29sb3JcIikpO1xyXG5cclxuXHJcbiAgICAvLyAkLmVhY2goV3JhcHBlclByb3BzLCBmdW5jdGlvbihwcm9wLCB2YWx1ZSkge1xyXG4gICAgLy8gICAgICQoXCIubWFwYmdcIikuY3NzKHByb3AsIHZhbHVlKTtcclxuICAgIC8vIH0pO1xyXG5cclxufSk7Il19
