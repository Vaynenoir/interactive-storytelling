$(document).ready(function(){function t(t){var e=JSON.parse(localStorage.getItem("Settings"))||{mapColor:"rgba(255, 204, 128, 1)",mapStrokeColor:"rgba(0, 0, 0, 1)",mapPointsColor:"rgba(0, 0, 255, 1)",mapPointsBorderColor:"rgba(0, 0, 0, 1)",mapRouteColor:"rgba(0, 0, 0, 1)",bodyBackgroundColor:"rgba(243, 229, 245, 1)",routeBorderWidth:"4",pointsRadius:"8",pointsBorderWidth:"1",contentWidth:"50",contentAlign:"flex-start"};if(e[t])return e[t]}function e(t){if(!$(t).length)return!1;var e=$(t).offset().top,a=$(t).offset().top+$(t).outerHeight(),o=$(window).scrollTop()+$(window).height(),r=$(window).scrollTop();return o>e&&r<a}var a=JSON.parse(localStorage.getItem("PointsContent"))||[];JSON.parse(localStorage.getItem("SavedMapColors"));a&&a.sort(function(t,e){return t.pointId-e.pointId});for(var o=document.getElementById("boom"),r=0;r<a.length;r++){var n=document.createElement("section");$(n).addClass("js-section"),$(n).attr({"data-zoom":a[r].zoom,"data-pos-top":a[r].top,"data-pos-left":a[r].left,id:"section_"+(r+1)}),n.insertAdjacentHTML("beforeend",a[r].data),$(n).find("img").addClass("js-image"),$(n).find(".js-image").attr("data-pos-x",0),$(n).find(".js-image").attr("data-pos-y",0),o.append(n),$("div.text_wrapper").css("align-items",t("contentAlign")),$(".js-section").css("width",t("contentWidth")+"%")}$(".js-image");$.fn.hasAttr=function(t){return void 0!==this.attr(t)};var s=$(".js-section");$.each(s,function(t,e){var a=$(e).find(".slick-gallery");0==$(a).find("img.slick-item").length&&(console.log($(a)),$(a).remove());var o=$(e).find(".single_image");$(o).hasClass(".slick-current")||$(o).addClass("slick-current"),$(a).find("br").remove(),$("br").remove(),$(a).text().replace(/&nbsp;/g,"")}),$(".slick_gallery").slick({slidesToShow:1,slidesToScroll:1,prevArrow:!0,nextArrow:!0});var i=document.getElementById("map"),l=JSON.parse(localStorage.getItem("map"));$("#map").attr("data",l),i.addEventListener("load",function(){var r=i.contentDocument,n=r.documentElement;n.setAttribute("x","520px"),n.setAttribute("y","300px");var s=n.getElementById("mapPaths"),l=s.getElementsByTagName("path"),c=document.createElementNS("http://www.w3.org/2000/svg","g");c.append(s),$(c).attr("id","wholeSvgGroup");var d=Snap(c),p=JSON.parse(localStorage.getItem("mapStyleProperties"))||{transform:""};Snap(w);if(p.transform.length>0){transformString=p.transform;var g=transformString.match(/[+-]?\d+(\.\d+)?/g).map(function(t){return parseFloat(t)});console.log(g),scaleImg=g[0],moveLeft=g[1],moveTop=g[2],console.log(scaleImg,moveLeft,moveTop),d.attr("transform","scale("+scaleImg+") translate("+moveLeft+" "+moveTop+")")}for(var m=0;m<l.length;m++)l[m].style.fill=t("mapColor"),l[m].style.stroke=t("mapStrokeColor");var f=JSON.parse(localStorage.getItem("path"));if($(n).addClass("my-svg"),f){var h=document.createElementNS("http://www.w3.org/2000/svg","path");$(h).attr("d",f),$(h).attr("fill","transparent"),$(h).attr("stroke",t("mapRouteColor")),$(h).attr("opacity","0.8"),$(h).attr("stroke-width",t("routeBorderWidth")),$(h).attr("stroke-linecap","round"),$(h).attr("id","routePath")}parseInt($("#IDmapbg")[0].style.top),parseInt($("#IDmapbg")[0].style.left);var u=document.createElementNS("http://www.w3.org/2000/svg","path");$(u).css("display","none");var v=[];$(".lightOn").each(function(t){v.push($(this))});var S=JSON.parse(localStorage.getItem("circlesCoords"));$(v).each(function(t,e){var a=$(e).closest("section")[0].id;a=parseInt(a[8])-1,console.log(t),a==S[a].id-1&&$(e).attr({"data-pos-x":S[a].cx,"data-pos-y":S[a].cy})}),Snap.plugin(function(t,e,a,o){a.prototype.circlePath=function(t,e,a){var o="M"+t+","+e;return o+="m"+-a+",0",o+="a"+a+","+a+" 0 1,0 "+2*a+",0",o+="a"+a+","+a+" 0 1,0 "+-2*a+",0",this.path(o,t,e)}});var w=document.createElementNS("http://www.w3.org/2000/svg","g");w.id="pathGroup",w.append(h),$(c).append(w),n.append(c);var y=Snap(w),x=JSON.parse(localStorage.getItem("circlesCoords"));$.each(x,function(e,a){var o=y.circlePath(this.cx,this.cy,this.r).attr({fill:t("mapPointsColor"),stroke:t("mapPointsBorderColor"),"stroke-width":t("pointsBorderWidth"),id:e+1,class:"circleElement",style:"display:none",onclick:"clickCircle()"});Snap.path.intersection(o,$(h).attr("d")).forEach(function(t){y.circle(t.x,t.y,1)})});var I=n.getElementById("pathGroup");for(m=0;m<x.length;m++){var C=document.createElementNS("http://www.w3.org/2000/svg","g"),k=n.getElementById(m+1);C.append(k);var b=document.createElementNS("http://www.w3.org/2000/svg","text");$(b).attr({x:x[m].cx,y:x[m].cy+20,"font-size":12,"font-style":"italic",fill:"#ccccccc",style:"display: none",class:"cityName"}),$(b).text(a[m].cityName),C.append(b),I.append(C),c.append(I),n.append(c)}var N=r.getElementsByTagName("circle");for(m=0;m<N.length;m++)N[m].style.fill="transparent";var E=JSON.parse(localStorage.getItem("StartRouteIcon")),A=(new DOMParser).parseFromString(E,"text/xml").documentElement,B=$(A).attr("data-offset-x"),O=$(A).attr("data-offset-y"),P=$(A).attr("data-scale"),T=document.createElementNS("http://www.w3.org/2000/svg","g");if("true"==t("UserOption")&&E){for(m=0;m<E.length;m++)$(A).attr({fill:t("RouteStartIconColor"),transform:P});$(T).attr("transform","translate("+(h.getPointAtLength(1).x-t("RouteStartIconSize")/B)+" "+(h.getPointAtLength(1).y-t("RouteStartIconSize")/O)+") scale("+t("RouteStartIconSize")/100+")"),T.append(A),c.append(T),n.append(c)}if("true"==t("checkboxState")&&"true"==t("defaultOption")){var L=document.createElementNS("http://www.w3.org/2000/svg","circle");$(L).attr({cx:h.getPointAtLength(1).x,cy:h.getPointAtLength(1).y,r:t("pointsRadius"),stroke:t("mapPointsBorderColor"),fill:t("mapPointsColor"),"stroke-width":t("pointsBorderWidth")}),c.append(L),n.append(c)}o.style.display="block";var j=h.getTotalLength(),J=($(h).css({"stroke-dashoffset":j,"stroke-dasharray":j+" "+j}),JSON.parse(localStorage.getItem("stopsAtLength")));$(window).on("scroll",function(a){!function(){for(var t=r.querySelectorAll(".circleElement"),e=r.querySelectorAll(".cityName"),a=0;a<J.length;a++)$.each($(".js-section"),function(a,o){if($(this).hasClass("active")){var n=($(window).scrollTop()-$(this).offset().top)/$(this).height()*100,s=$(this).attr("id");s=parseInt(s[8])-1;var i,l=n*(J[s]/100);i=Math.floor(l);for(var c=r.getElementById(s+1),d=parseFloat($(h).css("stroke-dashoffset")),p=0;p<t.length;p++)$(c).parent().find("text"),d>=j-20?($(t[p]).fadeOut(900),$(e[p]).fadeOut(900)):t[p].id<=s+1?($(t[p]).fadeIn(900),$(e[p]).fadeIn(900)):t[p].id>s+1&&($(t[p]).fadeOut(900),$(e[p]).fadeOut(900));i<J[s]&&(0==s&&i<J[s]&&$(h).css("stroke-dashoffset",j-i+"px"),s>0&&i<J[s]&&$(h).css("stroke-dashoffset",""+(j-(J[s-1]+i)))),J[s-1]+i>J[s]&&$(h).css("stroke-dashoffset",j-J[s]+"px")}})}(),function(){function a(t,e,a){var o=n.createSVGPoint();return o.x=e,o.y=a,o.matrixTransform(t.getScreenCTM().inverse())}$(".js-section").each(function(t){var a=$(window).scrollTop(),o=$(this).offset().top,r=$(this).attr("data-zoom"),n=parseInt($(this).attr("data-pos-top")),s=($(this).attr("data-pos-bottom"),parseInt($(this).attr("data-pos-left")));$(this).attr("data-pos-right"),o<=a&&e($(this))?($(this).addClass("active"),d.animate({transform:"scale("+r+") translate("+s+" "+n+")"},700)):($(this).removeClass("active"),!$(".js-section").hasClass("active")&&$(window).scrollTop()<20&&d.animate({transform:"scale("+scaleImg+") translate("+moveLeft+" "+moveTop+")"},700))});var o=0;$(v).each(function(){if(e($(this))){o++;var r=$(this).attr("data-pos-x"),s=$(this).attr("data-pos-y"),i=this.closest("section"),l=($(i).attr("data-zoom"),$(i).attr("data-pos-top")),d=($(i).attr("data-pos-left"),$(this)[0].getBoundingClientRect()),p=(d.top,$(this).height(),-(+d.left+ +d.width)/1920*1400),g=+d.top/1200*900,m=-(+d.left+ +d.width)/1920*1400,f=d.bottom/1200*900,h=a(n,p,g),v=a(n,m,f);a(c,p,g),a(c,m,f),$(u).css("position","relative"),"flex-start"==t("contentAlign")?($(u).attr("d","M"+r+" "+s+" L"+(h.x-p)+" "+g+" L"+(v.x-m)+" "+(f-l)+" Z"),$(u).attr("fill","url(#gradient)")):"flex-end"==t("contentAlign")&&($(u).attr("fill","url(#gradient_reverse)"),$(u).attr("d","M"+r+" "+s+" L"+(-h.x-p)+" "+g+" L"+(-v.x-m)+" "+(f-l)+" Z")),$(u).attr("opacity",".3")}}),$(c).prepend(u),n.append(c),o>0?$(u).fadeIn(900):$(u).fadeOut(900)}()});var R=n.getAttribute("xmlns");n.addEventListener("click",function(t){console.log("1");var e,a,o=n.createSVGPoint();o.x=t.clientX,o.y=t.clientY,e=o.matrixTransform(n.getScreenCTM().inverse()),(a=document.createElementNS(R,"circle")).setAttributeNS(null,"cx",e.x),a.setAttributeNS(null,"cy",e.y),a.setAttributeNS(null,"r",10),n.appendChild(a)},!1)},!1),$("#IDmapbg").css("background-color",t("bodyBackgroundColor")),$("body").css("background-color",t("bodyBackgroundColor"))});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInJwX3NjcmlwdC5qcyJdLCJuYW1lcyI6WyIkIiwiZG9jdW1lbnQiLCJyZWFkeSIsImdldFNldHRpbmdGcm9tU3RvcmFnZSIsInNldHRpbmciLCJTZXR0aW5nc09iamVjdCIsIkpTT04iLCJwYXJzZSIsImxvY2FsU3RvcmFnZSIsImdldEl0ZW0iLCJtYXBDb2xvciIsIm1hcFN0cm9rZUNvbG9yIiwibWFwUG9pbnRzQ29sb3IiLCJtYXBQb2ludHNCb3JkZXJDb2xvciIsIm1hcFJvdXRlQ29sb3IiLCJib2R5QmFja2dyb3VuZENvbG9yIiwicm91dGVCb3JkZXJXaWR0aCIsInBvaW50c1JhZGl1cyIsInBvaW50c0JvcmRlcldpZHRoIiwiY29udGVudFdpZHRoIiwiY29udGVudEFsaWduIiwiaW5XaW5kb3ciLCJzIiwibGVuZ3RoIiwiaW1nX3RvcF9vZmZzZXQiLCJvZmZzZXQiLCJ0b3AiLCJpbWdfYm90dG9tIiwib3V0ZXJIZWlnaHQiLCJib3R0b21PZlNjcmVlbiIsIndpbmRvdyIsInNjcm9sbFRvcCIsImhlaWdodCIsInRvcE9mU2NyZWVuIiwiZGF0YUNvbnRlbnQiLCJzb3J0Iiwib2JqQSIsIm9iakIiLCJwb2ludElkIiwidGV4dF9jb250IiwiZ2V0RWxlbWVudEJ5SWQiLCJpIiwic2VjdGlvbiIsImNyZWF0ZUVsZW1lbnQiLCJhZGRDbGFzcyIsImF0dHIiLCJkYXRhLXpvb20iLCJ6b29tIiwiZGF0YS1wb3MtdG9wIiwiZGF0YS1wb3MtbGVmdCIsImxlZnQiLCJpZCIsImluc2VydEFkamFjZW50SFRNTCIsImRhdGEiLCJmaW5kIiwiYXBwZW5kIiwiY3NzIiwiZm4iLCJoYXNBdHRyIiwibmFtZSIsInVuZGVmaW5lZCIsInRoaXMiLCJzZWN0aW9ucyIsImVhY2giLCJlbCIsInNsaWRlciIsImNvbnNvbGUiLCJsb2ciLCJyZW1vdmUiLCJzaW5nbGVJbWFnZSIsImhhc0NsYXNzIiwidGV4dCIsInJlcGxhY2UiLCJzbGljayIsInNsaWRlc1RvU2hvdyIsInNsaWRlc1RvU2Nyb2xsIiwicHJldkFycm93IiwibmV4dEFycm93IiwiYSIsIm1hcF91cmxfdHJ1ZSIsImFkZEV2ZW50TGlzdGVuZXIiLCJzdmdEb2MiLCJjb250ZW50RG9jdW1lbnQiLCJzdmdSb290IiwiZG9jdW1lbnRFbGVtZW50Iiwic2V0QXR0cmlidXRlIiwiTWFwUGF0aHNHcm91cCIsIlBhdGhzQXJyYXkiLCJnZXRFbGVtZW50c0J5VGFnTmFtZSIsIndob2xlU3ZnR3JvdXAiLCJjcmVhdGVFbGVtZW50TlMiLCJGdWxsTWFwR3JvdXAiLCJTbmFwIiwiV3JhcHBlclByb3BzIiwidHJhbnNmb3JtIiwicGF0aEdyb3VwIiwidHJhbnNmb3JtU3RyaW5nIiwiU3RyaW5nVmFsdWVzIiwibWF0Y2giLCJtYXAiLCJ2IiwicGFyc2VGbG9hdCIsInNjYWxlSW1nIiwibW92ZUxlZnQiLCJtb3ZlVG9wIiwic3R5bGUiLCJmaWxsIiwic3Ryb2tlIiwiUGF0aERpcmVjdGlvbiIsInBhdGgiLCJwYXJzZUludCIsInBhdGgxIiwiYXJySW1nSUQiLCJwdXNoIiwiQ2lyY2xlUGF0aENvb3JkcyIsImltZ1BhcmVudElEIiwiY2xvc2VzdCIsImRhdGEtcG9zLXgiLCJjeCIsImRhdGEtcG9zLXkiLCJjeSIsInBsdWdpbiIsIkVsZW1lbnQiLCJQYXBlciIsImdsb2JhbCIsInByb3RvdHlwZSIsImNpcmNsZVBhdGgiLCJyIiwicCIsImNpcmNsZXNBcnJheSIsImluZGV4IiwiY2lyY2xlIiwic3Ryb2tlLXdpZHRoIiwiY2xhc3MiLCJvbmNsaWNrIiwiaW50ZXJzZWN0aW9uIiwiZm9yRWFjaCIsIngiLCJ5IiwiUGFyZW50Q2ljbGVHcm91cCIsImNpcmNsZUdyb3VwIiwiY3VycmVudFBvaW50IiwiZm9udC1zaXplIiwiZm9udC1zdHlsZSIsImNpdHlOYW1lIiwiaW50ZXJzZWN0aW9uQ2lyY2xlcyIsInBhdGhTdGFydEljb24iLCJwYXJzZWRQYXRoU3RhcnRJY29uIiwiRE9NUGFyc2VyIiwicGFyc2VGcm9tU3RyaW5nIiwiaWNvbk9mZnNldFgiLCJpY29uT2Zmc2V0WSIsImljb25TY2FsZSIsImdyb3VwIiwiZ2V0UG9pbnRBdExlbmd0aCIsInN0YXJ0Q2lyY2xlIiwiZGlzcGxheSIsImdldFRvdGFsTGVuZ3RoIiwiU3RvcFBvaW50cyIsInN0cm9rZS1kYXNob2Zmc2V0Iiwic3Ryb2tlLWRhc2hhcnJheSIsIm9uIiwiZSIsImNpcmNsZUVsZW1lbnRzIiwicXVlcnlTZWxlY3RvckFsbCIsInRleHRFbGVtZW50cyIsIiRwZXJjZW50YWdlQ29tcGxldGUiLCJjdXJyZW50U2VjdGlvbklEIiwiQ3VycmVudFBhdGhDdXJyZW50TGVuZ3RoIiwiJG9mZnNldFVuaXQiLCJNYXRoIiwiZmxvb3IiLCJjdXJyZW50Q2lyY2xlIiwiY3VyRGFzaE9mZnNldCIsImoiLCJwYXJlbnQiLCJmYWRlT3V0IiwiZmFkZUluIiwiZHJhd1BhdGgiLCJzdmdQb2ludCIsImVsZW1lbnQiLCJwdCIsImNyZWF0ZVNWR1BvaW50IiwibWF0cml4VHJhbnNmb3JtIiwiZ2V0U2NyZWVuQ1RNIiwiaW52ZXJzZSIsInNjcm9sbENvdW50IiwidG9wT2Zmc2V0IiwiZGF0YVpvb20iLCJkYXRhUG9zVG9wIiwiZGF0YVBvc0xlZnQiLCJhbmltYXRlIiwicmVtb3ZlQ2xhc3MiLCJ2aXNfY291bnQiLCJjdXJyZW50U2VjdGlvbiIsImN1cnJlbnRUb3BPZmZzZXQiLCJDb29yZGluYXRlcyIsImdldEJvdW5kaW5nQ2xpZW50UmVjdCIsInJpZ2h0X3RvcF9YIiwid2lkdGgiLCJyaWdodF90b3BfWSIsInJpZ2h0X2JvdHRvbV9YIiwicmlnaHRfYm90dG9tX1kiLCJzdmdfcmlnaHRfdG9wIiwic3ZnX3JpZ2h0X2JvdHRvbSIsInByZXBlbmQiLCJzZWN0aW9uQ291bnRlciIsIk5TIiwiZ2V0QXR0cmlidXRlIiwic3ZnUCIsImNsaWVudFgiLCJjbGllbnRZIiwic2V0QXR0cmlidXRlTlMiLCJhcHBlbmRDaGlsZCJdLCJtYXBwaW5ncyI6IkFBQUFBLEVBQUVDLFVBQVVDLE1BQU0sV0FFZCxTQUFTQyxF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T0FBTyxLQUVoQmpMLEVBQUUrRyxHQUFPaUUsUUFBUSxLQTZPckI4QixLQU9KLElBQUlDLEVBQUs1SCxFQUFRNkgsYUFBYSxTQUU5QjdILEVBQVFILGlCQUFpQixRQUFTLFNBQVNrRixHQUN2Q2hHLFFBQVFDLElBQUksS0FDZCxJQUFtQzhJLEVBQU05RSxFQUFyQ2tELEVBQUtsRyxFQUFRbUcsaUJBRWpCRCxFQUFHNUMsRUFBSXlCLEVBQUVnRCxRQUNUN0IsRUFBRzNDLEVBQUl3QixFQUFFaUQsUUFDVEYsRUFBTzVCLEVBQUdFLGdCQUFnQnBHLEVBQVFxRyxlQUFlQyxZQUVqRHRELEVBQVNsSSxTQUFTeUYsZ0JBQWdCcUgsRUFBSSxXQUMvQkssZUFBZSxLQUFNLEtBQU1ILEVBQUt4RSxHQUN2Q04sRUFBT2lGLGVBQWUsS0FBTSxLQUFNSCxFQUFLdkUsR0FDdkNQLEVBQU9pRixlQUFlLEtBQU0sSUFBSyxJQUNqQ2pJLEVBQVFrSSxZQUFZbEYsS0FDbkIsS0FZSixHQUtDbkksRUFBRSxZQUFZd0QsSUFBSSxtQkFBb0JyRCxFQUFzQix3QkFDNURILEVBQUUsUUFBUXdELElBQUksbUJBQW9CckQsRUFBc0IiLCJmaWxlIjoicnBfc2NyaXB0LmpzIiwic291cmNlc0NvbnRlbnQiOlsiJChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24oKSB7XHJcbiAgICAvLyBnZXQgZWRpdG9yIHNldHRpbmdzXHJcbiAgICBmdW5jdGlvbiBnZXRTZXR0aW5nRnJvbVN0b3JhZ2Uoc2V0dGluZyl7XHJcbiAgICAgICAgdmFyIFNldHRpbmdzT2JqZWN0ID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbShcIlNldHRpbmdzXCIpKSB8fCB7XHJcbiAgICAgICAgbWFwQ29sb3I6IFwicmdiYSgyNTUsIDIwNCwgMTI4LCAxKVwiLFxyXG4gICAgICAgIG1hcFN0cm9rZUNvbG9yOiBcInJnYmEoMCwgMCwgMCwgMSlcIixcclxuICAgICAgICBtYXBQb2ludHNDb2xvcjogXCJyZ2JhKDAsIDAsIDI1NSwgMSlcIixcclxuICAgICAgICBtYXBQb2ludHNCb3JkZXJDb2xvcjogXCJyZ2JhKDAsIDAsIDAsIDEpXCIsXHJcbiAgICAgICAgbWFwUm91dGVDb2xvcjogXCJyZ2JhKDAsIDAsIDAsIDEpXCIsXHJcbiAgICAgICAgYm9keUJhY2tncm91bmRDb2xvcjogXCJyZ2JhKDI0MywgMjI5LCAyNDUsIDEpXCIsXHJcbiAgICAgICAgcm91dGVCb3JkZXJXaWR0aDogXCI0XCIsXHJcbiAgICAgICAgcG9pbnRzUmFkaXVzOiBcIjhcIixcclxuICAgICAgICBwb2ludHNCb3JkZXJXaWR0aDogXCIxXCIsXHJcbiAgICAgICAgY29udGVudFdpZHRoOiBcIjUwXCIsXHJcbiAgICAgICAgY29udGVudEFsaWduOiBcImZsZXgtc3RhcnRcIlxyXG4gICAgfTtcclxuXHJcbiAgICAgICAgaWYoU2V0dGluZ3NPYmplY3Rbc2V0dGluZ10pe1xyXG4gICAgICAgICAgICByZXR1cm4gU2V0dGluZ3NPYmplY3Rbc2V0dGluZ107XHJcbiAgICAgICAgfVxyXG5cclxuICAgIH1cclxuXHJcbiAgICB2YXIgZGF0YUNvbnRlbnQgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdQb2ludHNDb250ZW50JykpIHx8IFtdO1xyXG4gICAgdmFyIGNpcmNsZUNvbG9yID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbShcIlNhdmVkTWFwQ29sb3JzXCIpKSB8fCB7fTtcclxuXHJcbiAgICBmdW5jdGlvbiBpbldpbmRvdyhzKSB7IC8vIGNoZWNrIGlmIGVsZW1lbnQgaXMgdmlzaWJsZSBpbiBicm93c2VyIHdpbmRvd1xyXG4gICAgICAgIGlmICghJChzKS5sZW5ndGgpIHJldHVybiBmYWxzZTsgLy8gZWxlbWVudCBub3QgZm91bmRcclxuXHJcbiAgICAgICAgdmFyIGltZ190b3Bfb2Zmc2V0ID0gJChzKS5vZmZzZXQoKS50b3A7XHJcbiAgICAgICAgdmFyIGltZ19ib3R0b20gPSAkKHMpLm9mZnNldCgpLnRvcCArICQocykub3V0ZXJIZWlnaHQoKTtcclxuICAgICAgICB2YXIgYm90dG9tT2ZTY3JlZW4gPSAkKHdpbmRvdykuc2Nyb2xsVG9wKCkgKyAkKHdpbmRvdykuaGVpZ2h0KCk7XHJcbiAgICAgICAgdmFyIHRvcE9mU2NyZWVuID0gJCh3aW5kb3cpLnNjcm9sbFRvcCgpO1xyXG5cclxuICAgICAgICByZXR1cm4gKGJvdHRvbU9mU2NyZWVuID4gaW1nX3RvcF9vZmZzZXQpICYmICh0b3BPZlNjcmVlbiA8IGltZ19ib3R0b20pO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGNvbXBhcmVJZChvYmpBLCBvYmpCKSB7IC8vc29ydCBwb2ludHMgaWQgYnkgYXNjZW5kaW5nXHJcbiAgICAgICAgcmV0dXJuIG9iakEucG9pbnRJZCAtIG9iakIucG9pbnRJZDtcclxuICAgIH1cclxuXHJcbiAgICBpZihkYXRhQ29udGVudCl7XHJcbiAgICBkYXRhQ29udGVudC5zb3J0KGNvbXBhcmVJZCk7XHJcbiAgICB9XHJcblxyXG4gICAgdmFyIHRleHRfY29udCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYm9vbVwiKTtcclxuXHJcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGRhdGFDb250ZW50Lmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgdmFyIHNlY3Rpb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzZWN0aW9uJyk7ICAgIC8vIGNyZWF0aW9uIG9mIHBhZ2Ugc2VjdGlvbnMgd2l0aCBpdCdzIGNvbnRlbnQsIHRpZWQgdG8gZXZlcnkgcG9pbnRcclxuICAgICAgICAkKHNlY3Rpb24pLmFkZENsYXNzKCdqcy1zZWN0aW9uJyk7XHJcblxyXG4gICAgICAgXHJcbiAgICAgICAgJChzZWN0aW9uKS5hdHRyKHtcclxuICAgICAgICAgICAgXCJkYXRhLXpvb21cIjogZGF0YUNvbnRlbnRbaV0uem9vbSxcclxuICAgICAgICAgICAgXCJkYXRhLXBvcy10b3BcIjogZGF0YUNvbnRlbnRbaV0udG9wLCAgICAgICAgICAgXHJcbiAgICAgICAgICAgIFwiZGF0YS1wb3MtbGVmdFwiOiBkYXRhQ29udGVudFtpXS5sZWZ0LFxyXG4gICAgICAgICAgICBcImlkXCI6IFwic2VjdGlvbl9cIiArIChpKzEpXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgXHJcblxyXG4gICAgICAgIHNlY3Rpb24uaW5zZXJ0QWRqYWNlbnRIVE1MKCdiZWZvcmVlbmQnLCBkYXRhQ29udGVudFtpXS5kYXRhKTtcclxuICAgICAgICAkKHNlY3Rpb24pLmZpbmQoJ2ltZycpLmFkZENsYXNzKCdqcy1pbWFnZScpO1xyXG4gICAgICAgICQoc2VjdGlvbikuZmluZCgnLmpzLWltYWdlJykuYXR0cignZGF0YS1wb3MteCcsIDApO1xyXG4gICAgICAgICQoc2VjdGlvbikuZmluZCgnLmpzLWltYWdlJykuYXR0cignZGF0YS1wb3MteScsIDApO1xyXG4gICAgICAgIFxyXG5cclxuXHJcblxyXG4gICAgICAgIHRleHRfY29udC5hcHBlbmQoc2VjdGlvbik7XHJcbiAgICAgICAgJChcImRpdi50ZXh0X3dyYXBwZXJcIikuY3NzKFwiYWxpZ24taXRlbXNcIiwgZ2V0U2V0dGluZ0Zyb21TdG9yYWdlKFwiY29udGVudEFsaWduXCIpICk7XHJcbiAgICAgICAgICQoJy5qcy1zZWN0aW9uJykuY3NzKFwid2lkdGhcIiwgZ2V0U2V0dGluZ0Zyb21TdG9yYWdlKFwiY29udGVudFdpZHRoXCIpICsgXCIlXCIpO1xyXG4gICAgfVxyXG4gICAgZnVuY3Rpb24gaGFzU2xpZGVyQ2xhc3MoZWxlbSwgY2xhc3NOYW1lKSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBSZWdFeHAoJyAnICsgY2xhc3NOYW1lICsgJyAnKS50ZXN0KCcgJyArIGVsZW0uY2xhc3NOYW1lICsgJyAnKTtcclxuICAgIH1cclxuXHJcbiAgICB2YXIgc2xpZGVySW1nID0gJCgnLmpzLWltYWdlJyk7XHJcbiAgICAvLyBjb25zb2xlLmxvZyhzbGlkZXJJbWcpO1xyXG4gICAgLy8gZm9yKHZhciBpPTA7IGkgPCBzbGlkZXJJbWcubGVuZ3RoOyBpKyspe1xyXG4gICAgLy8gICAgIHZhciBzcmMgPSBzbGlkZXJJbWdbaV0uZ2V0QXR0cmlidXRlKCdzcmMnKTtcclxuICAgIC8vICAgICB2YXIgc2xpZGVySW1nU3JjID0gc3JjLnNsaWNlKC05KTtcclxuICAgIC8vICAgICB2YXIgc2luZ2xlSW1nU3JjID0gc3JjLnNsaWNlKC0xNSk7XHJcbiAgICAvLyAgICAgY29uc29sZS5sb2coc2luZ2xlSW1nU3JjKTtcclxuICAgIC8vICAgICBpZihzbGlkZXJJbWdTcmMgPT0gXCIvcHJldmlldy9cIiAmJiAhaGFzU2xpZGVyQ2xhc3Moc2xpZGVySW1nW2ldLCBcInNsaWNrLWl0ZW1cIikpe1xyXG4gICAgLy8gICAgICAgICBzbGlkZXJJbWdbaV0uY2xhc3NMaXN0LmFkZChcInNsaWNrLWl0ZW1cIik7XHJcbiAgICAvLyAgICAgfVxyXG4gICAgLy8gICAgIGlmKHNpbmdsZUltZ1NyYyA9PSBcIi9wcmV2aWV3L3NpbmdsZVwiICYmICFoYXNTbGlkZXJDbGFzcyhzbGlkZXJJbWdbaV0sIFwic2xpY2stc2luZ2xlXCIpKXtcclxuICAgIC8vICAgICAgICAgc2xpZGVySW1nW2ldLmNsYXNzTGlzdC5yZW1vdmUoXCJzbGljay1pdGVtXCIpXHJcbiAgICAvLyAgICAgICAgIHNsaWRlckltZ1tpXS5jbGFzc0xpc3QuYWRkKFwic2xpY2stc2luZ2xlXCIpO1xyXG4gICAgLy8gICAgIH1cclxuICAgIC8vIH1cclxuICAgIC8vIGNvbnNvbGUubG9nKHNsaWRlckltZyk7XHJcblxyXG4gICAgICAgICAgICAkLmZuLmhhc0F0dHIgPSBmdW5jdGlvbihuYW1lKSB7ICBcclxuICAgICAgICAgICByZXR1cm4gdGhpcy5hdHRyKG5hbWUpICE9PSB1bmRlZmluZWQ7XHJcbiAgICAgICAgfTtcclxuICAgIHZhciBzZWN0aW9ucyA9ICQoJy5qcy1zZWN0aW9uJyk7XHJcbiAgICBcclxuXHJcbiAgICAvLyB2YXIgc2xpZGVySXRlbSA9ICQoJy5zbGljay1zaW5nbGUnKTtcclxuXHJcbiAgICAvLyBpZihzbGlkZXJJdGVtICYmIHNsaWRlckl0ZW0ubGVuZ3RoID4gMCl7XHJcbiAgICAvLyAgICAgJC5lYWNoKHNsaWRlckl0ZW0sIGZ1bmN0aW9uKGksZWwpe1xyXG4gICAgICAgICAgICBcclxuXHJcbiAgICAvLyAgICAgLy8gaWYoJChlbCkuaGFzQXR0cignZGF0YS1pbWctYW1vdXQnKSAmJiAkKGVsKS5hdHRyKCdkYXRhLWltZy1hbW91dCcpID09IFwic2luZ2xlX2ltZ1wiKXtcclxuICAgIC8vICAgICAgICAgdmFyIHNsaWRlcldyYXAgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgIC8vICAgICAgICAgJChzbGlkZXJXcmFwKS5hZGRDbGFzcygnc2xpY2stY3VycmVudCcpO1xyXG4gICAgLy8gICAgICAgICAkKGVsKS53cmFwKCQoc2xpZGVyV3JhcCkpO1xyXG4gICAgLy8gICAgIC8vIH1cclxuXHJcblxyXG4gICAgLy8gICAgIH0pO1xyXG4gICAgLy8gfVxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG4gICAgJC5lYWNoKHNlY3Rpb25zLCBmdW5jdGlvbihpLGVsKXtcclxuXHJcbiAgICAvLyBpZigkKGVsKS5maW5kKCcuc2xpY2staXRlbScpLmxlbmd0aCAhPT0gMCl7XHJcbiAgICAvLyAgICAgY29uc29sZS5sb2coJChlbCkpO1xyXG4gICAgLy8gICAgIHZhciBzbGlja0l0ZW0gPSAgJChlbCkuZmluZCgnLnNsaWNrLWl0ZW0nKTtcclxuICAgIC8vICAgICAgICAgaWYoJChzbGlja0l0ZW0pLmhhc0F0dHIoJ2RhdGEtaW1nLWFtb3V0JykgJiYgJChzbGlja0l0ZW0pLmF0dHIoJ2RhdGEtaW1nLWFtb3V0JykgPT0gXCJzaW5nbGVfaW1nXCIpe1xyXG4gICAgLy8gICAgICAgICAgICAgdmFyIHNsaWRlcldyYXAgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgIC8vICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKFwia2VrXCIpO1xyXG4gICAgLy8gICAgICAgICAgICAgJChzbGlkZXJXcmFwKS5hZGRDbGFzcygnc2xpY2stY3VycmVudCcpO1xyXG4gICAgLy8gICAgICAgICAgICAgJChzbGlja0l0ZW0pLndyYXAoJChzbGlkZXJXcmFwKSk7XHJcbiAgICAvLyAgICAgICAgIH0gIFxyXG4gICAgICAgIFxyXG4gICAgLy8gICAgIGVsc2UgaWYoJChzbGlja0l0ZW0pLmF0dHIoJ2RhdGEtaW1nLWFtb3V0JykgPT0gXCJcIiB8fCAhJChzbGlja0l0ZW0pLmhhc0F0dHIoJ2RhdGEtaW1nLWFtb3V0Jykpe1xyXG5cclxuICAgIC8vICAgICAgICAgdmFyIHNsaWRlcldyYXAgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgIC8vICAgICAgICAgJChzbGlkZXJXcmFwKS5hZGRDbGFzcygnc2xpZGVyJyk7XHJcbiAgICAvLyAgICAgICAgICQoc2xpY2tJdGVtKS53cmFwQWxsKCQoc2xpZGVyV3JhcCkpO1xyXG4gICAgLy8gICAgIH1cclxuXHJcbiAgICAgICAgLy8gZWxzZXtcclxuICAgICAgICAvLyAgICAgdmFyIHNsaWRlcldyYXAgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgICAgICAvLyAgICAgJChzbGlkZXJXcmFwKS5hZGRDbGFzcygnc2xpY2stY3VycmVudCcpO1xyXG4gICAgICAgIC8vICAgICAkKHNsaWNrSXRlbSkud3JhcEFsbCgkKHNsaWRlcldyYXApKTsgICAgICAgICAgICBcclxuICAgICAgICAvLyB9XHJcblxyXG4gICAgICAgIC8vIGlmKCQoZWwpLmZpbmQoJy5zbGljay1nYWxsZXJ5JykubGVuZ3RoICE9PSAwKXtcclxuICAgICAgICAgICAgLy8gaWYoKCQoZWwpLmZpbmQoXCIuc2xpY2stZ2FsbGVyeVwiKSkubGVuZ3RoID4gMCl7XHJcbiAgICAgICAgICAgIC8vICAgICB2YXIgZmlyc3RDaGlsZHJlbiA9ICQoZWwgKyBcIj4gLnNsaWNrLWdhbGxlcnlcIik7XHJcbiAgICAgICAgICAgIC8vICAgICBjb25zb2xlLmxvZyhmaXJzdENoaWxkcmVuKTtcclxuICAgICAgICAgICAgLy8gfVxyXG4gICAgICAgICAgICB2YXIgc2xpZGVyID0gJChlbCkuZmluZCgnLnNsaWNrLWdhbGxlcnknKTtcclxuICAgICAgICAgICAgaWYoJChzbGlkZXIpLmZpbmQoXCJpbWcuc2xpY2staXRlbVwiKS5sZW5ndGggPT0gMCl7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygkKHNsaWRlcikpO1xyXG4gICAgICAgICAgICAgICAgJChzbGlkZXIpLnJlbW92ZSgpO1xyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKHNsaWRlcik7XHJcbiAgICAgICAgICAgIHZhciBzaW5nbGVJbWFnZSA9ICQoZWwpLmZpbmQoXCIuc2luZ2xlX2ltYWdlXCIpO1xyXG4gICAgICAgICAgICBpZighJChzaW5nbGVJbWFnZSkuaGFzQ2xhc3MoXCIuc2xpY2stY3VycmVudFwiKSl7XHJcbiAgICAgICAgICAgICAgICAkKHNpbmdsZUltYWdlKS5hZGRDbGFzcyhcInNsaWNrLWN1cnJlbnRcIik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAvLyB9XHJcblxyXG4gICAgICAgIC8vICQoXCIuc2xpZGVyXCIpLmNzcyhcIndpZHRoXCIsIDEwMCArIFwiJVwiKTtcclxuICAgICAgICAkKHNsaWRlcikuZmluZCgnYnInKS5yZW1vdmUoKTtcclxuICAgICAgICAvLyBpZigkKFwiLnNsaWRlclwiKS5wYXJlbnQoKS5pcyhcInBcIikpe1xyXG4gICAgICAgIC8vICAgICAkKFwiLnNsaWRlclwiKS51bndyYXAoKTtcclxuICAgICAgICAvLyB9XHJcbiAgICAvLyB9XHJcbiQoJ2JyJykucmVtb3ZlKCk7XHJcbiAgICAkKHNsaWRlcikudGV4dCgpLnJlcGxhY2UoLyZuYnNwOy9nLCAnJyk7XHJcbn0pO1xyXG5cclxuXHJcbi8vICQoXCIuanMtc2VjdGlvbiBkaXZcIikuZWFjaChmdW5jdGlvbihpbmRleCwgZWxlbWVudCl7XHJcbi8vICAgICBpZigkKGVsZW1lbnQpLmhhc0NsYXNzKFwiLnNsaWNrLWdhbGxlcnlcIikpe1xyXG4vLyAgICAgICAgIGNvbnNvbGUubG9nKCQoZWxlbWVudCkpO1xyXG4vLyAgICAgfVxyXG4vLyB9KTtcclxuXHJcblxyXG5cclxuICAgICAgJCgnLnNsaWNrX2dhbGxlcnknKS5zbGljayh7XHJcbiAgICAgICBcInNsaWRlc1RvU2hvd1wiOiAxLFxyXG4gICAgICAgXCJzbGlkZXNUb1Njcm9sbFwiOiAxLFxyXG4gICAgICAgIC8vIGF1dG9wbGF5OiB0cnVlLFxyXG4gICAgICAgIC8vIGF1dG9wbGF5U3BlZWQ6IDIwMDAsXHJcbiAgICAgICAgcHJldkFycm93OiB0cnVlLFxyXG4gICAgICAgIG5leHRBcnJvdzogdHJ1ZSxcclxuICAgICAgICAvLyBmYWRlOiB0cnVlLFxyXG4gICAgICAgIC8vIGRvdHM6IHRydWVcclxuICAgICAgfSk7XHJcblxyXG5cclxuXHJcbiAgICAvLyAkKCcubWFwYmcnKS5jc3MoXCJ6b29tXCIsIFwiMCVcIik7XHJcbiAgICAvLyAkKCcubWFwYmcnKS5jc3MoXCJyaWdodFwiLCBcIjBcIik7XHJcbiAgICAvLyAkKCdtYXBiZycpLmNzcyhcImJvdHRvbVwiLCBcIjBcIik7XHJcbiAgICB2YXIgYSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYXAnKTtcclxuXHJcbiAgICB2YXIgbWFwX3VybCA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oJ21hcCcpKTtcclxuICAgIHZhciBtYXBfdXJsX3RydWUgPSBtYXBfdXJsO1xyXG4gICAgLy8gY29uc29sZS5sb2cobWFwX3VybF90cnVlKTtcclxuXHJcbiAgICAkKCcjbWFwJykuYXR0cignZGF0YScsIG1hcF91cmxfdHJ1ZSk7IFxyXG5cclxuICAgIGEuYWRkRXZlbnRMaXN0ZW5lcihcImxvYWRcIiwgZnVuY3Rpb24oKSB7IC8vbG9hZGluZyBtYXAgdXJsIGZyb20gbG9jYWxzdG9yYWdlXHJcblxyXG4gICAgICAgIC8vIGNvbnNvbGUubG9nKCQoXCIjbWFwXCIpLmF0dHIoJ2RhdGEnKSk7XHJcbiAgICAgICAgdmFyIHN2Z0RvYyA9IGEuY29udGVudERvY3VtZW50O1xyXG4gICAgICAgIHZhciBzdmdSb290ID0gc3ZnRG9jLmRvY3VtZW50RWxlbWVudDsgIC8vZ2V0dGluZyBpbnRvIG9iamVjdCBET01cclxuICAgICAgICBzdmdSb290LnNldEF0dHJpYnV0ZShcInhcIiwgXCI1MjBweFwiKTtcclxuICAgICAgICBzdmdSb290LnNldEF0dHJpYnV0ZShcInlcIiwgXCIzMDBweFwiKTtcclxuICAgICAgICB2YXIgTWFwUGF0aHNHcm91cCA9IHN2Z1Jvb3QuZ2V0RWxlbWVudEJ5SWQoXCJtYXBQYXRoc1wiKTtcclxuICAgICAgICB2YXIgUGF0aHNBcnJheSA9IE1hcFBhdGhzR3JvdXAuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ3BhdGgnKTtcclxuICAgICAgICB2YXIgd2hvbGVTdmdHcm91cCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnLCAnZycpO1xyXG4gICAgICAgIHdob2xlU3ZnR3JvdXAuYXBwZW5kKE1hcFBhdGhzR3JvdXApO1xyXG4gICAgICAgICQod2hvbGVTdmdHcm91cCkuYXR0cihcImlkXCIsIFwid2hvbGVTdmdHcm91cFwiKTtcclxuICAgICAgICB2YXIgRnVsbE1hcEdyb3VwID0gU25hcCh3aG9sZVN2Z0dyb3VwKTtcclxuICAgICAgICB2YXIgV3JhcHBlclByb3BzID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnbWFwU3R5bGVQcm9wZXJ0aWVzJykpIHx8IHsgdHJhbnNmb3JtOiBcIlwifTtcclxuICAgICAgICB2YXIgcGF0aERpc3BsYWNlbWVudCA9IFNuYXAocGF0aEdyb3VwKTtcclxuICAgICAgICAgICAgIGlmKChXcmFwcGVyUHJvcHMudHJhbnNmb3JtKS5sZW5ndGggPiAwKXtcclxuICAgICAgICAgICAgICAgIC8vIHNjYWxlSW1nID0gc3R5bGVQcm9wcy50cmFuc2Zvcm07XHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIHRyYW5zZm9ybVN0cmluZyA9IChXcmFwcGVyUHJvcHMudHJhbnNmb3JtKTtcclxuICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKHNjYWxlSW1nKTtcclxuICAgICAgICAgICAgICAgIHZhciByZWdleCA9IC9bKy1dP1xcZCsoXFwuXFxkKyk/L2c7XHJcbiAgICAgICAgICAgICAgICB2YXIgU3RyaW5nVmFsdWVzID0gdHJhbnNmb3JtU3RyaW5nLm1hdGNoKHJlZ2V4KS5tYXAoZnVuY3Rpb24odikge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBwYXJzZUZsb2F0KHYpOyBcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coU3RyaW5nVmFsdWVzKTtcclxuXHJcbiAgICAgICAgICAgICAgICBzY2FsZUltZyA9IFN0cmluZ1ZhbHVlc1swXTtcclxuICAgICAgICAgICAgICAgIG1vdmVMZWZ0ID0gU3RyaW5nVmFsdWVzWzFdLFxyXG4gICAgICAgICAgICAgICAgbW92ZVRvcCA9IFN0cmluZ1ZhbHVlc1syXTtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCBzY2FsZUltZywgbW92ZUxlZnQsIG1vdmVUb3ApO1xyXG5cclxuICAgICAgICAgICAgICAgIEZ1bGxNYXBHcm91cC5hdHRyKFwidHJhbnNmb3JtXCIsIFwic2NhbGUoXCIgKyBzY2FsZUltZyArIFwiKSB0cmFuc2xhdGUoXCIrIG1vdmVMZWZ0ICtcIiBcIiArIG1vdmVUb3ArIFwiKVwiKTtcclxuICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIH0gICAgICAgXHJcblxyXG5cclxuICAgICAgICBmb3IodmFyIGkgPSAwOyBpIDwgUGF0aHNBcnJheS5sZW5ndGg7IGkrKyl7ICAgICAgICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBQYXRoc0FycmF5W2ldLnN0eWxlLmZpbGwgPSBnZXRTZXR0aW5nRnJvbVN0b3JhZ2UoXCJtYXBDb2xvclwiKTsgICAgICAgLy9jb2xvcmluZyBtYXAgYW5kIG1hcCBzdHJva2UgZnJvbSBzZXR0aW5nc1xyXG4gICAgICAgICAgICBQYXRoc0FycmF5W2ldLnN0eWxlLnN0cm9rZSA9IGdldFNldHRpbmdGcm9tU3RvcmFnZShcIm1hcFN0cm9rZUNvbG9yXCIpO1xyXG4gICAgICAgIH1cclxuXHJcblxyXG4gICAgICAgIHZhciBQYXRoRGlyZWN0aW9uID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgncGF0aCcpKTsgICAvLyBnZXQgIGRpcmVjdGlvbiBvZiBtYWluIHJvdXRlXHJcblxyXG5cclxuXHJcblxyXG4gICAgICAgIC8vIGNvbnNvbGUubG9nKHN2Z1Jvb3QpO1xyXG4gICAgICAgICQoc3ZnUm9vdCkuYWRkQ2xhc3MoXCJteS1zdmdcIik7XHJcblxyXG4gICAgICAgIGlmIChQYXRoRGlyZWN0aW9uKSB7ICAgLy8gbWFpbiByb3V0ZSBzdHlsaW5nXHJcbiAgICAgICAgICAgIHZhciBwYXRoID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycsICdwYXRoJyk7XHJcblxyXG4gICAgICAgICAgICAkKHBhdGgpLmF0dHIoJ2QnLCBQYXRoRGlyZWN0aW9uKTtcclxuICAgICAgICAgICAgJChwYXRoKS5hdHRyKCdmaWxsJywgJ3RyYW5zcGFyZW50Jyk7XHJcbiAgICAgICAgICAgICQocGF0aCkuYXR0cignc3Ryb2tlJywgZ2V0U2V0dGluZ0Zyb21TdG9yYWdlKFwibWFwUm91dGVDb2xvclwiKSk7XHJcbiAgICAgICAgICAgICQocGF0aCkuYXR0cihcIm9wYWNpdHlcIiwgJzAuOCcpO1xyXG4gICAgICAgICAgICAkKHBhdGgpLmF0dHIoJ3N0cm9rZS13aWR0aCcsIGdldFNldHRpbmdGcm9tU3RvcmFnZShcInJvdXRlQm9yZGVyV2lkdGhcIikpO1xyXG4gICAgICAgICAgICAkKHBhdGgpLmF0dHIoXCJzdHJva2UtbGluZWNhcFwiLFwicm91bmRcIilcclxuICAgICAgICAgICAgJChwYXRoKS5hdHRyKFwiaWRcIiwgXCJyb3V0ZVBhdGhcIik7XHJcblxyXG4gICAgICAgIH1cclxuXHJcblxyXG5cclxuICAgICAgICB2YXIgY3VycmVudERpc3BsYWNlbWVudFRvcCA9IHBhcnNlSW50KCQoXCIjSURtYXBiZ1wiKVswXS5zdHlsZS50b3ApOyAgLy8gbWFwIG9mZnNldCBzZXQgdXAgYnkgdXNlciBvbiAxc3Qgc3RlcFxyXG4gICAgICAgIHZhciBjdXJyZW50RGlzcGxhY2VtZW50TGVmdCA9IHBhcnNlSW50KCQoJyNJRG1hcGJnJylbMF0uc3R5bGUubGVmdCk7XHJcbiAgICAgICAgdmFyIHBhdGgxID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycsICdwYXRoJyk7XHJcbiAgICAgICAgJChwYXRoMSkuY3NzKCdkaXNwbGF5JywgJ25vbmUnKTtcclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuICAgICAgICAgICAgdmFyIGFyckltZ0lEID0gW107IC8vYXJyYXkgb2YgcGFnZSBpbWcgZWxlbWVudHNcclxuICAgICAgICAgICAgLy8gJCgnLmpzLWltYWdlJykuZWFjaChmdW5jdGlvbihpLGVsKXtcclxuICAgICAgICAgICAgLy8gICAgIGlmKCEkKGVsKS5oYXNDbGFzcygnLnNsaWNrLWl0ZW0nKSl7XHJcbiAgICAgICAgICAgIC8vICAgICAgICAgYXJySW1nSUQucHVzaCgkKGVsKSk7XHJcbiAgICAgICAgICAgIC8vICAgICB9XHJcbiAgICAgICAgICAgIC8vIH0pO1xyXG5cclxuICAgICAgICAgICAgJCgnLmxpZ2h0T24nKS5lYWNoKGZ1bmN0aW9uKGVsKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgYXJySW1nSUQucHVzaCgkKHRoaXMpKTtcclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICB9KTtcclxuLy8gY29uc29sZS5sb2coYXJySW1nSUQpO1xyXG5cclxuICAgICAgICAgICAgdmFyIENpcmNsZVBhdGhDb29yZHMgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdjaXJjbGVzQ29vcmRzJykpO1xyXG5cclxuICAgICAgICAgICAgJChhcnJJbWdJRCkuZWFjaChmdW5jdGlvbihpLCBlbCkgeyAvL2dldCBjb29yZGluYXRlcyBvZiBwb2ludCB3aGljaCBpcyB0aWVkIHdpdGggY3VycmVudCBpbWdcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgaW1nUGFyZW50SUQgPSAkKGVsKS5jbG9zZXN0KCdzZWN0aW9uJylbMF0uaWQ7XHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIGltZ1BhcmVudElEID0gcGFyc2VJbnQoaW1nUGFyZW50SURbOF0pIC0gMTtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGkpO1xyXG4gICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coKENpcmNsZVBhdGhDb29yZHNbaV0uaWQtMSkpO1xyXG4gICAgICAgICAgICAgICAgaWYgKGltZ1BhcmVudElEID09IChDaXJjbGVQYXRoQ29vcmRzW2ltZ1BhcmVudElEXS5pZC0xKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKGltZ1BhcmVudElEKTtcclxuICAgICAgICAgICAgICAgICAgICAkKGVsKS5hdHRyKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJ2RhdGEtcG9zLXgnOiBDaXJjbGVQYXRoQ29vcmRzW2ltZ1BhcmVudElEXS5jeCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgJ2RhdGEtcG9zLXknOiBDaXJjbGVQYXRoQ29vcmRzW2ltZ1BhcmVudElEXS5jeVxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcblxyXG5cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gc2VjdGlvbkNvdW50ZXIoKSB7XHJcbiAgICAgICAgICAgICQoJy5qcy1zZWN0aW9uJykuZWFjaChmdW5jdGlvbihpKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIHNjcm9sbENvdW50ID0gJCh3aW5kb3cpLnNjcm9sbFRvcCgpO1xyXG4gICAgICAgICAgICAgICAgdmFyIHRvcE9mZnNldCA9ICQodGhpcykub2Zmc2V0KCkudG9wO1xyXG4gICAgICAgICAgICAgICAgdmFyIGRhdGFab29tID0gJCh0aGlzKS5hdHRyKFwiZGF0YS16b29tXCIpO1xyXG4gICAgICAgICAgICAgICAgdmFyIGRhdGFQb3NUb3AgPSBwYXJzZUludCgkKHRoaXMpLmF0dHIoXCJkYXRhLXBvcy10b3BcIikpO1xyXG4gICAgICAgICAgICAgICAgdmFyIGRhdGFQb3NCb3R0b20gPSAkKHRoaXMpLmF0dHIoJ2RhdGEtcG9zLWJvdHRvbScpO1xyXG4gICAgICAgICAgICAgICAgdmFyIGRhdGFQb3NMZWZ0ID0gcGFyc2VJbnQoJCh0aGlzKS5hdHRyKFwiZGF0YS1wb3MtbGVmdFwiKSk7XHJcbiAgICAgICAgICAgICAgICB2YXIgZGF0YVBvc1JpZ2h0ID0gJCh0aGlzKS5hdHRyKFwiZGF0YS1wb3MtcmlnaHRcIik7XHJcblxyXG5cclxuXHJcbiAgICAgICAgICAgICAgICBpZiAodG9wT2Zmc2V0IDw9IHNjcm9sbENvdW50ICYmIGluV2luZG93KCQodGhpcykpKSB7IC8vQWRkIGNsYXNzIFwiYWN0aXZlXCIgaWYgY3VycmVudCBzZWN0aW9uIGlzIGluV2luZG93XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICQodGhpcykuYWRkQ2xhc3MoXCJhY3RpdmVcIik7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIEZ1bGxNYXBHcm91cC5hbmltYXRlKHsgLy9hbmltYXRlIG1hcCB6b29tIGFuZCBvZmZzZXQsIHNldCB1cCBieSB1c2VyIG9uIDJuZCBzdGVwLCBkdWUgdG8gY3VycmVudCBzZWN0aW9uICBcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNmb3JtOiBcInNjYWxlKFwiICsgZGF0YVpvb20gK1wiKSB0cmFuc2xhdGUoXCIgKyAoZGF0YVBvc0xlZnQpICsgXCIgXCIgKyBkYXRhUG9zVG9wICsgXCIpXCJcclxuICAgICAgICAgICAgICAgICAgICB9LCA3MDApO1xyXG5cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2V7XHJcbiAgICAgICAgICAgICAgICAgICAgJCh0aGlzKS5yZW1vdmVDbGFzcyhcImFjdGl2ZVwiKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoISQoJy5qcy1zZWN0aW9uJykuaGFzQ2xhc3MoXCJhY3RpdmVcIikgJiYgJCh3aW5kb3cpLnNjcm9sbFRvcCgpIDwgMjApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgRnVsbE1hcEdyb3VwLmFuaW1hdGUoeyAvL2FuaW1hdGUgbWFwIHpvb20gYW5kIG9mZnNldCwgc2V0IHVwIGJ5IHVzZXIgb24gMm5kIHN0ZXAsIGR1ZSB0byBjdXJyZW50IHNlY3Rpb24gIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNmb3JtOiBcInNjYWxlKFwiICsgc2NhbGVJbWcgK1wiKSB0cmFuc2xhdGUoXCIgKyAobW92ZUxlZnQpICsgXCIgXCIgKyAobW92ZVRvcCkgKyBcIilcIiAgLy8vQ0hBTkdFXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIDcwMCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gc3ZnUG9pbnQoZWxlbWVudCwgeCwgeSkge1xyXG4gICAgICAgICAgdmFyIHB0ID0gc3ZnUm9vdC5jcmVhdGVTVkdQb2ludCgpO1xyXG5cclxuICAgICAgICAgIHB0LnggPSB4O1xyXG4gICAgICAgICAgcHQueSA9IHk7XHJcblxyXG4gICAgICAgICAgcmV0dXJuIHB0Lm1hdHJpeFRyYW5zZm9ybShlbGVtZW50LmdldFNjcmVlbkNUTSgpLmludmVyc2UoKSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdmFyIHZpc19jb3VudCA9IDA7XHJcblxyXG5cclxuICAgICAgICAgICAgJChhcnJJbWdJRCkuZWFjaChmdW5jdGlvbigpIHsgIC8vaWYgY3VycmVudCBpbWcgaW5XaW5kb3csIHRoYW4gY3JlYXRlIGEgbGlnaHQgZnJvbSBjdXJyZW50IHBvaW50IHRvIGltZydzIGJvcmRlclxyXG4gICAgICAgICAgICAgICAgaWYgKGluV2luZG93KCQodGhpcykpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coJCh0aGlzKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgdmlzX2NvdW50Kys7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHZhciBjeCA9ICQodGhpcykuYXR0cignZGF0YS1wb3MteCcpO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBjeSA9ICQodGhpcykuYXR0cignZGF0YS1wb3MteScpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB2YXIgY3VycmVudFNlY3Rpb24gPSB0aGlzLmNsb3Nlc3QoXCJzZWN0aW9uXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBjdXJyZW50Wm9vbSA9ICQoY3VycmVudFNlY3Rpb24pLmF0dHIoXCJkYXRhLXpvb21cIik7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGN1cnJlbnRUb3BPZmZzZXQgPSAkKGN1cnJlbnRTZWN0aW9uKS5hdHRyKFwiZGF0YS1wb3MtdG9wXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBjdXJyZW50TGVmdE9mZnNldCA9ICQoY3VycmVudFNlY3Rpb24pLmF0dHIoXCJkYXRhLXBvcy1sZWZ0XCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKGN1cnJlbnRab29tKTtcclxuXHJcblxyXG5cclxuXHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHZhciBDb29yZGluYXRlcyA9ICQodGhpcylbMF0uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGJvdHRvbU9mZnNldEltZyA9IENvb3JkaW5hdGVzLnRvcCArICQodGhpcykuaGVpZ2h0KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coQ29vcmRpbmF0ZXMpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB2YXIgcmlnaHRfdG9wX1ggPSAtKCtDb29yZGluYXRlcy5sZWZ0ICsgK0Nvb3JkaW5hdGVzLndpZHRoKSAvIDE5MjAqMTQwMDtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgcmlnaHRfdG9wX1kgPSAoK0Nvb3JkaW5hdGVzLnRvcCAvIDEyMDAqOTAwKTtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgcmlnaHRfYm90dG9tX1ggPSAtKCtDb29yZGluYXRlcy5sZWZ0ICsgK0Nvb3JkaW5hdGVzLndpZHRoKSAvIDE5MjAqMTQwMDtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgcmlnaHRfYm90dG9tX1kgPSAoQ29vcmRpbmF0ZXMuYm90dG9tKSAvIDEyMDAqOTAwO1xyXG5cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHN2Z19yaWdodF90b3AgPSBzdmdQb2ludChzdmdSb290LCByaWdodF90b3BfWCwgcmlnaHRfdG9wX1kpO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBzdmdfcmlnaHRfYm90dG9tID0gc3ZnUG9pbnQoc3ZnUm9vdCwgcmlnaHRfYm90dG9tX1gsIHJpZ2h0X2JvdHRvbV9ZKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGdyb3VwX3JpZ2h0X3RvcCA9IHN2Z1BvaW50KHdob2xlU3ZnR3JvdXAsIHJpZ2h0X3RvcF9YLCByaWdodF90b3BfWSk7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGdyb3VwX3JpZ2h0X2JvdHRvbSA9IHN2Z1BvaW50KHdob2xlU3ZnR3JvdXAsIHJpZ2h0X2JvdHRvbV9YLCByaWdodF9ib3R0b21fWSk7XHJcblxyXG5cclxuICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhzdmdQb2ludChzdmdSb290LCBDb29yZGluYXRlcy54LCBDb29yZGluYXRlcy55KSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKHN2Z1BvaW50KHdob2xlU3ZnR3JvdXAsIHJpZ2h0X3RvcF9YLCByaWdodF90b3BfWSkpO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKFwiUEFHRSBDT09SRFMgXCIgKyByaWdodF90b3BfWCArICBcIiwgXCIgKyByaWdodF90b3BfWSk7XHJcblxyXG5cclxuICAgICAgICAgICAgICAgICAgICAvLyAkKHBhdGgxKS5hdHRyKCdkJywgXCJNXCIgKyBjeCArIFwiIFwiICsgY3kgKyBcIiBMXCIgKyAoLXN2Z19yaWdodF90b3AueCAtIHJpZ2h0X3RvcF9YICkgICsgXCIgXCIgKyAocmlnaHRfdG9wX1kpICsgXCIgTFwiICsgKC1zdmdfcmlnaHRfYm90dG9tLnggLSByaWdodF9ib3R0b21fWCApICsgXCIgXCIgKyAocmlnaHRfYm90dG9tX1kgLSBjdXJyZW50VG9wT2Zmc2V0ICkgKyBcIiBaXCIpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAkKHBhdGgxKS5jc3MoJ3Bvc2l0aW9uJywgXCJyZWxhdGl2ZVwiKTtcclxuICAgICAgICAgICAgICAgICAgICBpZihnZXRTZXR0aW5nRnJvbVN0b3JhZ2UoXCJjb250ZW50QWxpZ25cIikgPT0gXCJmbGV4LXN0YXJ0XCIpe1xyXG4gICAgICAgICAgICAgICAgICAgICQocGF0aDEpLmF0dHIoJ2QnLCBcIk1cIiArIGN4ICsgXCIgXCIgKyBjeSArIFwiIExcIiArIChzdmdfcmlnaHRfdG9wLnggLSByaWdodF90b3BfWCApICArIFwiIFwiICsgKHJpZ2h0X3RvcF9ZKSArIFwiIExcIiArIChzdmdfcmlnaHRfYm90dG9tLnggLSByaWdodF9ib3R0b21fWCApICsgXCIgXCIgKyAocmlnaHRfYm90dG9tX1kgLSBjdXJyZW50VG9wT2Zmc2V0ICkgKyBcIiBaXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICQocGF0aDEpLmF0dHIoJ2ZpbGwnLCAndXJsKCNncmFkaWVudCknKTsgIC8vNDdEQkI0XHJcbiAgICAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIH1lbHNlIGlmKGdldFNldHRpbmdGcm9tU3RvcmFnZShcImNvbnRlbnRBbGlnblwiKSA9PSBcImZsZXgtZW5kXCIpe1xyXG4gICAgICAgICAgICAgICAgICAgICQocGF0aDEpLmF0dHIoJ2ZpbGwnLCAndXJsKCNncmFkaWVudF9yZXZlcnNlKScpOyAgLy80N0RCQjRcclxuICAgICAgICAgICAgICAgICAgICAkKHBhdGgxKS5hdHRyKCdkJywgXCJNXCIgKyBjeCArIFwiIFwiICsgY3kgKyBcIiBMXCIgKyAoLXN2Z19yaWdodF90b3AueCAtIHJpZ2h0X3RvcF9YICkgICsgXCIgXCIgKyAocmlnaHRfdG9wX1kpICsgXCIgTFwiICsgKC1zdmdfcmlnaHRfYm90dG9tLnggLSByaWdodF9ib3R0b21fWCApICsgXCIgXCIgKyAocmlnaHRfYm90dG9tX1kgLSBjdXJyZW50VG9wT2Zmc2V0ICkgKyBcIiBaXCIpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIC8vICQocGF0aDEpLmF0dHIoJ3N0cm9rZScsICcjMDAwMDAwJyk7IFxyXG4gICAgICAgICAgICAgICAgICAgICQocGF0aDEpLmF0dHIoJ29wYWNpdHknLCAnLjMnKTtcclxuICAgICAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgICAgICAvLyAkKHBhdGgxKS5hdHRyKFwidHJhbnNmb3JtXCIsIFwic2NhbGUoXCIgKyAxICsgXCIpIHRyYW5zbGF0ZShcIisgY3VycmVudExlZnRPZmZzZXQgK1wiIFwiICsgY3VycmVudFRvcE9mZnNldCsgXCIpXCIpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICQod2hvbGVTdmdHcm91cCkucHJlcGVuZChwYXRoMSk7XHJcbiAgICAgICAgICAgIHN2Z1Jvb3QuYXBwZW5kKHdob2xlU3ZnR3JvdXApO1xyXG5cclxuICAgICAgICAgICAgaWYgKHZpc19jb3VudCA+IDApIHtcclxuICAgICAgICAgICAgICAgICQocGF0aDEpLmZhZGVJbig5MDApO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgJChwYXRoMSkuZmFkZU91dCg5MDApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBTbmFwLnBsdWdpbihmdW5jdGlvbihTbmFwLCBFbGVtZW50LCBQYXBlciwgZ2xvYmFsKSB7IC8vIGNyZWF0ZSBjaXJjbGVzIGJ5IHBhdGggZWxlbWVudHMgaW4gc3ZnXHJcbiAgICAgICAgICAgIFBhcGVyLnByb3RvdHlwZS5jaXJjbGVQYXRoID0gZnVuY3Rpb24oY3gsIGN5LCByKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgcCA9IFwiTVwiICsgY3ggKyBcIixcIiArIGN5O1xyXG4gICAgICAgICAgICAgICAgcCArPSBcIm1cIiArIC1yICsgXCIsMFwiO1xyXG4gICAgICAgICAgICAgICAgcCArPSBcImFcIiArIHIgKyBcIixcIiArIHIgKyBcIiAwIDEsMCBcIiArIChyICogMikgKyBcIiwwXCI7XHJcbiAgICAgICAgICAgICAgICBwICs9IFwiYVwiICsgciArIFwiLFwiICsgciArIFwiIDAgMSwwIFwiICsgLShyICogMikgKyBcIiwwXCI7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5wYXRoKHAsIGN4LCBjeSk7XHJcblxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICB2YXIgcGF0aEdyb3VwID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycsICdnJyk7XHJcbiAgICAgICAgcGF0aEdyb3VwLmlkID0gXCJwYXRoR3JvdXBcIjtcclxuICAgICAgICBwYXRoR3JvdXAuYXBwZW5kKHBhdGgpOyAgICAgLy9ncm91cCBwYXRoc1xyXG5cclxuICAgICAgICAkKHdob2xlU3ZnR3JvdXApLmFwcGVuZChwYXRoR3JvdXApO1xyXG4gICAgICAgIHN2Z1Jvb3QuYXBwZW5kKHdob2xlU3ZnR3JvdXApO1xyXG4gICAgICAgIHZhciBzID0gU25hcChwYXRoR3JvdXApO1xyXG4gICAgICAgIC8vIHMuYXR0cihcInRyYW5zZm9ybVwiLCBcInNjYWxlKFwiICsgc2NhbGVJbWcgKyBcIikgdHJhbnNsYXRlKFwiKyAoLW1vdmVMZWZ0KSArXCIgXCIgKyAoLW1vdmVUb3ApKyBcIilcIik7XHJcbiAgICAgICAgZnVuY3Rpb24gY2xpY2tDaXJjbGUoZSl7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGUub2Zmc2V0WCwgZS5vZmZzZXRZKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBjaXJjbGVzQXJyYXkgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdjaXJjbGVzQ29vcmRzJykpO1xyXG5cclxuICAgICAgICAkLmVhY2goY2lyY2xlc0FycmF5LCBmdW5jdGlvbihpbmRleCwgZWwpIHtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHZhciBjaXJjbGUgPSBzLmNpcmNsZVBhdGgodGhpcy5jeCwgdGhpcy5jeSwgdGhpcy5yKS5hdHRyKHsgLy9zZXQgcG9pbnRzIGF0dHJpYnV0ZXMgYW5kIHN0eWxlcyBmcm9tIHBhZ2Ugc2V0dGluZ3NcclxuICAgICAgICAgICAgICAgIGZpbGw6IGdldFNldHRpbmdGcm9tU3RvcmFnZShcIm1hcFBvaW50c0NvbG9yXCIpLFxyXG4gICAgICAgICAgICAgICAgc3Ryb2tlOiBnZXRTZXR0aW5nRnJvbVN0b3JhZ2UoXCJtYXBQb2ludHNCb3JkZXJDb2xvclwiKSxcclxuICAgICAgICAgICAgICAgIFwic3Ryb2tlLXdpZHRoXCI6IGdldFNldHRpbmdGcm9tU3RvcmFnZShcInBvaW50c0JvcmRlcldpZHRoXCIpLFxyXG4gICAgICAgICAgICAgICAgaWQ6IGluZGV4KzEsXHJcbiAgICAgICAgICAgICAgICBjbGFzczogXCJjaXJjbGVFbGVtZW50XCIsXHJcbiAgICAgICAgICAgICAgICBzdHlsZTogXCJkaXNwbGF5Om5vbmVcIixcclxuICAgICAgICAgICAgICAgIG9uY2xpY2s6IFwiY2xpY2tDaXJjbGUoKVwiXHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuXHJcbiAgICAgICAgICAgICAgICAgXHJcblxyXG4gICAgICAgICAgICB2YXIgaW50ZXJzZWN0cyA9IFNuYXAucGF0aC5pbnRlcnNlY3Rpb24oY2lyY2xlLCAkKHBhdGgpLmF0dHIoJ2QnKSk7IC8vZHJhdyBjaXJjbGVzIGFuZCBtYWluIHJvdXRlIGludGVyc2VjdGlvbnNcclxuXHJcbiAgICAgICAgICAgIGludGVyc2VjdHMuZm9yRWFjaChmdW5jdGlvbihlbCkge1xyXG5cclxuICAgICAgICAgICAgICAgIHMuY2lyY2xlKGVsLngsIGVsLnksIDEpO1xyXG5cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIFxyXG5cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgdmFyIFBhcmVudENpY2xlR3JvdXAgPSBzdmdSb290LmdldEVsZW1lbnRCeUlkKFwicGF0aEdyb3VwXCIpO1xyXG4gICAgICAgIC8vIGNvbnNvbGUubG9nKFBhcmVudENpY2xlR3JvdXApO1xyXG4gICAgICAgIGZvcih2YXIgaT0wOyBpIDwgY2lyY2xlc0FycmF5Lmxlbmd0aDsgaSsrKXtcclxuICAgICAgICAgICAgdmFyIGNpcmNsZUdyb3VwID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycsICdnJyk7XHJcbiAgICAgICAgICAgIHZhciBjdXJyZW50UG9pbnQgPSBzdmdSb290LmdldEVsZW1lbnRCeUlkKGkrMSk7XHJcblxyXG4gICAgICAgICAgICBjaXJjbGVHcm91cC5hcHBlbmQoY3VycmVudFBvaW50KTtcclxuXHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICB2YXIgdGV4dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnLCAndGV4dCcpO1xyXG4gICAgICAgICAgICAkKHRleHQpLmF0dHIoeyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vbmFtZSBvZiBwb2ludFxyXG4gICAgICAgICAgICAgICAgeDogY2lyY2xlc0FycmF5W2ldLmN4LFxyXG4gICAgICAgICAgICAgICAgeTogY2lyY2xlc0FycmF5W2ldLmN5ICsgMjAsXHJcbiAgICAgICAgICAgICAgICBcImZvbnQtc2l6ZVwiOiAxMixcclxuICAgICAgICAgICAgICAgIFwiZm9udC1zdHlsZVwiOiBcIml0YWxpY1wiLFxyXG4gICAgICAgICAgICAgICAgZmlsbDogXCIjY2NjY2NjY1wiLFxyXG4gICAgICAgICAgICAgICAgXCJzdHlsZVwiOiBcImRpc3BsYXk6IG5vbmVcIixcclxuICAgICAgICAgICAgICAgIGNsYXNzOiBcImNpdHlOYW1lXCJcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICQodGV4dCkudGV4dChkYXRhQ29udGVudFtpXS5jaXR5TmFtZSk7XHJcbiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKHRleHQpO1xyXG4gICAgICAgICAgICBjaXJjbGVHcm91cC5hcHBlbmQodGV4dCk7XHJcbiAgICAgICAgICAgXHJcbiAgICAgICAgICAgIFBhcmVudENpY2xlR3JvdXAuYXBwZW5kKGNpcmNsZUdyb3VwKTsgICAvL2dyb3VwIGNpcmNsZXMgZWxlbWVudHMgd2l0aCB0aGVpciBuYW1lcyh0ZXh0IGVsZW1lbnRzKVxyXG4gICAgICAgICAgICB3aG9sZVN2Z0dyb3VwLmFwcGVuZChQYXJlbnRDaWNsZUdyb3VwKTtcclxuICAgICAgICAgICAgLy8gY29uc29sZS5sb2coY3VycmVudFBvaW50KTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHN2Z1Jvb3QuYXBwZW5kKHdob2xlU3ZnR3JvdXApOyAgXHJcbiAgICAgICAgfVxyXG5cclxuXHJcbiAgICAgICAgdmFyIGludGVyc2VjdGlvbkNpcmNsZXMgPSBzdmdEb2MuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJjaXJjbGVcIik7XHJcbiAgICAgICAgZm9yKHZhciBpPTA7aTxpbnRlcnNlY3Rpb25DaXJjbGVzLmxlbmd0aDtpKyspe1xyXG4gICAgICAgICAgICBpbnRlcnNlY3Rpb25DaXJjbGVzW2ldLnN0eWxlLmZpbGwgPSBcInRyYW5zcGFyZW50XCI7IC8vZG8gbm90IHNob3cgaW50ZXJzZWN0aW9uIGNpcmNsZXNcclxuICAgICAgICB9ICAgICAgICAgICAgXHJcblxyXG5cclxuICAgICAgICAgICAgdmFyIHBhdGhTdGFydEljb24gPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKFwiU3RhcnRSb3V0ZUljb25cIikpIDtcclxuXHJcblxyXG4gICAgICAgICAgICB2YXIgb1BhcnNlciA9IG5ldyBET01QYXJzZXIoKTsgXHJcbiAgICAgICAgICAgIHZhciBvRE9NID0gb1BhcnNlci5wYXJzZUZyb21TdHJpbmcocGF0aFN0YXJ0SWNvbiwgXCJ0ZXh0L3htbFwiKTsgLy9QYXJzaW5nIHN0cmluZyB0byBodG1sIGVsZW1lbnRcclxuXHJcblxyXG4gICAgICAgICAgICB2YXIgcGFyc2VkUGF0aFN0YXJ0SWNvbiA9IG9ET00uZG9jdW1lbnRFbGVtZW50OyBcclxuICAgICAgICAgICAgdmFyIGljb25PZmZzZXRYID0gJChwYXJzZWRQYXRoU3RhcnRJY29uKS5hdHRyKFwiZGF0YS1vZmZzZXQteFwiKTtcclxuICAgICAgICAgICAgdmFyIGljb25PZmZzZXRZID0gJChwYXJzZWRQYXRoU3RhcnRJY29uKS5hdHRyKFwiZGF0YS1vZmZzZXQteVwiKTtcclxuICAgICAgICAgICAgdmFyIGljb25TY2FsZSA9ICQocGFyc2VkUGF0aFN0YXJ0SWNvbikuYXR0cihcImRhdGEtc2NhbGVcIik7XHJcblxyXG4gICAgICAgICB2YXIgZ3JvdXAgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoJ2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJywgJ2cnKTtcclxuXHJcbiAgICAgICAgaWYoZ2V0U2V0dGluZ0Zyb21TdG9yYWdlKFwiVXNlck9wdGlvblwiKSA9PSBcInRydWVcIiAmJiBwYXRoU3RhcnRJY29uKXsgICAgICAgIC8vY2hlY2sgMXN0IHN0ZXAgdHJpZ2dlciBhbmQgc2V0IFJvdXRlIHN0YXJ0IEljb25cclxuICAgICAgICAgICAgZm9yKHZhciBpPTA7aTxwYXRoU3RhcnRJY29uLmxlbmd0aDtpKyspeyAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAkKHBhcnNlZFBhdGhTdGFydEljb24pLmF0dHIoe1xyXG4gICAgICAgICAgICAgICAgICAgIGZpbGw6IGdldFNldHRpbmdGcm9tU3RvcmFnZShcIlJvdXRlU3RhcnRJY29uQ29sb3JcIiksXHJcbiAgICAgICAgICAgICAgICAgICAgdHJhbnNmb3JtOiBpY29uU2NhbGVcclxuICAgICAgICAgICAgICAgIH0pOyAgICAgICBcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIFxyXG5cclxuICAgICAgICAvL3RyYW5zZm9ybSBSb3V0ZSBzdGFydCBJY29uXHJcbiAgICAgICAgJChncm91cCkuYXR0cihcInRyYW5zZm9ybVwiLCBcInRyYW5zbGF0ZShcIisocGF0aC5nZXRQb2ludEF0TGVuZ3RoKDEpLnggLSAoZ2V0U2V0dGluZ0Zyb21TdG9yYWdlKFwiUm91dGVTdGFydEljb25TaXplXCIpL2ljb25PZmZzZXRYKSkgKyBcIiBcIiArIChwYXRoLmdldFBvaW50QXRMZW5ndGgoMSkueSAtIChnZXRTZXR0aW5nRnJvbVN0b3JhZ2UoXCJSb3V0ZVN0YXJ0SWNvblNpemVcIikvaWNvbk9mZnNldFkpICkrXCIpIFwiICsgXCJzY2FsZShcIitnZXRTZXR0aW5nRnJvbVN0b3JhZ2UoXCJSb3V0ZVN0YXJ0SWNvblNpemVcIikvMTAwK1wiKVwiKTtcclxuICAgICAgICBncm91cC5hcHBlbmQocGFyc2VkUGF0aFN0YXJ0SWNvbik7XHJcbiAgICAgICAgd2hvbGVTdmdHcm91cC5hcHBlbmQoZ3JvdXApO1xyXG4gICAgICAgIHN2Z1Jvb3QuYXBwZW5kKHdob2xlU3ZnR3JvdXApO1xyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG4gICAgICAgIGlmKGdldFNldHRpbmdGcm9tU3RvcmFnZShcImNoZWNrYm94U3RhdGVcIikgPT0gXCJ0cnVlXCIgJiYgZ2V0U2V0dGluZ0Zyb21TdG9yYWdlKFwiZGVmYXVsdE9wdGlvblwiKSA9PSBcInRydWVcIil7IC8vc2V0IGRlZmF1bHQgc3R5bGUgUm91dGUgc3RhcnQgSWNvblxyXG4gICAgICAgICAgICAgICAgdmFyIHN0YXJ0Q2lyY2xlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycsICdjaXJjbGUnKTtcclxuICAgICAgICAgICAgICAgICQoc3RhcnRDaXJjbGUpLmF0dHIoe1xyXG4gICAgICAgICAgICAgICAgICAgIGN4OiBwYXRoLmdldFBvaW50QXRMZW5ndGgoMSkueCxcclxuICAgICAgICAgICAgICAgICAgICBjeTogcGF0aC5nZXRQb2ludEF0TGVuZ3RoKDEpLnksXHJcbiAgICAgICAgICAgICAgICAgICAgcjogZ2V0U2V0dGluZ0Zyb21TdG9yYWdlKFwicG9pbnRzUmFkaXVzXCIpLFxyXG4gICAgICAgICAgICAgICAgICAgIHN0cm9rZTogZ2V0U2V0dGluZ0Zyb21TdG9yYWdlKFwibWFwUG9pbnRzQm9yZGVyQ29sb3JcIiksXHJcbiAgICAgICAgICAgICAgICAgICAgZmlsbDogZ2V0U2V0dGluZ0Zyb21TdG9yYWdlKFwibWFwUG9pbnRzQ29sb3JcIiksXHJcbiAgICAgICAgICAgICAgICAgICAgXCJzdHJva2Utd2lkdGhcIjogZ2V0U2V0dGluZ0Zyb21TdG9yYWdlKFwicG9pbnRzQm9yZGVyV2lkdGhcIilcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coJChzdGFydENpcmNsZSkpO1xyXG4gICAgICAgICAgICAgICAgd2hvbGVTdmdHcm91cC5hcHBlbmQoc3RhcnRDaXJjbGUpO1xyXG4gICAgICAgICAgICAgICAgc3ZnUm9vdC5hcHBlbmQod2hvbGVTdmdHcm91cCk7XHJcbiAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICAvLyBzdmdEb2MuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2NpcmNsZScpLnN0eWxlLm9wYWNpdHkgPSBcIjBcIjtcclxuXHJcbiAgICAgICAgdGV4dF9jb250LnN0eWxlLmRpc3BsYXkgPSBcImJsb2NrXCI7XHJcblxyXG4gICAgICAgIHZhciBsZW5ndGggPSBwYXRoLmdldFRvdGFsTGVuZ3RoKCk7XHJcbiAgICAgICAgLy8gY29uc29sZS5sb2cobGVuZ3RoKTtcclxuICAgICAgICB2YXIgb2Zmc2V0RGFzaCA9ICQocGF0aCkuY3NzKHtcclxuICAgICAgICAgICAgXCJzdHJva2UtZGFzaG9mZnNldFwiOiBsZW5ndGgsXHJcbiAgICAgICAgICAgIFwic3Ryb2tlLWRhc2hhcnJheVwiOiBsZW5ndGggKyBcIiBcIiArIGxlbmd0aFxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICB2YXIgU3RvcFBvaW50cyA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3N0b3BzQXRMZW5ndGgnKSk7XHJcblxyXG5cclxuICAgICAgICBmdW5jdGlvbiBkcmF3UGF0aCgpIHsgICAvL01haW4gcm91dGUgRHJhdyBhbmltYXRpb25cclxuICAgICAgICAgICAgdmFyIGNpcmNsZUVsZW1lbnRzID0gc3ZnRG9jLnF1ZXJ5U2VsZWN0b3JBbGwoJy5jaXJjbGVFbGVtZW50Jyk7XHJcbiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKGNpcmNsZUVsZW1lbnRzKTtcclxuICAgICAgICAgICAgdmFyIHRleHRFbGVtZW50cyA9IHN2Z0RvYy5xdWVyeVNlbGVjdG9yQWxsKCcuY2l0eU5hbWUnKTtcclxuICAgICAgICAgICAgLy8gY29uc29sZS5sb2codGV4dEVsZW1lbnRzKTtcclxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBTdG9wUG9pbnRzLmxlbmd0aDsgaSsrKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgJC5lYWNoKCQoJy5qcy1zZWN0aW9uJyksIGZ1bmN0aW9uKGksIGVsKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCQocGF0aCkpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICgkKHRoaXMpLmhhc0NsYXNzKCdhY3RpdmUnKSkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyICRwZXJjZW50YWdlQ29tcGxldGUgPSAoKCQod2luZG93KS5zY3JvbGxUb3AoKSAtICQodGhpcykub2Zmc2V0KCkudG9wKSAvICQodGhpcykuaGVpZ2h0KCkpICogMTAwOyAvL2NhbGN1bGF0ZSBzZWN0aW9uIG9mZnNldCBmcm9tIHBhZ2UgdG9wIGluIHBlcmNhbnRhZ2VcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGN1cnJlbnRTZWN0aW9uSUQgPSAkKHRoaXMpLmF0dHIoXCJpZFwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudFNlY3Rpb25JRCA9IHBhcnNlSW50KGN1cnJlbnRTZWN0aW9uSURbOF0pIC0gMTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyICRvZmZzZXRVbml0ID0gJHBlcmNlbnRhZ2VDb21wbGV0ZSAqIChTdG9wUG9pbnRzW2N1cnJlbnRTZWN0aW9uSURdIC8gMTAwKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIEN1cnJlbnRQYXRoQ3VycmVudExlbmd0aDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgQ3VycmVudFBhdGhDdXJyZW50TGVuZ3RoID0gTWF0aC5mbG9vcigkb2Zmc2V0VW5pdCk7XHJcblxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGN1cnJlbnRDaXJjbGUgPSBzdmdEb2MuZ2V0RWxlbWVudEJ5SWQoY3VycmVudFNlY3Rpb25JRCsxKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGN1ckRhc2hPZmZzZXQgPSBwYXJzZUZsb2F0KCQocGF0aCkuY3NzKFwic3Ryb2tlLWRhc2hvZmZzZXRcIikpOyAgIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IodmFyIGogPSAwOyBqIDwgY2lyY2xlRWxlbWVudHMubGVuZ3RoOyBqKyspe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY3VycmVudENpcmNsZU5hbWUgPSAkKGN1cnJlbnRDaXJjbGUpLnBhcmVudCgpLmZpbmQoXCJ0ZXh0XCIpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGN1ckRhc2hPZmZzZXQgPj0gbGVuZ3RoIC0gMjApeyAgIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICQoY2lyY2xlRWxlbWVudHNbal0pLmZhZGVPdXQoOTAwKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKHRleHRFbGVtZW50c1tqXSkuZmFkZU91dCg5MDApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyAkKGN1cnJlbnRDaXJjbGVOYW1lKS5mYWRlT3V0KDkwMCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoY2lyY2xlRWxlbWVudHNbal0uaWQgPD0gY3VycmVudFNlY3Rpb25JRCsxKXsgICAgICAgICAgICAgICAgLy9NYWluIHJvdXRlIHBvaW50cyBkaXNwbGF5IGFuZCBmYWRlIG91dFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKGNpcmNsZUVsZW1lbnRzW2pdKS5mYWRlSW4oOTAwKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJCh0ZXh0RWxlbWVudHNbal0pLmZhZGVJbig5MDApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmKGNpcmNsZUVsZW1lbnRzW2pdLmlkID4gY3VycmVudFNlY3Rpb25JRCsxICl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICQoY2lyY2xlRWxlbWVudHNbal0pLmZhZGVPdXQoOTAwKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJCh0ZXh0RWxlbWVudHNbal0pLmZhZGVPdXQoOTAwKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChDdXJyZW50UGF0aEN1cnJlbnRMZW5ndGggPCBTdG9wUG9pbnRzW2N1cnJlbnRTZWN0aW9uSURdKSB7IC8vZHJhdyBwYXRoXHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRTZWN0aW9uSUQgPT0gMCAmJiBDdXJyZW50UGF0aEN1cnJlbnRMZW5ndGggPCBTdG9wUG9pbnRzW2N1cnJlbnRTZWN0aW9uSURdKSB7IC8vIHBhdGggZHJhd2luZyB0byBmaXJzdCBwb2ludFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICQocGF0aCkuY3NzKFwic3Ryb2tlLWRhc2hvZmZzZXRcIiwgXCJcIiArIChsZW5ndGggLSBDdXJyZW50UGF0aEN1cnJlbnRMZW5ndGgpICsgXCJweFwiKTsgICAgICAgICAgICAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRTZWN0aW9uSUQgPiAwICYmIEN1cnJlbnRQYXRoQ3VycmVudExlbmd0aCA8IFN0b3BQb2ludHNbY3VycmVudFNlY3Rpb25JRF0pIHsgLy8gcGF0aCBkcmF3aW5nIHRvIG5leHQgcG9pbnRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKHBhdGgpLmNzcyhcInN0cm9rZS1kYXNob2Zmc2V0XCIsIFwiXCIgKyAobGVuZ3RoIC0gKFN0b3BQb2ludHNbY3VycmVudFNlY3Rpb25JRCAtIDFdICsgQ3VycmVudFBhdGhDdXJyZW50TGVuZ3RoKSkgKyBcIlwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChTdG9wUG9pbnRzW2N1cnJlbnRTZWN0aW9uSUQgLSAxXSArIEN1cnJlbnRQYXRoQ3VycmVudExlbmd0aCA+IFN0b3BQb2ludHNbY3VycmVudFNlY3Rpb25JRF0pIHsgLy9TdG9wIHBhdGggZHJhd2luZyB3aGlsZSBzZWN0aW9uIGluV2luZG93XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJChwYXRoKS5jc3MoXCJzdHJva2UtZGFzaG9mZnNldFwiLCBcIlwiICsgKGxlbmd0aCAtIFN0b3BQb2ludHNbY3VycmVudFNlY3Rpb25JRF0pICsgXCJweFwiKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuXHJcblxyXG5cclxuICAgICAgICBmdW5jdGlvbiBzY3JvbGxlZChlKSB7IFxyXG4gICAgICAgICAgICBkcmF3UGF0aCgpO1xyXG4gICAgICAgICAgICBzZWN0aW9uQ291bnRlcigpO1xyXG4gICAgICAgIH1cclxuXHJcblxyXG4gICAgICAgICQod2luZG93KS5vbihcInNjcm9sbFwiLCBzY3JvbGxlZCk7ICAgLy9kcmF3IGFuaW1hdGlvbiBvbiBzY3JvbGxcclxuXHJcblxyXG4gICAgICAgIHZhciBOUyA9IHN2Z1Jvb3QuZ2V0QXR0cmlidXRlKCd4bWxucycpO1xyXG5cclxuICAgICAgICBzdmdSb290LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIjFcIik7XHJcbiAgICAgICAgICB2YXIgcHQgPSBzdmdSb290LmNyZWF0ZVNWR1BvaW50KCksIHN2Z1AsIGNpcmNsZTtcclxuICAgICAgICAgIFxyXG4gICAgICAgICAgcHQueCA9IGUuY2xpZW50WDtcclxuICAgICAgICAgIHB0LnkgPSBlLmNsaWVudFk7XHJcbiAgICAgICAgICBzdmdQID0gcHQubWF0cml4VHJhbnNmb3JtKHN2Z1Jvb3QuZ2V0U2NyZWVuQ1RNKCkuaW52ZXJzZSgpKTtcclxuXHJcbiAgICAgICAgICBjaXJjbGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoTlMsICdjaXJjbGUnKTtcclxuICAgICAgICAgIGNpcmNsZS5zZXRBdHRyaWJ1dGVOUyhudWxsLCAnY3gnLCBzdmdQLngpO1xyXG4gICAgICAgICAgY2lyY2xlLnNldEF0dHJpYnV0ZU5TKG51bGwsICdjeScsIHN2Z1AueSk7XHJcbiAgICAgICAgICBjaXJjbGUuc2V0QXR0cmlidXRlTlMobnVsbCwgJ3InLCAxMCk7XHJcbiAgICAgICAgICBzdmdSb290LmFwcGVuZENoaWxkKGNpcmNsZSk7XHJcbiAgICAgICAgfSwgZmFsc2UpO1xyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuICAgICBcclxuXHJcblxyXG5cclxuICAgIH0sIGZhbHNlKTtcclxuXHJcbiBcclxuICAgIC8vIGNvbnNvbGUubG9nKFdyYXBwZXJQcm9wcyk7XHJcblxyXG4gICAgICAgICQoXCIjSURtYXBiZ1wiKS5jc3MoXCJiYWNrZ3JvdW5kLWNvbG9yXCIsIGdldFNldHRpbmdGcm9tU3RvcmFnZShcImJvZHlCYWNrZ3JvdW5kQ29sb3JcIikgKTsgICAgIC8vc2V0IHBhZ2UgYmcgY29sb3IgZnJvbSBzZXR0aW5nc1xyXG4gICAgICAgICQoXCJib2R5XCIpLmNzcyhcImJhY2tncm91bmQtY29sb3JcIiwgZ2V0U2V0dGluZ0Zyb21TdG9yYWdlKFwiYm9keUJhY2tncm91bmRDb2xvclwiKSApOyBcclxuXHJcblxyXG5cclxuICAgIC8vICQuZWFjaChXcmFwcGVyUHJvcHMsIGZ1bmN0aW9uKHByb3AsIHZhbHVlKSB7XHJcbiAgICAvLyAgICAgJChcIiNJRG1hcGJnXCIpLmNzcyhwcm9wLCB2YWx1ZSk7IC8vc2V0IG9mZnNldHMgZnJvbSAxc3Qgc3RlcFxyXG4gICAgLy8gfSk7XHJcblxyXG59KTsiXX0=
